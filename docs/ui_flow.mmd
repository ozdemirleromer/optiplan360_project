%% OPTIPLAN 360 â€” UI AKIÅ DÄ°YAGRAMI (v2 DÃœZELTÄ°LMÄ°Å)
%% DÃ¼zeltmeler:
%%   [YÃœKSEK] Hold/Cancel/Done durumlarÄ± eklendi
%%   [ORTA]   Validasyon baÅŸarÄ±sÄ±zlÄ±k yolu eklendi
%%   [ORTA]   WhatsApp bildirim tetikleme noktalarÄ± eklendi
%%   [YENÄ°]   ArÅŸiv/yedek akÄ±ÅŸÄ± eklendi

flowchart TD
  A[ğŸ“± WhatsApp Form Geldi] --> B[Order Draft OluÅŸtur - NEW]
  B --> C[Telefon Normalize + CRM EÅŸleÅŸme]
  C -->|BulunamadÄ±| D[ğŸ”” WA: phone_not_found]
  D --> D1[Yeni MÃ¼ÅŸteri KaydÄ± Zorunlu]
  D1 --> E
  C -->|Bulundu| E[OCR/Import: Ã–lÃ§Ã¼ SatÄ±rlarÄ±]
  E -->|Okunamayan SatÄ±r| E1[ğŸ”” WA: ocr_unreadable_row]
  E -->|Form OkunamadÄ±| E2[ğŸ”” WA: ocr_unreadable_global]
  E --> F[Header Zorunlu Alanlar Doldur]
  F --> G{Validasyon}
  G -->|FAIL| F
  G -->|OK + Merge Ã–nerisi| G1[OperatÃ¶r Merge OnayÄ±]
  G1 --> H
  G -->|OK| H[Approve: Ãœretime GÃ¶nder - IN_PRODUCTION]
  H --> H1[ğŸ”” WA: order_sent_to_production]
  H1 --> I[Export: GOVDE/ARKALIK + Renk/KalÄ±nlÄ±k AyrÄ± .xlsx]
  I --> J[Manuel Kopyala / PaylaÅŸÄ±m Yolu]
  J --> K[Ä°stasyon OkutmalarÄ±]

  %% Ä°stasyon AkÄ±ÅŸÄ±
  K --> L[âœ‚ï¸ Kesim BaÅŸladÄ± - CUT]
  L --> M[ğŸ“¦ HazÄ±r - READY]
  M --> M1[ğŸ”” WA: order_ready]
  M1 --> N[ğŸšš Teslim - DELIVERED]
  N --> N1[ğŸ”” WA: order_delivered]
  N1 --> O[Tamamlananlar - DONE / 6 Ay Sakla]
  O --> P[ğŸ“ ArÅŸiv + Yedek]

  %% Teslim HatÄ±rlatma DÃ¶ngÃ¼sÃ¼
  M1 --> R{Teslim AlÄ±ndÄ± mÄ±?}
  R -->|HayÄ±r + 2 gÃ¼n| R1[ğŸ”” WA: pickup_reminder / max 5]
  R1 --> R
  R -->|Evet| N

  %% Bekletme / Ä°ptal AkÄ±ÅŸÄ±
  B --> HOLD[â¸ï¸ Bekletme - HOLD]
  HOLD --> HOLD1[ğŸ”” WA: order_on_hold]
  HOLD1 -->|14 gÃ¼n sonra| CANCEL[âŒ Ä°ptal - CANCELLED]
  CANCEL --> CANCEL1[ğŸ”” WA: order_cancelled]
  HOLD -->|Devam| F

  %% YanlÄ±ÅŸ AÅŸama Okutma
  K -->|YanlÄ±ÅŸ AÅŸama| WARN[âš ï¸ UyarÄ± + Log - Ä°ÅŸlem yapÄ±lmaz]
