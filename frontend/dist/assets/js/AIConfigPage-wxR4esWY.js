import{h as e,C as i,j as s,c as t,f as r,R as a,B as n,m as l,I as d}from"./index-BqsYehSy.js";import{r as o,e as c,p,ao as g,f as m,V as y,K as u,ap as x,d as v,aq as h}from"./ui-vendor-X7YeR1nJ.js";import"./react-vendor-BTlmOg1k.js";import"./export-jspdf-ClKeqeik.js";import"./state-CRAppeNE.js";import"./export-xlsx-C5xT2hrF.js";const j=[{provider:"gemini",name:"Google Gemini",models:["gemini-1.5-pro","gemini-1.5-pro-vision"],description:"Google'ın çok modelli AI modeli"},{provider:"openai",name:"OpenAI GPT",models:["gpt-4","gpt-4-turbo","gpt-3.5-turbo"],description:"OpenAI'nin dil modeli"},{provider:"custom",name:"Özel API",models:["custom"],description:"Özel AI API endpoint'i"}],f=[{id:"providers",label:"Provider'lar",icon:s.jsx(p,{size:14})},{id:"status",label:"Durum",icon:s.jsx(c,{size:14})},{id:"test",label:"Bağlantı Testi",icon:s.jsx(h,{size:14})}],b={background:i.surface,border:`1px solid ${i.border}`,borderRadius:a.lg,padding:20},k={provider:"gemini",api_key:"",model:"gemini-1.5-pro",endpoint:"",temperature:.7,max_tokens:8192,is_active:!0};function z({children:e}){return s.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4,color:i.text},children:e})}function A(){var A;const[S,I]=o.useState("providers"),[C,T]=o.useState(null),[w,_]=o.useState(null),[B,P]=o.useState(null),[E,D]=o.useState(!1),[U,W]=o.useState(null),[R,$]=o.useState(!1),[L,O]=o.useState(null),[F,K]=o.useState(k),G=o.useCallback(async()=>{D(!0);try{const i=await e("/config/ai");T(i.providers??{}),_(i.current_provider??null)}catch(i){}finally{D(!1)}},[]),M=o.useCallback(async()=>{try{const i=await e("/config/ai/status");P(i)}catch(i){}},[]);o.useEffect(()=>{G(),M()},[G,M]);const N="success"===(null==L?void 0:L.type)?{bg:"rgba(16,185,129,0.12)",border:"rgba(16,185,129,0.35)",color:i.success.DEFAULT}:{bg:"rgba(239,68,68,0.12)",border:"rgba(239,68,68,0.35)",color:i.error.DEFAULT},J=j.map(e=>({value:e.provider,label:e.name})),Y=((null==(A=j.find(e=>e.provider===F.provider))?void 0:A.models)??[]).map(e=>({value:e,label:e}));return s.jsxs("div",{className:"electric-page",children:[s.jsx(t,{title:"AI Konfigürasyon",subtitle:"AI servisleri ve API anahtarları yönetimi",breadcrumbs:["Ayarlar","AI Konfigürasyon"],children:w&&s.jsxs(r,{variant:"success",children:[s.jsx(c,{size:12,style:{marginRight:4}}),"Aktif: ",w.toUpperCase()]})}),s.jsxs("div",{className:"app-page-container",style:{display:"grid",gap:16,alignContent:"start"},children:[L&&s.jsx("div",{role:"error"===L.type?"alert":"status",style:{border:`1px solid ${N.border}`,background:N.bg,color:N.color,borderRadius:a.md,padding:"10px 12px",fontSize:13},children:L.text}),s.jsx("div",{style:{display:"flex",gap:4,borderBottom:`1px solid ${i.border}`},children:f.map(e=>{const t=S===e.id;return s.jsxs("button",{onClick:()=>I(e.id),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 14px",fontSize:13,fontWeight:t?600:400,background:"none",border:"none",borderBottom:t?`2px solid ${i.primary.DEFAULT}`:"2px solid transparent",color:t?i.primary.DEFAULT:i.muted,cursor:"pointer",marginBottom:-1},children:[e.icon,e.label]},e.id)})}),"providers"===S&&s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[s.jsxs("div",{style:b,children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:600,fontSize:15,marginBottom:4},children:[s.jsx(p,{size:16})," Yapılandırılmış Provider'lar"]}),s.jsx("div",{style:{fontSize:12,color:i.muted,marginBottom:16},children:"Mevcut AI servisleri konfigürasyonları"}),C&&Object.keys(C).length>0?s.jsx("div",{style:{display:"grid",gap:12},children:Object.entries(C).map(([t,l])=>s.jsxs("div",{style:{border:`1px solid ${i.border}`,borderRadius:a.md,padding:12},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx("span",{style:{fontWeight:600},children:t.toUpperCase()}),w===t&&s.jsx(r,{variant:"success",children:"Aktif"})]}),s.jsxs("div",{style:{display:"flex",gap:6},children:[w!==t&&s.jsx(n,{variant:"ghost",size:"sm",icon:s.jsx(g,{size:12}),onClick:()=>{(async i=>{D(!0),O(null);try{await e(`/config/ai/switch/${i}`,{method:"PUT"}),O({type:"success",text:`Aktif provider ${i.toUpperCase()} olarak değiştirildi.`}),await G(),await M()}catch(s){O({type:"error",text:s instanceof Error?s.message:"Provider değiştirilemedi."})}finally{D(!1)}})(t)},disabled:E,children:"Aktif Et"}),s.jsx(n,{variant:"danger",size:"sm",icon:s.jsx(m,{size:12}),onClick:()=>{(async i=>{if(window.confirm(`${i.toUpperCase()} konfigürasyonunu silmek istediğinizden emin misiniz?`)){D(!0),O(null);try{await e(`/config/ai/${i}`,{method:"DELETE"}),O({type:"success",text:"Provider konfigürasyonu silindi."}),await G(),await M()}catch(s){O({type:"error",text:s instanceof Error?s.message:"Provider silinemedi."})}finally{D(!1)}}})(t)},disabled:E,"aria-label":"Sil",children:""})]})]}),s.jsxs("div",{style:{fontSize:12,color:i.muted},children:[s.jsxs("div",{children:["Model: ",l.model]}),l.updated_at&&s.jsxs("div",{children:["Son güncelleme: ",new Date(l.updated_at).toLocaleString("tr-TR")]}),l.updated_by&&s.jsxs("div",{children:["Güncelleyen: ",l.updated_by]})]})]},t))}):s.jsx("div",{style:{textAlign:"center",padding:"32px 0",color:i.muted,fontSize:13},children:"Henüz provider yapılandırılmamış"})]}),s.jsxs("div",{style:b,children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:600,fontSize:15,marginBottom:4},children:[s.jsx(y,{size:16})," Provider Ekle/Düzenle"]}),s.jsx("div",{style:{fontSize:12,color:i.muted,marginBottom:16},children:"Yeni AI provider'ı yapılandır veya mevcudu güncelle"}),s.jsxs("div",{style:{display:"grid",gap:12},children:[s.jsx(l,{label:"Provider",value:F.provider,onChange:e=>{var i;return K({...F,provider:String(e),model:(null==(i=j.find(i=>i.provider===e))?void 0:i.models[0])??""})},options:J}),s.jsx(l,{label:"Model",value:F.model,onChange:e=>K({...F,model:String(e)}),options:Y}),s.jsx(d,{type:"password",label:"API Anahtarı",value:F.api_key,onChange:e=>K({...F,api_key:e.target.value}),placeholder:"API anahtarını girin..."}),"custom"===F.provider&&s.jsx(d,{label:"Endpoint (Opsiyonel)",value:F.endpoint,onChange:e=>K({...F,endpoint:e.target.value}),placeholder:"https://api.example.com/v1"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[s.jsxs("div",{children:[s.jsxs(z,{children:["Temperature (",F.temperature.toFixed(1),")"]}),s.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:F.temperature,onChange:e=>K({...F,temperature:parseFloat(e.target.value)}),style:{width:"100%"}})]}),s.jsx(d,{type:"number",label:"Max Tokens",value:F.max_tokens,onChange:e=>K({...F,max_tokens:parseInt(e.target.value)}),min:1,max:32768})]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:F.is_active,onChange:e=>K({...F,is_active:e.target.checked})}),"Kaydedilirken aktif et"]}),s.jsx(n,{icon:E?s.jsx(u,{size:14}):s.jsx(x,{size:14}),onClick:()=>{(async()=>{if(F.api_key.trim()){D(!0),O(null);try{await e("/config/ai",{method:"POST",body:JSON.stringify(F)}),O({type:"success",text:"AI konfigürasyonu kaydedildi."}),await G(),await M()}catch(i){O({type:"error",text:i instanceof Error?i.message:"Konfigürasyon kaydedilemedi."})}finally{D(!1)}}else O({type:"error",text:"API anahtarı gereklidir."})})()},disabled:E,loading:E,fullWidth:!0,children:"Konfigürasyonu Kaydet"})]})]})]}),"status"===S&&s.jsxs("div",{style:b,children:[s.jsx("div",{style:{fontWeight:600,fontSize:15,marginBottom:4},children:"AI Servis Durumu"}),s.jsx("div",{style:{fontSize:12,color:i.muted,marginBottom:16},children:"AI servislerinin mevcut durumu ve yapılandırma bilgileri"}),B?s.jsxs("div",{style:{display:"grid",gap:16},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx("span",{style:{fontWeight:600},children:"Aktif Provider:"}),B.current_provider?s.jsxs(r,{variant:"success",children:[s.jsx(c,{size:12,style:{marginRight:4}}),B.current_provider.toUpperCase()]}):s.jsxs(r,{variant:"warning",children:[s.jsx(v,{size:12,style:{marginRight:4}}),"Aktif provider yok"]})]}),s.jsxs("div",{style:{borderTop:`1px solid ${i.border}`,paddingTop:16},children:[s.jsx("div",{style:{fontWeight:600,marginBottom:12},children:"Servisler:"}),s.jsx("div",{style:{display:"grid",gap:8},children:Object.entries(B.services).map(([e,t])=>s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",border:`1px solid ${i.border}`,borderRadius:a.md,padding:12},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[s.jsx("div",{style:{width:10,height:10,borderRadius:"50%",background:t.active?i.success.DEFAULT:i.gray[400]}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:e.toUpperCase()}),s.jsxs("div",{style:{fontSize:12,color:i.muted},children:["Model: ",t.model]})]})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx(r,{variant:t.active?"success":"secondary",children:t.active?"Aktif":"Pasif"}),t.last_updated&&s.jsx("div",{style:{fontSize:11,color:i.muted,marginTop:4},children:new Date(t.last_updated).toLocaleString("tr-TR")})]})]},e))})]})]}):s.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:i.muted},children:[s.jsx(u,{size:32,style:{margin:"0 auto 12px",display:"block"}}),"Durum yükleniyor..."]})]}),"test"===S&&s.jsxs("div",{style:b,children:[s.jsx("div",{style:{fontWeight:600,fontSize:15,marginBottom:4},children:"Bağlantı Testi"}),s.jsx("div",{style:{fontSize:12,color:i.muted,marginBottom:16},children:"AI provider bağlantısını test et"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[s.jsx(l,{label:"Provider",value:F.provider,onChange:e=>K({...F,provider:String(e)}),options:J}),s.jsx(d,{type:"password",label:"API Anahtarı",value:F.api_key,onChange:e=>K({...F,api_key:e.target.value}),placeholder:"Test etmek için API anahtarı..."})]}),s.jsx(n,{icon:R?s.jsx(u,{size:14}):s.jsx(h,{size:14}),onClick:()=>{(async()=>{$(!0),W(null),O(null);try{const i=await e("/config/ai/test",{method:"POST",body:JSON.stringify({provider:F.provider,api_key:F.api_key,model:F.model})});W(i)}catch(i){W({success:!1,message:i instanceof Error?i.message:"Bağlantı test edilemedi."})}finally{$(!1)}})()},disabled:R||!F.api_key.trim(),loading:R,fullWidth:!0,children:"Bağlantıyı Test Et"}),U&&s.jsxs("div",{style:{marginTop:12,border:"1px solid "+(U.success?"rgba(16,185,129,0.35)":"rgba(239,68,68,0.35)"),background:U.success?"rgba(16,185,129,0.08)":"rgba(239,68,68,0.08)",borderRadius:a.md,padding:12},children:[s.jsx("div",{style:{fontWeight:600,marginBottom:4,color:U.success?i.success.DEFAULT:i.error.DEFAULT},children:U.success?"✓ Test Başarılı":"✗ Test Başarısız"}),s.jsx("div",{style:{fontSize:13,color:i.text},children:U.message})]})]})]})]})}export{A as default};
