import{j as e,c as t,T as s,C as i,R as n,B as r,d as a}from"./index-BqsYehSy.js";import{r as o,ab as l,Q as d,T as c,a as g}from"./ui-vendor-X7YeR1nJ.js";import{m as u}from"./mikroService-C7PQFSQ1.js";import"./react-vendor-BTlmOg1k.js";import"./export-jspdf-ClKeqeik.js";import"./state-CRAppeNE.js";import"./export-xlsx-C5xT2hrF.js";function p(){const[p,h]=o.useState(null),[y,x]=o.useState(!0),[m,f]=o.useState(null),j=o.useRef(3e4),S=o.useRef(null),b=o.useRef(!0),v=o.useCallback(async()=>{try{x(!0);const e=await u.checkHealth();h(e),f(null),x(!1),j.current=3e4}catch(e){f(e instanceof Error?e.message:String(e)),x(!1),j.current=Math.min(2*j.current,12e4)}b.current&&(S.current=setTimeout(()=>{v()},j.current))},[]);function E(e){switch(e){case"HEALTHY":return{background:i.success.light,color:i.success.DEFAULT};case"DEGRADED":return{background:i.warning.light,color:i.warning.DEFAULT};case"UNHEALTHY":case"ERROR":return{background:i.error.light,color:i.error.DEFAULT};default:return{background:i.bg.elevated,color:i.muted}}}function T(t){const s={size:16,strokeWidth:2.5,style:{display:"inline-block",verticalAlign:"middle"}};switch(t){case"HEALTHY":return e.jsx(g,{...s,color:i.success.DEFAULT,"aria-label":"Sağlıklı"});case"DEGRADED":return e.jsx(c,{...s,color:i.warning.DEFAULT,"aria-label":"Kısmi sorun"});case"UNHEALTHY":case"ERROR":return e.jsx(d,{...s,color:i.error.DEFAULT,"aria-label":"Sorunlu"});case"DISABLED":return e.jsx(l,{...s,color:i.muted,"aria-label":"Devre dışı"});default:return e.jsx(l,{...s,color:i.muted,"aria-label":"Bilinmiyor"})}}return o.useEffect(()=>(b.current=!0,v(),()=>{b.current=!1,S.current&&clearTimeout(S.current)}),[v]),y&&!p?e.jsxs("div",{className:"electric-page",children:[e.jsx(t,{title:"Entegrasyon Saglik Kontrolu",subtitle:"Servislerin anlik baglanti ve hata durumu",breadcrumbs:["Entegrasyonlar","Saglik"]}),e.jsx("div",{className:"app-page-container",style:{minHeight:"60vh",display:"flex",alignItems:"center",justifyContent:"center",color:i.muted,fontSize:s.fontSize.sm},children:"Saglik durumu kontrol ediliyor..."})]}):m?e.jsxs("div",{className:"electric-page",children:[e.jsx(t,{title:"Entegrasyon Saglik Kontrolu",subtitle:"Servislerin anlik baglanti ve hata durumu",breadcrumbs:["Entegrasyonlar","Saglik"]}),e.jsx("div",{className:"app-page-container",children:e.jsxs("div",{style:{padding:12,borderRadius:n.md,background:i.error.light,color:i.error.DEFAULT,border:`1px solid ${i.error.DEFAULT}`},children:["Saglik kontrolu hatasi: ",m]})})]}):e.jsxs("div",{className:"electric-page",children:[e.jsx(t,{title:"Entegrasyon Saglik Kontrolu",subtitle:"Servislerin anlik baglanti ve hata durumu",breadcrumbs:["Entegrasyonlar","Saglik"],children:e.jsx(r,{variant:"secondary",size:"sm",onClick:v,children:"Yenile"})}),e.jsx("div",{className:"app-page-container",style:{display:"grid",gap:20},children:p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{padding:16,borderRadius:n.md,...function(e){switch(e){case"HEALTHY":return{background:i.success.light,color:i.success.DEFAULT,border:`1px solid ${i.success.dark}`};case"DEGRADED":return{background:i.warning.light,color:i.warning.DEFAULT,border:`1px solid ${i.warning.DEFAULT}`};case"UNHEALTHY":case"ERROR":return{background:i.error.light,color:i.error.DEFAULT,border:`1px solid ${i.error.DEFAULT}`};default:return{background:i.bg.subtle,color:i.muted,border:`1px solid ${i.border}`}}}(p.overallStatus)},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:s.fontWeight.bold},children:"Genel Durum"}),e.jsxs("p",{style:{margin:"6px 0 0",fontSize:12},children:["Son guncelleme: ",new Date(p.timestamp).toLocaleString("tr-TR")]})]}),e.jsx("div",{style:{fontSize:32},children:T(p.overallStatus)})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))",gap:16},children:[p.integrations.MIKRO&&e.jsxs(a,{title:"Mikro SQL",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:28},children:T(p.integrations.MIKRO.status)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:n.sm,fontSize:11,fontWeight:s.fontWeight.semibold,...E(p.integrations.MIKRO.status)},children:p.integrations.MIKRO.status})]}),e.jsxs("div",{style:{display:"grid",gap:8,fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Durum:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold,color:p.integrations.MIKRO.connection?i.success.DEFAULT:i.error.DEFAULT},children:p.integrations.MIKRO.connection?"Bagli":"Baglanti Hatasi"})]}),p.integrations.MIKRO.database&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Veritabani:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold},children:p.integrations.MIKRO.database})]}),void 0!==p.integrations.MIKRO.pendingSyncs&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Bekleyen Senkron:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold},children:p.integrations.MIKRO.pendingSyncs})]}),void 0!==p.integrations.MIKRO.successRate&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Basari Orani:"}),e.jsxs("span",{style:{fontWeight:s.fontWeight.semibold},children:["%",p.integrations.MIKRO.successRate]})]}),p.integrations.MIKRO.error&&e.jsx("div",{style:{marginTop:4,padding:8,borderRadius:n.sm,background:i.error.light,color:i.error.DEFAULT,fontSize:11},children:p.integrations.MIKRO.error})]})]}),p.integrations.SMTP&&e.jsxs(a,{title:"E-posta (SMTP)",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:28},children:T(p.integrations.SMTP.status)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:n.sm,fontSize:11,fontWeight:s.fontWeight.semibold,...E(p.integrations.SMTP.status)},children:p.integrations.SMTP.status})]}),e.jsxs("div",{style:{display:"grid",gap:8,fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Durum:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold,color:p.integrations.SMTP.connection?i.success.DEFAULT:i.muted},children:p.integrations.SMTP.connection?"Aktif":p.integrations.SMTP.message})]}),p.integrations.SMTP.host&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Host:"}),e.jsxs("span",{style:{fontWeight:s.fontWeight.semibold},children:[p.integrations.SMTP.host,":",p.integrations.SMTP.port]})]}),p.integrations.SMTP.error&&e.jsx("div",{style:{marginTop:4,padding:8,borderRadius:n.sm,background:i.error.light,color:i.error.DEFAULT,fontSize:11},children:p.integrations.SMTP.error})]})]}),p.integrations.SMS&&e.jsxs(a,{title:"SMS Gateway",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:28},children:T(p.integrations.SMS.status)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:n.sm,fontSize:11,fontWeight:s.fontWeight.semibold,...E(p.integrations.SMS.status)},children:p.integrations.SMS.status})]}),e.jsxs("div",{style:{display:"grid",gap:8,fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Durum:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold,color:p.integrations.SMS.connection?i.success.DEFAULT:i.muted},children:p.integrations.SMS.connection?"Aktif":p.integrations.SMS.message})]}),p.integrations.SMS.provider&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Provider:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold},children:p.integrations.SMS.provider})]}),p.integrations.SMS.error&&e.jsx("div",{style:{marginTop:4,padding:8,borderRadius:n.sm,background:i.error.light,color:i.error.DEFAULT,fontSize:11},children:p.integrations.SMS.error})]})]}),p.integrations.EINVOICE&&e.jsxs(a,{title:"e-Fatura",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:28},children:T(p.integrations.EINVOICE.status)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:n.sm,fontSize:11,fontWeight:s.fontWeight.semibold,...E(p.integrations.EINVOICE.status)},children:p.integrations.EINVOICE.status})]}),e.jsx("div",{style:{display:"grid",gap:8,fontSize:12},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Durum:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold,color:p.integrations.EINVOICE.connection?i.success.DEFAULT:i.muted},children:p.integrations.EINVOICE.message})]})})]}),p.integrations.CARGO&&e.jsxs(a,{title:"Kargo",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:28},children:T(p.integrations.CARGO.status)}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:n.sm,fontSize:11,fontWeight:s.fontWeight.semibold,...E(p.integrations.CARGO.status)},children:p.integrations.CARGO.status})]}),e.jsx("div",{style:{display:"grid",gap:8,fontSize:12},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsx("span",{style:{color:i.muted},children:"Durum:"}),e.jsx("span",{style:{fontWeight:s.fontWeight.semibold,color:p.integrations.CARGO.connection?i.success.DEFAULT:i.muted},children:p.integrations.CARGO.message})]})})]})]}),p.errors&&p.errors.length>0&&e.jsx(a,{title:"Son Hatalar",children:e.jsx("div",{style:{display:"grid",gap:12},children:p.errors.map((t,r)=>e.jsx("div",{style:{padding:12,background:i.error.light,borderRadius:n.md,border:`1px solid ${i.error.DEFAULT}`},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:s.fontWeight.semibold,color:i.error.DEFAULT},children:[t.entityType??"UNKNOWN"," - ",t.errorCode||"UNKNOWN"]}),e.jsx("div",{style:{fontSize:12,color:i.gray[500]},children:t.errorMessage??"Bilinmeyen hata"}),void 0!==t.entityId&&null!==t.entityId&&e.jsxs("div",{style:{fontSize:11,color:i.gray[400],marginTop:2},children:["Entity ID: ",String(t.entityId)]})]}),e.jsx("div",{style:{fontSize:11,color:i.error.DEFAULT,whiteSpace:"nowrap"},children:t.timestamp?new Date(t.timestamp).toLocaleString("tr-TR"):"-"})]})},r))})}),p.errors&&0===p.errors.length&&e.jsx("div",{style:{padding:12,borderRadius:n.md,background:i.success.light,color:i.success.DEFAULT,border:`1px solid ${i.success.DEFAULT}`,fontSize:12},children:"[OK] Son 24 saatte entegrasyon hatasi bulunmamaktadir."})]})})]})}export{p as IntegrationHealth,p as default};
