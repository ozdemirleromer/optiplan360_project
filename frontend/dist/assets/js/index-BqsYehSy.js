const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/AIOpsDashboard-BtLX-MwR.js","assets/js/ui-vendor-X7YeR1nJ.js","assets/js/useAIOpsPresentation-CyodkFsC.js","assets/js/integrationService-BBjlJOEd.js","assets/js/paymentService-B1S5G9JA.js","assets/js/react-vendor-BTlmOg1k.js","assets/js/export-jspdf-ClKeqeik.js","assets/js/state-CRAppeNE.js","assets/js/export-xlsx-C5xT2hrF.js","assets/.css/AIOpsDashboard-CeHi9C8L.css","assets/js/AIOrchestratorDashboard-SxM4eqjk.js","assets/.css/AIOrchestratorDashboard-CNRZsZLA.css","assets/js/index-jFQog1Z7.js","assets/js/ModularIntegrationsPage-FPu7oiLP.js","assets/js/mikroService-C7PQFSQ1.js","assets/js/IntegrationHealth-FxbDTWGi.js","assets/js/CardManagementPage-Di8jOV4Y.js","assets/js/ReportsAnalyticsPage-B_Yq-xOd.js","assets/js/SystemLogsPage-954TYgh2.js","assets/js/TabBar-UQLS4xdW.js","assets/js/UserManagementPage-BdybPxCx.js","assets/js/SupportTickets-DDUNq5-b.js","assets/js/crmService-CaLpglF9.js","assets/js/ConfigPage-BSs13Z3f.js","assets/js/OrganizationPage-DgL4Flpk.js","assets/js/ConfigPage-dkWwbSbm.js","assets/js/StationsPage-DDB6LX8N.js","assets/js/StationsPage-A7mlIzHL.js","assets/js/OrganizationPage-CRB_77Y2.js","assets/js/UserActivityPage-D9p9fCV4.js","assets/js/UserActivityPage-CEfuf815.js","assets/js/WorkflowBuilder-soOS8a_H.js","assets/js/ApiPortal-BMUh424y.js","assets/js/WhatsAppBusinessPage-xm45n8v5.js","assets/js/index-CoEFI-UD.js","assets/js/AIAssistantPage-CXulCs5Q.js","assets/js/AIConfigPage-wxR4esWY.js","assets/js/index-CcGVDsEJ.js","assets/js/SpecSearchPage-BGMlUlpe.js","assets/js/PublicOrderTracking-Dz8R8jmG.js","assets/.css/PublicOrderTracking-DUDfhhfv.css"])))=>i.map(i=>d[i]);
import{r as e,S as t,X as r,C as i,F as n,a,M as s,b as o,B as l,E as d,c,I as p,T as u,d as g,e as m,R as h,f as x,g as y,h as b,i as f,j as v,L as j,P as k,W as S,k as E,H as A,l as w,m as F,n as D,o as T,p as z,A as C,q as N,s as L,t as O,u as $,U as I,G as _,v as B,w as P,x as R,y as U,z as W,D as M,J as G,K,N as H,O as J,Q as Y,V,Y as q,Z as X}from"./ui-vendor-X7YeR1nJ.js";import{r as Z}from"./react-vendor-BTlmOg1k.js";import{_ as Q}from"./export-jspdf-ClKeqeik.js";import{c as ee}from"./state-CRAppeNE.js";import{r as te,u as re}from"./export-xlsx-C5xT2hrF.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ie={exports:{}},ne={},ae=e,se=Symbol.for("react.element"),oe=Symbol.for("react.fragment"),le=Object.prototype.hasOwnProperty,de=ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ce={key:!0,ref:!0,__self:!0,__source:!0};function pe(e,t,r){var i,n={},a=null,s=null;for(i in void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(s=t.ref),t)le.call(t,i)&&!ce.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===n[i]&&(n[i]=t[i]);return{$$typeof:se,type:e,key:a,ref:s,props:n,_owner:de.current}}ne.Fragment=oe,ne.jsx=pe,ne.jsxs=pe,ie.exports=ne;var ue=ie.exports,ge={},me=Z;ge.createRoot=me.createRoot,ge.hydrateRoot=me.hydrateRoot;const he=()=>{const[i,n]=e.useState(!1),[a,s]=e.useState("");return ue.jsxs("div",{className:"global-search "+(i?"is-focused":""),children:[ue.jsx(t,{size:14,className:"global-search-icon","aria-hidden":"true"}),ue.jsx("input",{"data-global-search":!0,value:a,onChange:e=>s(e.target.value),onFocus:()=>n(!0),onBlur:()=>n(!1),placeholder:"Siparis, musteri ara...","aria-label":"Global arama",className:"global-search-input"}),a?ue.jsx("button",{type:"button",onClick:()=>s(""),"aria-label":"Aramayi temizle",className:"global-search-clear",children:ue.jsx(r,{size:14})}):ue.jsx("span",{className:"global-search-hint",children:"Ctrl+F"})]})},xe={success:{DEFAULT:"#10B981",light:"rgba(16,185,129,0.12)",dark:"#059669"},warning:{DEFAULT:"#F59E0B",light:"rgba(245,158,11,0.12)",dark:"#D97706",800:"#92400E"},danger:{DEFAULT:"#EF4444",light:"rgba(239,68,68,0.12)",dark:"#DC2626"},error:{DEFAULT:"#EF4444",light:"rgba(239,68,68,0.12)",dark:"#DC2626"}},ye={name:"neoCorporate",label:"Executive Slate",description:"Top command bar and KPI-driven corporate control surface",category:"corporate",preview:{bg:"#0F172A",primary:"#3B82F6",accent:"#8B5CF6"},primaryRgb:"59,130,246",design:{radius:{sm:8,md:12,lg:16,xl:20,"2xl":24,"3xl":32,full:9999},shadows:{xs:"0 2px 8px rgba(0,0,0,0.08)",sm:"0 4px 12px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.08)",md:"0 8px 24px rgba(0,0,0,0.16), 0 4px 8px rgba(0,0,0,0.1)",lg:"0 16px 40px rgba(0,0,0,0.2), 0 8px 16px rgba(0,0,0,0.12)",xl:"0 24px 56px rgba(0,0,0,0.24), 0 12px 24px rgba(0,0,0,0.14)",cardHover:"0 12px 32px rgba(59,130,246,0.2), 0 6px 12px rgba(0,0,0,0.15)",glow:"0 0 0 1px rgba(59,130,246,0.3), 0 0 24px rgba(59,130,246,0.15)"},typography:{headingWeight:700,bodyWeight:400,letterSpacing:"normal",lineHeight:"relaxed"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#0F172A",surface:"#1E293B",elevated:"#334155",overlay:"rgba(15,23,42,0.95)",subtle:"rgba(255,255,255,0.05)"},primary:{DEFAULT:"#3B82F6",50:"#EFF6FF",100:"#DBEAFE",200:"#BFDBFE",300:"#93C5FD",400:"#60A5FA",500:"#3B82F6",600:"#2563EB",700:"#1D4ED8",800:"#1E40AF",900:"#1E3A8A"},accent:{DEFAULT:"#8B5CF6",50:"#F5F3FF",100:"#EDE9FE",200:"#DDD6FE",300:"#C4B5FD",400:"#A78BFA",500:"#8B5CF6",600:"#7C3AED",700:"#6D28D9",800:"#5B21B6",900:"#4C1D95"},...xe,info:{DEFAULT:"#06B6D4",light:"rgba(6,182,212,0.12)",dark:"#0891B2",500:"#06B6D4",800:"#155E75"},text:"#F1F5F9",muted:"#94A3B8",border:"#334155",border2:"#475569",titlebar:{bg:"#0F172A",text:"#94A3B8",active:"#3B82F6",button:"#1E293B",buttonHover:"#334155",close:"#EF4444"},secondary:{DEFAULT:"#8B5CF6",500:"#8B5CF6"},surface:"rgba(255,255,255,0.05)",panel:"#1E293B",gray:{50:"#F8FAFC",100:"#F1F5F9",200:"#E2E8F0",300:"#CBD5E1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1E293B",900:"#0F172A"}}},be={name:"minimalStudio",label:"Ledger Pro",description:"Table-first finance workspace with audit-friendly hierarchy",category:"minimal",preview:{bg:"#F8FAF7",primary:"#1F2937",accent:"#6B8E23"},primaryRgb:"31,41,55",design:{radius:{sm:2,md:4,lg:6,xl:8,"2xl":10,"3xl":12,full:9999},shadows:{xs:"0 1px 2px rgba(0,0,0,0.05)",sm:"0 1px 3px rgba(0,0,0,0.08)",md:"0 2px 6px rgba(0,0,0,0.10)",lg:"0 4px 12px rgba(0,0,0,0.12)",xl:"0 8px 24px rgba(0,0,0,0.15)",cardHover:"0 4px 16px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.1)",glow:"0 0 0 2px rgba(0,0,0,0.15)"},typography:{headingWeight:600,bodyWeight:400,letterSpacing:"tight",lineHeight:"compact"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#F8FAF7",surface:"#FFFFFF",elevated:"#F1F5EE",overlay:"rgba(248,250,247,0.98)",subtle:"rgba(31,41,55,0.02)"},primary:{DEFAULT:"#1F2937",50:"#F8FAFC",100:"#F1F5F9",200:"#E2E8F0",300:"#CBD5E1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1F2937",900:"#0F172A"},accent:{DEFAULT:"#6B8E23",50:"#F6FAEC",100:"#EAF4D8",200:"#D5E9B0",300:"#B7D880",400:"#95BF4F",500:"#6B8E23",600:"#56751C",700:"#455D17",800:"#364913",900:"#29370E"},success:{DEFAULT:"#059669",light:"rgba(5,150,105,0.10)",dark:"#047857"},warning:{DEFAULT:"#D97706",light:"rgba(217,119,6,0.10)",dark:"#B45309",800:"#92400E"},danger:{DEFAULT:"#DC2626",light:"rgba(220,38,38,0.10)",dark:"#B91C1C"},error:{DEFAULT:"#DC2626",light:"rgba(220,38,38,0.10)",dark:"#B91C1C"},info:{DEFAULT:"#0284C7",light:"rgba(2,132,199,0.10)",dark:"#0369A1",500:"#0284C7",800:"#075985"},text:"#1F2937",muted:"#5F6B5E",border:"#D8E0D2",border2:"#C8D2C0",titlebar:{bg:"#EFF4EA",text:"#5F6B5E",active:"#1F2937",button:"#E2EADF",buttonHover:"#D6E0D0",close:"#DC2626"},secondary:{DEFAULT:"#6B8E23",500:"#6B8E23"},surface:"rgba(31,41,55,0.02)",panel:"#FFFFFF",gray:{50:"#F8FAF7",100:"#EFF4EA",200:"#E2EADF",300:"#D4DECF",400:"#AAB8A8",500:"#829281",600:"#5F6B5E",700:"#455342",800:"#2D372C",900:"#1D241C"}}},fe={name:"industrialGrid",label:"Industrial Matrix",description:"Hard-edged production interface with grid and contrast blocks",category:"industrial",preview:{bg:"#1A1A1A",primary:"#FCD34D",accent:"#F97316"},primaryRgb:"252,211,77",design:{radius:{sm:0,md:0,lg:0,xl:2,"2xl":2,"3xl":3,full:0},shadows:{xs:"none",sm:"0 0 0 1px rgba(255,255,255,0.1)",md:"0 0 0 2px rgba(255,255,255,0.1)",lg:"0 0 0 2px rgba(252,211,77,0.3)",xl:"0 0 0 3px rgba(252,211,77,0.4)",cardHover:"0 0 0 2px rgba(252,211,77,0.6)",glow:"0 0 0 2px rgba(252,211,77,0.8), 0 0 16px rgba(252,211,77,0.3)"},typography:{headingWeight:800,bodyWeight:500,letterSpacing:"wide",lineHeight:"compact"},borders:{width:2,style:"solid"}},colors:{bg:{main:"#1A1A1A",surface:"#242424",elevated:"#2E2E2E",overlay:"rgba(26,26,26,0.98)",subtle:"rgba(255,255,255,0.03)"},primary:{DEFAULT:"#FCD34D",50:"#FEFCE8",100:"#FEF9C3",200:"#FEF08A",300:"#FDE047",400:"#FACC15",500:"#FCD34D",600:"#CA8A04",700:"#A16207",800:"#854D0E",900:"#713F12"},accent:{DEFAULT:"#F97316",50:"#FFF7ED",100:"#FFEDD5",200:"#FED7AA",300:"#FDBA74",400:"#FB923C",500:"#F97316",600:"#EA580C",700:"#C2410C",800:"#9A3412",900:"#7C2D12"},...xe,info:{DEFAULT:"#22D3EE",light:"rgba(34,211,238,0.12)",dark:"#06B6D4",500:"#22D3EE",800:"#155E75"},text:"#FAFAFA",muted:"#A3A3A3",border:"#3F3F3F",border2:"#525252",titlebar:{bg:"#1A1A1A",text:"#A3A3A3",active:"#FCD34D",button:"#2E2E2E",buttonHover:"#3F3F3F",close:"#EF4444"},secondary:{DEFAULT:"#F97316",500:"#F97316"},surface:"rgba(255,255,255,0.03)",panel:"#242424",gray:{50:"#FAFAFA",100:"#F5F5F5",200:"#E5E5E5",300:"#D4D4D4",400:"#A3A3A3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717"}}},ve={name:"deepSpace",label:"Deep Space (v1)",description:"Futuristic dark mode with glassmorphism and nebula effects",category:"industrial",preview:{bg:"#030712",primary:"#6366F1",accent:"#06B6D4"},primaryRgb:"99,102,241",design:{radius:{sm:4,md:8,lg:16,xl:24,"2xl":32,"3xl":40,full:9999},shadows:{xs:"0 2px 4px rgba(0,0,0,0.4)",sm:"0 4px 8px rgba(0,0,0,0.5)",md:"0 8px 16px rgba(0,0,0,0.6)",lg:"0 16px 32px rgba(0,0,0,0.6)",xl:"0 24px 48px rgba(0,0,0,0.7)",cardHover:"0 0 20px rgba(99,102,241,0.3), 0 0 0 1px rgba(255,255,255,0.1)",glow:"0 0 30px rgba(6,182,212,0.4)"},typography:{headingWeight:700,bodyWeight:400,letterSpacing:"normal",lineHeight:"relaxed"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#030712",surface:"rgba(17, 24, 39, 0.6)",elevated:"rgba(31, 41, 55, 0.6)",overlay:"rgba(3, 7, 18, 0.8)",subtle:"rgba(255,255,255,0.03)"},primary:{DEFAULT:"#6366F1",50:"#EEF2FF",100:"#E0E7FF",200:"#C7D2FE",300:"#A5B4FC",400:"#818CF8",500:"#6366F1",600:"#4F46E5",700:"#4338CA",800:"#3730A3",900:"#312E81"},accent:{DEFAULT:"#06B6D4",50:"#ECFEFF",100:"#CFFAFE",200:"#A5F3FC",300:"#67E8F9",400:"#22D3EE",500:"#06B6D4",600:"#0891B2",700:"#0E7490",800:"#155E75",900:"#164E63"},...xe,info:{DEFAULT:"#3B82F6",light:"rgba(59,130,246,0.12)",dark:"#2563EB",500:"#3B82F6",800:"#1E40AF"},text:"#F8FAFC",muted:"#94A3B8",border:"rgba(255,255,255,0.08)",border2:"rgba(255,255,255,0.15)",titlebar:{bg:"#030712",text:"#94A3B8",active:"#6366F1",button:"rgba(255,255,255,0.05)",buttonHover:"rgba(255,255,255,0.1)",close:"#EF4444"},secondary:{DEFAULT:"#06B6D4",500:"#06B6D4"},surface:"rgba(17, 24, 39, 0.4)",panel:"rgba(17, 24, 39, 0.6)",gray:{50:"#F8FAFC",100:"#F1F5F9",200:"#E2E8F0",300:"#CBD5E1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1E293B",900:"#0F172A"}}},je={name:"cleanProfessional",label:"Clean Pro (v2)",description:"Corporate light interface with a consistent navy-blue tinted palette",category:"corporate",preview:{bg:"#EFF2F7",primary:"#1B4F8E",accent:"#0E7490"},primaryRgb:"27,79,142",design:{radius:{sm:6,md:8,lg:12,xl:16,"2xl":24,"3xl":32,full:9999},shadows:{xs:"0 1px 2px rgba(27,79,142,0.06)",sm:"0 1px 4px rgba(27,79,142,0.08), 0 1px 2px rgba(0,0,0,0.04)",md:"0 4px 8px rgba(27,79,142,0.10), 0 2px 4px rgba(0,0,0,0.05)",lg:"0 10px 20px rgba(27,79,142,0.12), 0 4px 8px rgba(0,0,0,0.06)",xl:"0 20px 32px rgba(27,79,142,0.14), 0 8px 16px rgba(0,0,0,0.06)",cardHover:"0 8px 20px rgba(27,79,142,0.14), 0 0 0 1px rgba(27,79,142,0.08)",glow:"0 0 0 3px rgba(27,79,142,0.18)"},typography:{headingWeight:700,bodyWeight:400,letterSpacing:"tight",lineHeight:"normal"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#EFF2F7",surface:"#FFFFFF",elevated:"#E6ECF5",overlay:"rgba(240,244,250,0.97)",subtle:"rgba(27,79,142,0.03)"},primary:{DEFAULT:"#1B4F8E",50:"#EFF4FD",100:"#D9E5F8",200:"#B3CBEF",300:"#7AAEE2",400:"#4A8FD5",500:"#2272C3",600:"#1B4F8E",700:"#163F72",800:"#102E55",900:"#0B1F39"},accent:{DEFAULT:"#0E7490",50:"#F0FAFC",100:"#CCEEF5",200:"#99DDEB",300:"#5EC8DC",400:"#29B0CB",500:"#0E96B0",600:"#0E7490",700:"#0B5A70",800:"#084252",900:"#052E39"},success:{DEFAULT:"#0D9466",light:"rgba(13,148,102,0.10)",dark:"#067A53"},warning:{DEFAULT:"#B45309",light:"rgba(180,83,9,0.10)",dark:"#92400E",800:"#78350F"},danger:{DEFAULT:"#B91C1C",light:"rgba(185,28,28,0.10)",dark:"#991B1B"},error:{DEFAULT:"#B91C1C",light:"rgba(185,28,28,0.10)",dark:"#991B1B"},info:{DEFAULT:"#1B4F8E",light:"rgba(27,79,142,0.10)",dark:"#163F72",500:"#2272C3",800:"#102E55"},text:"#1A2233",muted:"#5A6A8A",border:"#C8D4E8",border2:"#A8BEDD",titlebar:{bg:"#FFFFFF",text:"#5A6A8A",active:"#1B4F8E",button:"#EFF2F7",buttonHover:"#DDE5F2",close:"#B91C1C"},secondary:{DEFAULT:"#5A6A8A",500:"#5A6A8A"},surface:"#FFFFFF",panel:"#FFFFFF",gray:{50:"#F8FAFD",100:"#EFF2F7",200:"#DDE5F2",300:"#C8D4E8",400:"#9BACC8",500:"#7188A8",600:"#506080",700:"#3A4D6A",800:"#253350",900:"#141E33"}}},ke={name:"electricPulse",label:"Electric Pulse (v3)",description:"High energy dark mode with vibrant neon gradients",category:"industrial",preview:{bg:"#09090B",primary:"#FF3D00",accent:"#7C3AED"},primaryRgb:"255, 61, 0",design:{radius:{sm:4,md:12,lg:20,xl:24,"2xl":32,"3xl":40,full:9999},shadows:{xs:"0 1px 2px rgba(0,0,0,0.5)",sm:"0 1px 3px rgba(0,0,0,0.5)",md:"0 4px 6px -1px rgba(0,0,0,0.5), 0 2px 4px -1px rgba(0,0,0,0.3)",lg:"0 10px 15px -3px rgba(0,0,0,0.5), 0 4px 6px -2px rgba(0,0,0,0.3)",xl:"0 20px 25px -5px rgba(0,0,0,0.5), 0 10px 10px -5px rgba(0,0,0,0.3)",cardHover:"0 0 25px rgba(255, 61, 0, 0.25), 0 0 0 2px rgba(255, 61, 0, 0.1)",glow:"0 0 20px rgba(255, 61, 0, 0.4)"},typography:{headingWeight:700,bodyWeight:500,letterSpacing:"wide",lineHeight:"relaxed"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#09090B",surface:"#18181B",elevated:"#27272A",overlay:"rgba(9, 9, 11, 0.95)",subtle:"rgba(255,255,255,0.02)"},primary:{DEFAULT:"#FF3D00",50:"#FFF7ED",100:"#FFEDD5",200:"#FED7AA",300:"#FDBA74",400:"#FB923C",500:"#FF3D00",600:"#EA580C",700:"#C2410C",800:"#9A3412",900:"#7C2D12"},accent:{DEFAULT:"#7C3AED",50:"#F5F3FF",100:"#EDE9FE",200:"#DDD6FE",300:"#C4B5FD",400:"#A78BFA",500:"#8B5CF6",600:"#7C3AED",700:"#6D28D9",800:"#5B21B6",900:"#4C1D95"},...xe,info:{DEFAULT:"#3B82F6",light:"rgba(59,130,246,0.12)",dark:"#2563EB",500:"#3B82F6",800:"#1E40AF"},text:"#FAFAFA",muted:"#A1A1AA",border:"#3F3F46",border2:"#52525B",titlebar:{bg:"#09090B",text:"#A1A1AA",active:"#FF3D00",button:"#18181B",buttonHover:"#27272A",close:"#EF4444"},secondary:{DEFAULT:"#7C3AED",500:"#7C3AED"},surface:"#18181B",panel:"#18181B",gray:{50:"#FAFAFA",100:"#F4F4F5",200:"#E4E4E7",300:"#D4D4D8",400:"#A1A1AA",500:"#71717A",600:"#52525B",700:"#3F3F46",800:"#27272A",900:"#18181B"}}},Se={name:"lightNavy",label:"Light Navy",description:"Sadece lacivert ve beyaz — monokromatik kurumsal arayüz",category:"corporate",preview:{bg:"#EDF0F5",primary:"#1E3A5F",accent:"#4D7AB8"},primaryRgb:"30,58,95",design:{radius:{sm:6,md:8,lg:12,xl:16,"2xl":20,"3xl":28,full:9999},shadows:{xs:"0 1px 2px rgba(30,58,95,0.06)",sm:"0 2px 6px rgba(30,58,95,0.09), 0 1px 2px rgba(0,0,0,0.04)",md:"0 4px 12px rgba(30,58,95,0.11), 0 2px 4px rgba(0,0,0,0.05)",lg:"0 10px 24px rgba(30,58,95,0.13), 0 4px 8px rgba(0,0,0,0.06)",xl:"0 20px 40px rgba(30,58,95,0.15), 0 8px 16px rgba(0,0,0,0.06)",cardHover:"0 8px 24px rgba(30,58,95,0.16), 0 0 0 1px rgba(30,58,95,0.10)",glow:"0 0 0 3px rgba(30,58,95,0.18)"},typography:{headingWeight:700,bodyWeight:400,letterSpacing:"tight",lineHeight:"normal"},borders:{width:1,style:"solid"}},colors:{bg:{main:"#EDF0F5",surface:"#FFFFFF",elevated:"#E2E7F0",overlay:"rgba(237,240,245,0.97)",subtle:"rgba(30,58,95,0.04)"},primary:{DEFAULT:"#1E3A5F",50:"#EEF2F8",100:"#D5DFED",200:"#ABBFDB",300:"#7A9CC4",400:"#507CAD",500:"#2F62A0",600:"#1E3A5F",700:"#172E4A",800:"#102136",900:"#091522"},accent:{DEFAULT:"#4D7AB8",50:"#EEF3FA",100:"#D1DFF2",200:"#A3BFE5",300:"#759ED7",400:"#4D7AB8",500:"#3A6099",600:"#2A4875",700:"#1E3456",800:"#122038",900:"#080D1A"},success:{DEFAULT:"#1E3A5F",light:"rgba(30,58,95,0.10)",dark:"#172D4A"},warning:{DEFAULT:"#344060",light:"rgba(52,64,96,0.10)",dark:"#202D45",800:"#111B2D"},danger:{DEFAULT:"#202D45",light:"rgba(32,45,69,0.12)",dark:"#111B2D"},error:{DEFAULT:"#202D45",light:"rgba(32,45,69,0.12)",dark:"#111B2D"},info:{DEFAULT:"#4D7AB8",light:"rgba(77,122,184,0.10)",dark:"#1E3A5F",500:"#4D7AB8",800:"#0E2338"},text:"#0D1B2E",muted:"#4B5E7A",border:"#C0CBDB",border2:"#A4B3C8",titlebar:{bg:"#FFFFFF",text:"#4B5E7A",active:"#1E3A5F",button:"#EDF0F5",buttonHover:"#D5DFED",close:"#1E3A5F"},secondary:{DEFAULT:"#4B5E7A",500:"#4B5E7A"},surface:"#FFFFFF",panel:"#FFFFFF",gray:{50:"#F8F9FC",100:"#EDF0F5",200:"#D5DFED",300:"#C0CBDB",400:"#8FA0B8",500:"#637894",600:"#4B5E7A",700:"#344060",800:"#202D45",900:"#0D1B2E"}}},Ee={neoCorporate:ye,minimalStudio:be,industrialGrid:fe,deepSpace:ve,cleanProfessional:je,electricPulse:ke,lightNavy:Se},Ae=[Se,ke,ve,je,ye,be,fe],we="electricPulse";function Fe(){var e,t;try{const r=localStorage.getItem("optiplan-ui-storage");if(r){const i=JSON.parse(r),n=null==(e=null==i?void 0:i.state)?void 0:e.themeName;if("string"==typeof(t=n)&&t in Ee)return n}}catch{}return we}function De(e){const t=e.replace("#","");if(6!==t.length)return"59,130,246";return`${Number.parseInt(t.slice(0,2),16)},${Number.parseInt(t.slice(2,4),16)},${Number.parseInt(t.slice(4,6),16)}`}const Te={tight:"-0.02em",normal:"0",wide:"0.03em"},ze={compact:1.3,normal:1.5,relaxed:1.7},Ce={heading:'"Segoe UI", "Space Grotesk", system-ui, sans-serif',base:'"Segoe UI", "IBM Plex Sans", system-ui, sans-serif',display:'"Segoe UI", "Space Grotesk", system-ui, sans-serif',mono:'"Cascadia Code", "JetBrains Mono", Consolas, monospace'},Ne={neoCorporate:{heading:'"Space Grotesk", "Segoe UI", system-ui, sans-serif',base:'"IBM Plex Sans", "Segoe UI", system-ui, sans-serif',display:'"Space Grotesk", "Segoe UI", system-ui, sans-serif',mono:'"JetBrains Mono", "Cascadia Code", Consolas, monospace'},minimalStudio:{heading:'"Source Sans 3", "Segoe UI", system-ui, sans-serif',base:'"Source Sans 3", "Segoe UI", system-ui, sans-serif',display:'"Source Sans 3", "Segoe UI", system-ui, sans-serif',mono:'"Roboto Mono", "Cascadia Code", Consolas, monospace'},industrialGrid:{heading:'"Archivo Narrow", "Segoe UI", "Arial Narrow", system-ui, sans-serif',base:'"Barlow", "Segoe UI", system-ui, sans-serif',display:'"Archivo Narrow", "Segoe UI", "Arial Narrow", system-ui, sans-serif',mono:'"Roboto Mono", "Cascadia Code", Consolas, monospace'}};function Le(e){return e?"string"==typeof e?Ee[e]??Ee[we]:e:Ee[Fe()]}function Oe(e){const t=e.design,r=Te[t.typography.letterSpacing]??Te.normal,i=ze[t.typography.lineHeight]??ze.normal;return{fontSize:{xs:11,sm:12,base:14,lg:16,xl:18,"2xl":20,"3xl":24,"4xl":30},fontWeight:{normal:400,medium:500,semibold:600,bold:700,extrabold:800},fontFamily:Ne[e.name]??Ce,scale:{h1:{size:24,weight:t.typography.headingWeight,family:"heading",tracking:r},h2:{size:20,weight:t.typography.headingWeight-100,family:"heading",tracking:r},h3:{size:16,weight:t.typography.headingWeight-100,family:"heading",tracking:r},label:{size:12,weight:600,family:"base",tracking:"0.03em"},body:{size:14,weight:t.typography.bodyWeight,family:"base",tracking:r},caption:{size:11,weight:500,family:"base",tracking:"0.02em"},data:{size:14,weight:500,family:"mono",tracking:"0.02em"},kpi:{size:30,weight:t.typography.headingWeight,family:"heading",tracking:"-0.02em"}},lineHeight:i}}let $e=Le(),Ie=$e.primaryRgb||De($e.colors.primary.DEFAULT),_e=$e.colors,Be=Oe($e),Pe=$e.design.radius,Re=$e.design.shadows;function Ue(e){return`rgba(${Ie},${e})`}const We={fast:"all .15s ease"},Me=1e3,Ge=1400,Ke=1700;const He=({children:t,variant:r="primary",size:i="md",icon:n,type:a="button",onClick:s,disabled:o=!1,loading:l=!1,fullWidth:d=!1,style:c={},title:p,"aria-label":u})=>{const[g,m]=e.useState(!1),[h,x]=e.useState(!1),y=o||l,b={fontFamily:Be.fontFamily.base,fontWeight:Be.fontWeight.semibold,borderRadius:Pe.lg,border:"1px solid transparent",cursor:y?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:8,transition:We.fast,opacity:y?.48:1,width:d?"100%":"auto",whiteSpace:"nowrap",position:"relative",transform:h&&!y?"translateY(1px)":"translateY(0)",letterSpacing:"0.01em",backdropFilter:"blur(8px)"},f={sm:{padding:"8px 12px",fontSize:Be.fontSize.xs,minHeight:"40px",minWidth:"40px"},md:{padding:"10px 16px",fontSize:Be.fontSize.sm,minHeight:"44px",minWidth:"44px"},lg:{padding:"12px 20px",fontSize:Be.fontSize.base,minHeight:"48px",minWidth:"48px"}},v={primary:{background:h?`linear-gradient(135deg, ${_e.primary[700]}, ${_e.accent[700]})`:g?`linear-gradient(135deg, ${_e.primary[600]}, ${_e.accent[600]})`:`linear-gradient(135deg, ${_e.primary.DEFAULT}, ${_e.accent.DEFAULT})`,color:"#ffffff",boxShadow:g&&!y?"0 0 0 1px rgba(var(--primary-rgb), 0.28), 0 12px 30px rgba(var(--primary-rgb), 0.28)":"0 2px 10px rgba(0,0,0,0.35)"},secondary:{background:h?"linear-gradient(135deg, rgba(var(--primary-rgb),0.22), rgba(var(--primary-rgb),0.18))":g?"linear-gradient(135deg, rgba(var(--primary-rgb),0.18), rgba(var(--primary-rgb),0.14))":"linear-gradient(135deg, rgba(var(--primary-rgb),0.12), rgba(var(--primary-rgb),0.08))",color:_e.text,border:"1px solid rgba(var(--primary-rgb), 0.30)",boxShadow:g&&!y?"0 0 18px rgba(var(--primary-rgb), 0.18)":"none"},ghost:{background:h?"rgba(255,255,255,0.12)":g?"rgba(255,255,255,0.08)":"rgba(255,255,255,0.02)",color:_e.text,border:`1px solid ${_e.border}`},danger:{background:h?"linear-gradient(135deg, #b91c1c, #dc2626)":g?"linear-gradient(135deg, #dc2626, #ef4444)":"linear-gradient(135deg, #ef4444, #f87171)",color:"#fff",border:"1px solid rgba(239,68,68,0.45)",boxShadow:g&&!y?Re.sm:"none"}};return ue.jsxs("button",{type:a,style:{...b,...f[i],...v[r],...c},onClick:s,disabled:y,title:p,onMouseEnter:()=>m(!0),onMouseLeave:()=>{m(!1),x(!1)},onMouseDown:()=>x(!0),onMouseUp:()=>x(!1),"aria-label":u,children:[l&&ue.jsx("span",{className:"btn-spinner"}),!l&&n&&ue.jsx("span",{style:{fontSize:"1.05em",lineHeight:1},"aria-hidden":"true",children:n}),t]})},Je=({children:t,title:r,subtitle:i,icon:n,actions:a,hoverable:s=!1,style:o={},className:l,...d})=>{const[c,p]=e.useState(!1),u=["shared-card",s?"is-hoverable":"",c?"is-hovered":"",l??""].filter(Boolean).join(" ");return ue.jsxs("div",{className:u,onMouseEnter:()=>s&&p(!0),onMouseLeave:()=>s&&p(!1),style:o,...d,children:[(r||a)&&ue.jsxs("div",{className:"shared-card-header",children:[ue.jsxs("div",{className:"shared-card-heading",children:[n?ue.jsx("span",{className:"shared-card-icon",children:n}):null,ue.jsxs("div",{className:"shared-card-title-wrap",children:[r?ue.jsx("span",{className:"shared-card-title",children:r}):null,i?ue.jsx("span",{className:"shared-card-subtitle",children:i}):null]})]}),a?ue.jsx("div",{className:"shared-card-actions",children:a}):null]}),ue.jsx("div",{className:"shared-card-body "+(r||a?"has-header":"is-standalone"),children:t})]})},Ye=({data:e=[3,5,2,7,4,6,8,5,9,6],color:t=_e.primary[500],width:r=80,height:i=28})=>{const n=Math.max(...e),a=Math.min(...e),s=n-a||1,o=e.map((t,n)=>`${n/(e.length-1)*r},${i-(t-a)/s*(i-4)-2}`).join(" "),l=`sp-${t.replace("#","")}`;return ue.jsxs("svg",{width:r,height:i,viewBox:`0 0 ${r} ${i}`,style:{display:"block"},children:[ue.jsx("defs",{children:ue.jsxs("linearGradient",{id:l,x1:"0",y1:"0",x2:"0",y2:"1",children:[ue.jsx("stop",{offset:"0%",stopColor:t,stopOpacity:"0.3"}),ue.jsx("stop",{offset:"100%",stopColor:t,stopOpacity:"0"})]})}),ue.jsx("polygon",{points:`0,${i} ${o} ${r},${i}`,fill:`url(#${l})`}),ue.jsx("polyline",{points:o,fill:"none",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})},Ve=({icon:t,label:r,value:i,change:n,color:a,sparkData:s})=>{const[o,l]=e.useState(0),d="number"==typeof i?i:Number.parseFloat(i),c=Number.isFinite(d);return e.useEffect(()=>{if(!c)return;let e=0;const t=Math.max(1,Math.ceil(d/28));let r;const i=()=>{e+=t,e>=d?l(d):(l(e),r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>cancelAnimationFrame(r)},[d,c]),ue.jsx(Je,{hoverable:!0,style:{height:"100%",position:"relative",overflow:"hidden"},children:ue.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[ue.jsxs("div",{style:{flex:1,minWidth:0},children:[ue.jsx("p",{style:{fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.muted,margin:"0 0 8px",textTransform:"uppercase",letterSpacing:"0.08em"},children:r}),ue.jsx("p",{style:{fontSize:30,fontWeight:Be.fontWeight.bold,color:_e.text,margin:0,fontFamily:Be.fontFamily.heading,letterSpacing:"-0.02em"},children:c?Math.round(10*o)/10:i}),void 0!==n?ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:8},children:[ue.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:Pe.full,fontSize:11,fontWeight:Be.fontWeight.semibold,background:n>0?_e.success.light:_e.danger.light,color:n>0?_e.success.DEFAULT:_e.danger.DEFAULT},children:[n>0?"▲":"▼"," ",Math.abs(n),"%"]}),ue.jsx("span",{style:{fontSize:11,color:_e.gray[400]},children:"vs dün"})]}):null]}),ue.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:8},children:[ue.jsx("div",{style:{width:42,height:42,borderRadius:Pe.lg,background:`${a}18`,border:`1px solid ${a}22`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:Be.fontWeight.semibold,color:a},children:t}),s?ue.jsx(Ye,{data:s,color:a}):null]})]})})},qe=[{id:1,icon:ue.jsx(i,{size:16,"aria-hidden":!0}),text:"Yeni sipariş: OP-2026-0848 oluşturuldu",time:"2 dk önce",read:!1},{id:2,icon:ue.jsx(n,{size:16,"aria-hidden":!0}),text:"OP-2026-0845 üretime alındı",time:"15 dk önce",read:!1},{id:3,icon:ue.jsx(a,{size:16,color:_e.success.DEFAULT,"aria-hidden":!0}),text:"OP-2026-0842 kesim tamamlandı",time:"1 saat önce",read:!0},{id:4,icon:ue.jsx(s,{size:16,"aria-hidden":!0}),text:"Ege Mutfak'a WhatsApp gönderildi",time:"2 saat önce",read:!0},{id:5,icon:ue.jsx(o,{size:16,"aria-hidden":!0}),text:"OCR: siparis_04.jpg işlendi",time:"3 saat önce",read:!0}],Xe=()=>{const[t,r]=e.useState(!1),i=qe.filter(e=>!e.read).length;return ue.jsxs("div",{style:{position:"relative"},children:[ue.jsxs("button",{onClick:()=>r(!t),style:{position:"relative",background:"rgba(255,255,255,.05)",border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"7px 10px",cursor:"pointer",fontSize:16,lineHeight:1,color:_e.muted,transition:"all .12s ease"},children:[ue.jsx(l,{size:16,"aria-label":"Bildirimler"}),i>0&&ue.jsx("span",{style:{position:"absolute",top:-4,right:-4,minWidth:16,height:16,borderRadius:"50%",background:_e.danger.DEFAULT,color:"#fff",fontSize:9,fontWeight:Be.fontWeight.bold,display:"flex",alignItems:"center",justifyContent:"center",animation:"pulse-dot 1.5s ease-in-out infinite"},children:i})]}),t&&ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{style:{position:"fixed",inset:0,zIndex:Me-1},onClick:()=>r(!1)}),ue.jsxs("div",{style:{position:"absolute",top:"calc(100% + 8px)",right:0,width:340,background:"rgba(9,9,11,.96)",backdropFilter:"blur(16px)",border:`1px solid ${_e.border2}`,borderRadius:Pe.xl,boxShadow:Re.lg,zIndex:Me,overflow:"hidden"},children:[ue.jsxs("div",{style:{padding:"14px 16px",borderBottom:`1px solid ${_e.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsx("span",{style:{fontSize:14,fontWeight:Be.fontWeight.bold},children:"Bildirimler"}),i>0&&ue.jsx("span",{style:{fontSize:11,color:_e.primary[500],cursor:"pointer"},children:"Tümünü okundu işaretle"})]}),ue.jsx("div",{style:{maxHeight:320,overflowY:"auto"},children:qe.map(e=>ue.jsxs("div",{style:{display:"flex",gap:10,padding:"12px 16px",cursor:"pointer",borderBottom:`1px solid ${_e.border}`,background:e.read?"transparent":Ue(.04),transition:"background .12s ease"},children:[ue.jsx("span",{style:{fontSize:16,flexShrink:0,marginTop:2},children:e.icon}),ue.jsxs("div",{style:{flex:1,minWidth:0},children:[ue.jsx("div",{style:{fontSize:13,color:e.read?_e.muted:_e.text,lineHeight:1.4},children:e.text}),ue.jsx("div",{style:{fontSize:11,color:_e.gray[400],marginTop:3},children:e.time})]})]},e.id))})]})]}),ue.jsx("style",{children:"\n        @keyframes pulse-dot {\n          0%, 100% { opacity: 1; transform: scale(1); }\n          50% { opacity: 0.8; transform: scale(1.05); }\n        }\n      "})]})},Ze=({priority:e})=>{const t={urgent:{color:_e.danger.DEFAULT,label:"Acil"},high:{color:_e.danger.DEFAULT,label:"Yüksek"},normal:{color:_e.info.DEFAULT,label:"Normal"},low:{color:_e.gray[500],label:"Düşük"}},r=t[e]||t.normal;return ue.jsx("span",{style:{padding:"2px 8px",borderRadius:Pe.full,background:`${r.color}18`,border:`1px solid ${r.color}30`,color:r.color,fontSize:10,fontWeight:Be.fontWeight.semibold,textTransform:"uppercase",letterSpacing:"0.05em"},children:r.label})};function Qe({status:e,variant:t="secondary",children:r,animated:i=!1,style:n}){if(e){const t={DRAFT:{label:"Taslak",color:_e.gray[400],bg:"rgba(159,176,208,0.10)",icon:"DR"},NEW:{label:"Yeni",color:_e.info.DEFAULT,bg:_e.info.light,icon:"NW"},PENDING_APPROVAL:{label:"Onay Bekliyor",color:_e.warning.DEFAULT,bg:_e.warning.light,icon:"PA"},HOLD:{label:"Bekletme",color:_e.warning.DEFAULT,bg:_e.warning.light,icon:"HD"},IN_PRODUCTION:{label:"Üretimde",color:_e.accent.DEFAULT,bg:_e.accent[50],icon:"PR"},APPROVED:{label:"Onaylı",color:_e.success.DEFAULT,bg:_e.success.light,icon:"AP"},READY:{label:"Hazır",color:_e.success.DEFAULT,bg:_e.success.light,icon:"OK"},DELIVERED:{label:"Teslim",color:_e.primary[500],bg:_e.primary[50],icon:"TS"},CANCELLED:{label:"İptal",color:_e.danger.DEFAULT,bg:_e.danger.light,icon:"IP"},DONE:{label:"Tamamlandı",color:_e.gray[400],bg:"rgba(255,255,255,0.06)",icon:"DN"},COMPLETED:{label:"Tamamlandı",color:_e.gray[400],bg:"rgba(255,255,255,0.06)",icon:"DN"}}[e];if(!t)return null;const r="IN_PRODUCTION"===e||"NEW"===e;return ue.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 12px",borderRadius:Pe.full,background:`${t.color}18`,border:`1px solid ${t.color}30`,fontSize:12,fontWeight:Be.fontWeight.semibold,color:t.color,transition:"all .2s ease",...n},children:[i||r?ue.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:t.color,animation:"pulse-dot 1.5s ease-in-out infinite"}}):ue.jsx("span",{style:{fontSize:12},children:t.icon}),t.label]})}const a={success:{bg:"rgba(74,222,128,0.15)",border:"rgba(74,222,128,0.35)",color:_e.success.DEFAULT},secondary:{bg:"rgba(115,115,115,0.15)",border:"rgba(115,115,115,0.35)",color:_e.gray[300]},warning:{bg:"rgba(251,191,36,0.15)",border:"rgba(251,191,36,0.35)",color:_e.warning.DEFAULT},danger:{bg:"rgba(244,63,94,0.15)",border:"rgba(244,63,94,0.35)",color:_e.danger.DEFAULT},info:{bg:"rgba(167,139,250,0.15)",border:"rgba(167,139,250,0.35)",color:_e.info.DEFAULT}}[t];return ue.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"4px 12px",borderRadius:Pe.full,background:a.bg,border:`1px solid ${a.border}`,fontSize:12,fontWeight:Be.fontWeight.semibold,color:a.color,transition:"all .2s ease",...n},children:r})}function et({open:t,onClose:r,title:i,subtitle:n,children:a,wide:s=!1,id:o="modal-dialog"}){const l=e.useRef(null),d=e.useRef(null),c=e.useRef(r);return e.useEffect(()=>{c.current=r},[r]),e.useEffect(()=>{var e;if(!t)return;d.current=document.activeElement;const r=null==(e=l.current)?void 0:e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=null==r?void 0:r[0];return setTimeout(()=>null==i?void 0:i.focus(),0),()=>{var e;null==(e=d.current)||e.focus()}},[t]),e.useEffect(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),c.current())},r=e=>{var t;if("Tab"!==e.key)return;const r=null==(t=l.current)?void 0:t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!r||0===r.length)return;const i=r[0],n=r[r.length-1],a=document.activeElement;e.shiftKey?a===i&&(e.preventDefault(),n.focus()):a===n&&(e.preventDefault(),i.focus())};return document.addEventListener("keydown",e),document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keydown",r)}},[t]),t?ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{role:"presentation",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:Ge,animation:"modalBgIn .2s ease"},"aria-hidden":"true"}),ue.jsx("div",{ref:l,role:"dialog","aria-modal":"true","aria-labelledby":`${o}-title`,"aria-describedby":n?`${o}-subtitle`:void 0,style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:Ge+1,pointerEvents:"none"},children:ue.jsxs("div",{style:{background:_e.panel,borderRadius:Pe.xl,border:`1px solid ${_e.border2}`,width:"90%",maxWidth:s?700:500,maxHeight:"85vh",overflowY:"auto",boxShadow:Re["2xl"],animation:"modalSlideIn .25s cubic-bezier(.22,1,.36,1)",pointerEvents:"auto"},children:[ue.jsxs("div",{style:{padding:"20px 24px",borderBottom:`1px solid ${_e.border}`,display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:16},children:[ue.jsxs("div",{style:{flex:1},children:[ue.jsx("h2",{id:`${o}-title`,style:{margin:0,fontSize:18,fontWeight:Be.fontWeight.bold,color:_e.text},children:i}),n?ue.jsx("p",{id:`${o}-subtitle`,style:{margin:"6px 0 0",fontSize:13,color:_e.muted},children:n}):null]}),ue.jsx("button",{onClick:r,"aria-label":"Kapat",type:"button",style:{width:48,height:48,minWidth:48,borderRadius:Pe.md,background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:_e.muted,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",transition:"all .15s ease",padding:0},onMouseEnter:e=>{e.currentTarget.style.background=`${_e.error.DEFAULT}20`,e.currentTarget.style.color=_e.error.DEFAULT},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color=_e.muted},children:"X"})]}),ue.jsx("div",{style:{padding:24},children:a})]})}),ue.jsx("style",{children:"\n        @keyframes modalBgIn { from { opacity: 0; } to { opacity: 1; } }\n        @keyframes modalSlideIn { from { opacity: 0; transform: translateY(-20px) scale(.97); } to { opacity: 1; transform: translateY(0) scale(1); } }\n      "})]}):null}const tt=({type:t="text",id:i,value:n,onChange:a,onBlur:s,onFocus:o,label:l,placeholder:p,error:u,helperText:g,disabled:m=!1,required:h=!1,size:x="md",variant:y="outline",icon:b,clearable:f=!1,onClear:v,maxLength:j,minLength:k,min:S,max:E,step:A,pattern:w,autoComplete:F,inputMode:D,ariaLabel:T,ariaDescribedBy:z,containerStyle:C={},style:N={}})=>{const[L,O]=e.useState(!1),[$,I]=e.useState(!1),_=e.useRef(null),B={sm:{padding:"8px 10px",fontSize:12,minHeight:44},md:{padding:"10px 12px",fontSize:14,minHeight:44},lg:{padding:"12px 16px",fontSize:16,minHeight:48}},P={outline:{border:`1px solid ${u?_e.error.DEFAULT:L?_e.primary[500]:_e.border}`,background:_e.panel,color:_e.text,transition:`all ${We.fast}`},filled:{border:"none",borderBottom:`2px solid ${u?_e.error.DEFAULT:L?_e.primary[500]:"rgba(255,255,255,.1)"}`,background:"rgba(255,255,255,.04)",color:_e.text},expanded:{border:`2px solid ${u?_e.error.DEFAULT:L?_e.primary[500]:"transparent"}`,borderRadius:Pe.lg,background:L?"rgba(255,255,255,.08)":"rgba(255,255,255,.04)",color:_e.text}},R="password"===t&&$?"text":t;return ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,...C},children:[l&&ue.jsxs("label",{htmlFor:i,style:{fontSize:13,fontWeight:Be.fontWeight.semibold,color:_e.text,display:"flex",alignItems:"center",gap:4},children:[l,h&&ue.jsx("span",{style:{color:_e.error.DEFAULT,fontSize:16},children:"*"})]}),ue.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",gap:8,...B[x],...P[y],borderRadius:"filled"===y?0:Pe.md,paddingRight:f&&n||"password"===t?8:B[x].padding.split(" ")[1]},children:[b&&ue.jsx("span",{style:{color:_e.muted,display:"flex",alignItems:"center"},children:b}),ue.jsx("input",{ref:_,id:i,type:R,value:n,onChange:a,onFocus:e=>{O(!0),null==o||o(e)},onBlur:e=>{O(!1),null==s||s(e)},placeholder:p,disabled:m,maxLength:j,minLength:k,min:S,max:E,step:A,pattern:w,inputMode:D,autoComplete:F,"aria-label":T||l,"aria-invalid":!!u,"aria-describedby":u?`${z||""}-error`:z,style:{flex:1,outline:"none",background:"transparent",border:"none",color:"inherit",fontSize:"inherit",fontFamily:Be.fontFamily.base,cursor:m?"not-allowed":"text",opacity:m?.5:1,...N}}),"password"===t&&ue.jsx("button",{type:"button",onClick:()=>I(!$),"aria-label":$?"Şifreyi gizle":"Şifreyi göster",style:{background:"none",border:"none",cursor:"pointer",padding:"8px",minWidth:"44px",minHeight:"44px",color:_e.muted,fontSize:18,display:"flex",alignItems:"center",justifyContent:"center"},children:$?ue.jsx(d,{size:18,"aria-hidden":"true"}):ue.jsx(c,{size:18,"aria-hidden":"true"})}),f&&n&&ue.jsx("button",{type:"button",onClick:v,"aria-label":"Alanı temizle",style:{background:"none",border:"none",cursor:"pointer",padding:"8px",minWidth:"44px",minHeight:"44px",color:_e.muted,fontSize:18,display:"flex",alignItems:"center",justifyContent:"center"},children:ue.jsx(r,{size:14})})]}),u&&ue.jsx("span",{id:`${z||""}-error`,role:"alert",style:{fontSize:12,color:_e.error.DEFAULT,fontWeight:Be.fontWeight.medium},children:u}),g&&!u&&ue.jsxs("span",{style:{fontSize:12,color:_e.muted,display:"flex",justifyContent:"space-between"},children:[ue.jsx("span",{children:g}),j&&ue.jsxs("span",{children:[String(n).length,"/",j]})]})]})},rt=({id:t,value:i,onChange:n,options:a,label:s,placeholder:o,error:l,helperText:d,disabled:c=!1,required:p=!1,size:u="md",clearable:g=!1,searchable:m=!1,ariaLabel:h,ariaDescribedBy:x,containerStyle:y={}})=>{var b;const[f,v]=e.useState(!1),[j,k]=e.useState(""),S=m?a.filter(e=>e.label.toLowerCase().includes(j.toLowerCase())):a,E=(null==(b=a.find(e=>e.value===i))?void 0:b.label)||o;return ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,...y},children:[s&&ue.jsxs("label",{htmlFor:t,style:{fontSize:13,fontWeight:Be.fontWeight.semibold,color:_e.text},children:[s,p&&ue.jsx("span",{style:{color:_e.error.DEFAULT},children:"*"})]}),ue.jsxs("div",{style:{position:"relative"},children:[ue.jsxs("button",{id:t,type:"button",onClick:()=>v(!f),"aria-label":h||s,"aria-haspopup":"listbox","aria-expanded":f,"aria-describedby":l?`${x||""}-error`:x,style:{width:"100%",...{sm:{padding:"8px 10px",fontSize:12,minHeight:44},md:{padding:"10px 12px",fontSize:14,minHeight:44},lg:{padding:"12px 16px",fontSize:16,minHeight:48}}[u],border:`1px solid ${l?_e.error.DEFAULT:f?_e.primary[500]:_e.border}`,background:_e.panel,color:_e.text,borderRadius:Pe.md,display:"flex",justifyContent:"space-between",alignItems:"center",cursor:c?"not-allowed":"pointer",opacity:c?.5:1,fontSize:14,fontFamily:Be.fontFamily.base},children:[ue.jsx("span",{children:E}),ue.jsx("span",{style:{transform:f?"rotate(180deg)":"rotate(0)",transition:`transform ${We.fast}`},children:"▼"})]}),f&&ue.jsxs("div",{role:"listbox",style:{position:"absolute",top:"calc(100% + 4px)",left:0,right:0,background:_e.panel,border:`1px solid ${_e.border}`,borderRadius:Pe.md,boxShadow:Re.md,zIndex:1e3,maxHeight:200,overflowY:"auto"},children:[m&&ue.jsx("input",{type:"text",placeholder:"Ara...",value:j,onChange:e=>k(e.target.value),style:{width:"100%",padding:"8px",border:`1px solid ${_e.border}`,background:"transparent",color:_e.text,fontSize:13,borderRadius:Pe.md,outline:"none",marginBottom:4}}),S.map(e=>ue.jsx("button",{role:"option","aria-selected":i===e.value,onClick:()=>{n(e.value),v(!1),k("")},disabled:e.disabled,style:{width:"100%",padding:"10px 12px",border:"none",background:i===e.value?`${_e.primary[500]}20`:"transparent",color:i===e.value?_e.primary[500]:_e.text,textAlign:"left",cursor:e.disabled?"not-allowed":"pointer",opacity:e.disabled?.5:1,fontSize:14,fontWeight:i===e.value?Be.fontWeight.semibold:Be.fontWeight.normal,transition:`background ${We.fast}`},onMouseEnter:t=>{e.disabled||(t.currentTarget.style.background="rgba(255,255,255,.05)")},onMouseLeave:t=>{t.currentTarget.style.background=i===e.value?`${_e.primary[500]}20`:"transparent"},children:e.label},e.value)),0===S.length&&ue.jsx("div",{style:{padding:"10px 12px",color:_e.muted,fontSize:13,textAlign:"center"},children:"Sonuç bulunamadı"})]}),!f&&g&&i&&ue.jsx("button",{type:"button",onClick:()=>n(""),style:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:_e.muted,fontSize:16},children:ue.jsx(r,{size:12})})]}),l&&ue.jsx("span",{role:"alert",style:{fontSize:12,color:_e.error.DEFAULT},children:l}),d&&!l&&ue.jsx("span",{style:{fontSize:12,color:_e.muted},children:d})]})};function it(e,t){let r;try{r=e()}catch(i){return}return{getItem:e=>{var t;const i=e=>null===e?null:JSON.parse(e,void 0),n=null!=(t=r.getItem(e))?t:null;return n instanceof Promise?n.then(i):i(n)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}const nt=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then:e=>nt(e)(r),catch(e){return this}}}catch(r){return{then(e){return this},catch:e=>nt(e)(r)}}},at=(e,t)=>(r,i,n)=>{let a={storage:it(()=>window.localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1,o=0;const l=new Set,d=new Set;let c=a.storage;if(!c)return e((...e)=>{r(...e)},i,n);const p=()=>{const e=a.partialize({...i()});return c.setItem(a.name,{state:e,version:a.version})},u=n.setState;n.setState=(e,t)=>(u(e,t),p());const g=e((...e)=>(r(...e),p()),i,n);let m;n.getInitialState=()=>g;const h=()=>{var e,t;if(!c)return;const n=++o;s=!1,l.forEach(e=>{var t;return e(null!=(t=i())?t:g)});const u=(null==(t=a.onRehydrateStorage)?void 0:t.call(a,null!=(e=i())?e:g))||void 0;return nt(c.getItem.bind(c))(a.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===a.version)return[!1,e.state];if(a.migrate){const t=a.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}}return[!1,void 0]}).then(e=>{var t;if(n!==o)return;const[s,l]=e;return m=a.merge(l,null!=(t=i())?t:g),r(m,!0),s?p():void 0}).then(()=>{n===o&&(null==u||u(m,void 0),m=i(),s=!0,d.forEach(e=>e(m)))}).catch(e=>{n===o&&(null==u||u(void 0,e))})};return n.persist={setOptions:e=>{a={...a,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>h(),hasHydrated:()=>s,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},a.skipHydration||h(),m||g};function st(e){if("undefined"==typeof document)return;const t=document.documentElement;t.setAttribute("data-ui-theme",e.name);const r=e.colors.accent[600]??e.colors.accent.DEFAULT,i=function(e,t){const r=e.replace("#","");return 6!==r.length?`rgba(124,58,237,${t})`:`rgba(${Number.parseInt(r.slice(0,2),16)},${Number.parseInt(r.slice(2,4),16)},${Number.parseInt(r.slice(4,6),16)},${t})`}(e.colors.accent.DEFAULT,.24),n=e.colors.gray[500]??e.colors.muted;t.style.setProperty("--bg-main",e.colors.bg.main),t.style.setProperty("--bg-surface",e.colors.bg.surface),t.style.setProperty("--bg-elevated",e.colors.bg.elevated),t.style.setProperty("--bg-card",e.colors.bg.surface),t.style.setProperty("--bg-card-hover",e.colors.bg.elevated),t.style.setProperty("--bg-overlay",e.colors.bg.overlay),t.style.setProperty("--bg-subtle",e.colors.bg.subtle),t.style.setProperty("--primary",e.colors.primary.DEFAULT),t.style.setProperty("--primary-hover",e.colors.primary[600]),t.style.setProperty("--primary-rgb",e.primaryRgb),t.style.setProperty("--primary-glow",`rgba(${e.primaryRgb},0.20)`),t.style.setProperty("--accent",e.colors.accent.DEFAULT),t.style.setProperty("--accent-hover",r),t.style.setProperty("--accent-glow",i),t.style.setProperty("--success",e.colors.success.DEFAULT),t.style.setProperty("--warning",e.colors.warning.DEFAULT),t.style.setProperty("--danger",e.colors.danger.DEFAULT),t.style.setProperty("--danger-hover",e.colors.danger.dark),t.style.setProperty("--text-main",e.colors.text),t.style.setProperty("--text-muted",e.colors.muted),t.style.setProperty("--text-dim",n),t.style.setProperty("--border",e.colors.border),t.style.setProperty("--border-highlight",e.colors.border2),t.style.setProperty("--titlebar-bg",e.colors.titlebar.bg),t.style.setProperty("--titlebar-text",e.colors.titlebar.text),t.style.setProperty("--titlebar-close",e.colors.titlebar.close),t.style.setProperty("--radius-sm",`${e.design.radius.sm}px`),t.style.setProperty("--radius-md",`${e.design.radius.md}px`),t.style.setProperty("--radius-lg",`${e.design.radius.lg}px`),t.style.setProperty("--radius-xl",`${e.design.radius.xl}px`),t.style.setProperty("--shadow-card",e.design.shadows.sm),t.style.setProperty("--shadow-elevated",e.design.shadows.md),t.style.setProperty("--shadow-glow",e.design.shadows.glow),t.style.setProperty("--font-heading",Be.fontFamily.heading),t.style.setProperty("--font-body",Be.fontFamily.base),t.style.setProperty("--font-mono",Be.fontFamily.mono)}function ot(e){const t=function(e){return"string"==typeof e?Ee[e]??Ee[we]:e}(e),r=function(e){const t=Le(e);return $e=t,Ie=t.primaryRgb||De(t.colors.primary.DEFAULT),_e=t.colors,Be=Oe(t),Pe=t.design.radius,Re=t.design.shadows,$e}(t);return st(r),r}const lt="electricPulse";ot(lt);const dt=ee()(at(e=>({theme:"dark",themeName:lt,sidebarCollapsed:!1,toggleTheme:()=>e(e=>({theme:"light"===e.theme?"dark":"light"})),toggleSidebar:()=>e(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setSidebarCollapsed:t=>e({sidebarCollapsed:t}),setThemeName:t=>{ot(t),e({themeName:t})}}),{name:"optiplan-ui-storage",onRehydrateStorage:()=>e=>{(null==e?void 0:e.themeName)&&ot(e.themeName)}}));_e.bg.main,_e.bg.surface,_e.bg.main,Pe.md;const ct=ee(e=>({notifications:[],addNotification:t=>{const r=`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;e(e=>({notifications:[...e.notifications,{...t,id:r}]})),t.duration&&setTimeout(()=>{e(e=>({notifications:e.notifications.filter(e=>e.id!==r)}))},t.duration)},removeNotification:t=>{e(e=>({notifications:e.notifications.filter(e=>e.id!==t)}))},clearAll:()=>{e({notifications:[]})}})),pt={success:ue.jsx(m,{className:"w-5 h-5 text-green-500"}),error:ue.jsx(g,{className:"w-5 h-5 text-red-500"}),warning:ue.jsx(u,{className:"w-5 h-5 text-yellow-500"}),info:ue.jsx(p,{className:"w-5 h-5 text-blue-500"})},ut={success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"},gt={success:"text-green-800",error:"text-red-800",warning:"text-yellow-800",info:"text-blue-800"},mt=()=>{const{notifications:e,removeNotification:t}=ct();return ue.jsx("div",{className:"fixed top-6 right-6 z-50 w-96 max-w-[calc(100vw-2rem)] space-y-3",children:e.map(e=>ue.jsx(ht,{notification:e,onClose:()=>t(e.id)},e.id))})},ht=({notification:t,onClose:i})=>(e.useEffect(()=>{t.duration&&t.duration},[t]),ue.jsxs("div",{className:`\n        border rounded-lg p-4 shadow-lg flex items-start gap-3\n        transform transition-all duration-300 animate-in fade-in slide-in-from-right-4\n        ${ut[t.type]}\n      `,role:"alert",children:[ue.jsx("div",{className:"flex-shrink-0 mt-0.5",children:pt[t.type]}),ue.jsxs("div",{className:"flex-1 min-w-0",children:[ue.jsx("p",{className:`font-medium text-sm ${gt[t.type]}`,children:t.message}),t.description&&ue.jsx("p",{className:`text-xs mt-1 opacity-75 ${gt[t.type]}`,children:t.description}),t.action&&ue.jsx("button",{onClick:()=>{t.action.onClick(),i()},className:`text-xs font-semibold mt-2 underline hover:no-underline ${gt[t.type]}`,children:t.action.label})]}),ue.jsx("button",{onClick:i,className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Bildirimi kapat",style:{minWidth:44,minHeight:44,display:"flex",alignItems:"center",justifyContent:"center"},children:ue.jsx(r,{className:"w-4 h-4"})})]}));let xt={isOpen:!1,title:"",message:""},yt=null;const bt=()=>({confirm:e=>new Promise(t=>{yt&&yt({...e,isOpen:!0,confirmText:e.confirmText||"Evet",cancelText:e.cancelText||"Hayır",type:e.type||"warning",onResolve:e=>{t(e)}})})}),ft=h.createContext(null),vt=({children:t})=>{const[r,i]=e.useState(xt);return h.useEffect(()=>{xt=r,yt=i},[r]),ue.jsxs(ft.Provider,{value:{state:r,setState:i},children:[t,ue.jsx(jt,{})]})},jt=()=>{const t=h.useContext(ft),r=e.useRef(null),i=e.useRef(null);if(!t)return null;const{state:n,setState:a}=t,s=()=>{n.onResolve&&n.onResolve(!1),a({...n,isOpen:!1})};if(e.useEffect(()=>{var e;if(!n.isOpen)return;i.current=document.activeElement;const t=null==(e=r.current)?void 0:e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');(null==t?void 0:t.length)&&setTimeout(()=>{var e;return null==(e=t[t.length-1])?void 0:e.focus()},0);const a=e=>{if("Escape"===e.key)return e.preventDefault(),void s();if("Tab"===e.key&&t&&t.length>0){const r=t[0],i=t[t.length-1];e.shiftKey&&document.activeElement===r?(e.preventDefault(),i.focus()):e.shiftKey||document.activeElement!==i||(e.preventDefault(),r.focus())}};return document.addEventListener("keydown",a),()=>{var e;document.removeEventListener("keydown",a),null==(e=i.current)||e.focus()}},[n.isOpen]),!n.isOpen)return null;const o={trash:ue.jsx(x,{className:"w-12 h-12 text-red-500"}),warning:ue.jsx(u,{className:"w-12 h-12 text-yellow-500"}),info:ue.jsx(g,{className:"w-12 h-12 text-blue-500"})},l={danger:{bg:"bg-red-50",border:"border-red-200",button:"bg-red-600 hover:bg-red-700",text:"text-red-800"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",button:"bg-yellow-600 hover:bg-yellow-700",text:"text-yellow-800"},info:{bg:"bg-blue-50",border:"border-blue-200",button:"bg-blue-600 hover:bg-blue-700",text:"text-blue-800"}}[n.type||"warning"],d=o[n.icon||"warning"];return ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity",onClick:s}),ue.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:ue.jsxs("div",{ref:r,className:`\n            ${l.bg} border ${l.border}\n            rounded-lg shadow-2xl p-6 max-w-md w-full\n            transform transition-all\n          `,role:"alertdialog","aria-modal":"true","aria-labelledby":"dialog-title","aria-describedby":"dialog-description",children:[ue.jsx("div",{className:"flex justify-center mb-4",children:d}),ue.jsx("h2",{id:"dialog-title",className:`text-xl font-bold text-center mb-2 ${l.text}`,children:n.title}),ue.jsx("p",{id:"dialog-description",className:"text-gray-700 text-center mb-2",children:n.message}),n.description&&ue.jsx("p",{className:"text-sm text-gray-600 text-center mb-6",children:n.description}),ue.jsxs("div",{className:"flex gap-3",children:[ue.jsx("button",{onClick:s,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg transition-colors",children:n.cancelText}),ue.jsx("button",{onClick:()=>{n.onResolve&&n.onResolve(!0),a({...n,isOpen:!1})},className:`flex-1 ${l.button} text-white font-semibold py-2 px-4 rounded-lg transition-colors`,children:n.confirmText})]}),ue.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"İpucu: ESC tuşuna basarak iptal edebilirsiniz"})]})})]})},kt=({title:e,subtitle:t,breadcrumbs:r,children:i,centerContent:n})=>{const a=Boolean(n);return ue.jsxs("header",{className:"topbar-shell",children:[r?ue.jsx("nav",{className:"topbar-breadcrumbs","aria-label":"Breadcrumb navigasyonu",children:ue.jsx("ol",{children:r.map((e,t)=>ue.jsxs("li",{children:[t>0?ue.jsx("span",{className:"topbar-breadcrumb-separator","aria-hidden":"true",children:"/"}):null,ue.jsx("span",{className:t===r.length-1?"is-current":"",children:e})]},e+t))})}):null,ue.jsxs("div",{className:"topbar-layout "+(a?"has-center":""),children:[ue.jsxs("div",{className:"topbar-heading "+(a?"with-center":""),children:[ue.jsx("h1",{className:"topbar-title",children:e}),t?ue.jsx("p",{className:"topbar-subtitle",children:t}):null]}),a?ue.jsx("div",{className:"topbar-center-slot",children:n}):null,ue.jsxs("div",{className:"topbar-tools",role:"region","aria-label":"Sayfa araclari",children:[a?null:ue.jsx(he,{}),i,ue.jsx(Xe,{})]})]})]})},St=ee()(at(e=>({isAuthenticated:!1,token:null,user:null,login:(t,r)=>e({isAuthenticated:!0,token:t,user:r}),logout:()=>e({isAuthenticated:!1,token:null,user:null})}),{name:"optiplan-auth-storage"})),Et="8080",At=new Set([404,502,503,504]);function wt(e){return e.replace(/_([a-z])/g,(e,t)=>t.toUpperCase())}function Ft(e){if(null==e)return e;if(Array.isArray(e))return e.map(e=>Ft(e));if("object"==typeof e){const t={};for(const[r,i]of Object.entries(e)){t[wt(r)]=Ft(i)}return Array.isArray(t.parts)&&t.parts.length>0&&"object"==typeof t.parts[0]&&null!==t.parts[0]&&"boyMm"in t.parts[0]&&(t.parts=t.parts.length),t}return e}function Dt(){var e;try{const t=localStorage.getItem("optiplan-auth-storage");if(!t)return null;const r=JSON.parse(t),i=null==(e=null==r?void 0:r.state)?void 0:e.token;return"string"==typeof i&&i.trim()?i:null}catch{return null}}function Tt(){return Dt()}function zt(e){const t=e.replace(/\/+$/,"");return t.endsWith("/api/v1")?t:t.endsWith("/api")?`${t}/v1`:`${t}/api/v1`}function Ct(){return zt("http://127.0.0.1:8000".trim()||"/api")}function Nt(e,t,r){const i=null==r?void 0:r.trim();i&&!t.has(i)&&(t.add(i),e.push(i))}async function Lt(e,t){const r=e.startsWith("/")?e:`/${e}`,i=function(){const e=Ct(),t=[],r=new Set;if(Nt(t,r,e),!e.startsWith("/"))return t;const i="http://127.0.0.1:8080".trim();if(i)try{const e="undefined"!=typeof window?window.location.origin:"http://127.0.0.1",n=new URL(i,e);Nt(t,r,zt(`${n.protocol}//${n.host}/api`))}catch{}if("undefined"!=typeof window){const e="https:"===window.location.protocol?"https:":"http:",i=window.location.hostname||"127.0.0.1";Nt(t,r,`${e}//${i}:${Et}/api/v1`),"127.0.0.1"!==i&&Nt(t,r,`${e}//127.0.0.1:${Et}/api/v1`),"localhost"!==i&&Nt(t,r,`${e}//localhost:${Et}/api/v1`)}return t}();let n=null,a=null;for(let o=0;o<i.length;o+=1){const e=i[o],l=`${e}${r}`,d=o<i.length-1;try{const r=await fetch(l,t);if(d&&e.startsWith("/")&&At.has(r.status)){n=r;continue}return r}catch(s){if(a=s,!d)throw s}}if(n)return n;throw a instanceof Error?a:new Error("API request failed")}let Ot=null;function $t(e){const t=function(e){try{const t=e.split(".");if(3!==t.length)return null;const r=JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")));return"number"==typeof r.exp?r.exp:null}catch{return null}}(e);if(null===t)return!1;return t-Math.floor(Date.now()/1e3)<600}async function It(e){try{const t=await Lt("/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok)return null;const r=await t.json(),i=null==r?void 0:r.token;return i?(function(e){try{const t=localStorage.getItem("optiplan-auth-storage");if(!t)return;const r=JSON.parse(t);(null==r?void 0:r.state)&&(r.state.token=e,localStorage.setItem("optiplan-auth-storage",JSON.stringify(r)))}catch{}}(i),i):null}catch{return null}}async function _t(e,t={}){const{skipAuth:r=!1,_isRetry:i=!1,headers:n,...a}=t,s=r?null:await async function(){const e=Dt();return e?$t(e)?(Ot||(Ot=It(e).finally(()=>{Ot=null})),await Ot??e):e:null}(),o=a.body,l=Boolean(null==n?void 0:n["Content-Type"])||Boolean(null==n?void 0:n["content-type"]),d=!(o instanceof FormData||l);let c;try{c=await Lt(e,{...a,headers:{...d?{"Content-Type":"application/json"}:{},...n||{},...s?{Authorization:`Bearer ${s}`}:{}}})}catch{throw new Error("Sunucuya baglanilamadi. API servisinin calistigini kontrol edin.")}const p=await c.text();let u=null;if(p)try{u=JSON.parse(p)}catch{u=p}if(!c.ok){if(401===c.status&&!r&&!i){const r=Dt();if(r){if(await It(r))return _t(e,{...t,_isRetry:!0})}localStorage.removeItem("optiplan-auth-storage"),localStorage.removeItem("optiplan-auth-token"),window.dispatchEvent(new CustomEvent("auth:session-expired"))}const n="object"==typeof u&&null!==u?u.detail||u.message||`HTTP ${c.status}`:"string"==typeof u&&u.trim()||`HTTP ${c.status}`;throw new Error(n)}return Ft(u)}const Bt=new Map,Pt=new Map;function Rt(){const[t,r]=e.useState(null),[i,n]=e.useState(!0),[a,s]=e.useState(null),o=St(e=>e.user),l=St(e=>e.isAuthenticated);e.useEffect(()=>{if(!l||!o)return n(!1),void r(null);const e=`perms_${o.role}`;(async()=>{const t=Bt.get(e);if(t&&(i=t,Date.now()-i.cachedAt<36e5))return r(t.data),void n(!1);var i;n(!0),s(null);try{let t=Pt.get(e);t||(t=fetch(`${Ct()}/config/permissions`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${St.getState().token}`}}).then(e=>{if(!e.ok)throw new Error(`İzin sorgusu başarısız: HTTP ${e.status}`);return e.json()}).then(t=>(Bt.set(e,{data:t,cachedAt:Date.now()}),t)).finally(()=>{Pt.delete(e)}),Pt.set(e,t));const i=await t;if(!i.success)throw new Error(i.error??"İzin bilgisi alınamadı");r(i)}catch(a){const e=a instanceof Error?a.message:"İzin sorgusu başarısız";s(e),r({success:!1,user_role:o.role,user_permissions:[],all_roles:{},cache_key:"",error:e})}finally{n(!1)}})()},[o,l]);const d=(null==t?void 0:t.user_permissions)??[];return{permissions:d,hasPermission:e=>d.includes(e),hasAllPermissions:(...e)=>e.every(e=>d.includes(e)),hasAnyPermission:(...e)=>e.some(e=>d.includes(e)),loading:i,error:a}}const Ut="Optiplan",Wt="360",Mt="AI Fabrika Kontrol Merkezi",Gt="optiplan-sidebar-collapsed-groups",Kt="optiplan-sidebar-favorites";function Ht(e,t){try{const t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch{}return t}const Jt={ADMIN:{operations:{orders:!0,kanban:!0,reports:!0,crm:!0,payment:!0,priceTracking:!0,aiAssistant:!0,orchestrator:!0},system:{settings:!0,integrations:!0,organization:!0,stations:!0},users:{manage:!0,roles:!0,activity:!0},monitoring:{logs:!0,audit:!0,analytics:!0}},OPERATOR:{operations:{orders:!0,kanban:!0,reports:!0,crm:!0,payment:!0,priceTracking:!0,aiAssistant:!0,orchestrator:!0},system:{settings:!1,integrations:!1,organization:!1,stations:!1},users:{manage:!1,roles:!1,activity:!0},monitoring:{logs:!0,audit:!1,analytics:!1}},STATION:{operations:{orders:!1,kanban:!0,reports:!1,crm:!1,payment:!1,priceTracking:!1,aiAssistant:!1,orchestrator:!1},system:{settings:!1,integrations:!1,organization:!1,stations:!0},users:{manage:!1,roles:!1,activity:!1},monitoring:{logs:!1,audit:!1,analytics:!1}}};function Yt({label:e,children:t}){return ue.jsxs("div",{className:"sidebar-tooltip-wrapper",children:[t,ue.jsx("span",{className:"sidebar-tooltip",children:e})]})}function Vt({displayName:t,userRole:r,onLogout:i}){const[n,a]=e.useState(!1),s=e.useRef(null);return e.useEffect(()=>{if(!n)return;const e=e=>{s.current&&!s.current.contains(e.target)&&a(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]),e.useEffect(()=>{if(!n)return;const e=e=>{"Escape"===e.key&&a(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),ue.jsxs("div",{className:"sidebar-collapsed-user-popup-anchor",ref:s,children:[ue.jsx("button",{type:"button",className:"sidebar-user-avatar sidebar-collapsed-avatar-btn",onClick:()=>a(e=>!e),"aria-label":`Kullanici: ${t} (${r})`,"aria-expanded":n,"aria-haspopup":"menu",children:t.split(" ").map(e=>e[0]??"").join("").slice(0,2).toUpperCase()}),n&&ue.jsxs("div",{className:"sidebar-collapsed-user-popup",role:"menu","aria-label":"Kullanici menusu",children:[ue.jsxs("div",{className:"sidebar-popup-user-info",children:[ue.jsx("span",{className:"sidebar-popup-user-name",children:t}),ue.jsx("span",{className:"sidebar-popup-user-role",children:r})]}),ue.jsxs("button",{type:"button",className:"sidebar-popup-logout",onClick:()=>{null==i||i(),a(!1)},role:"menuitem",children:[ue.jsx(j,{size:14}),"Cikis Yap"]})]})]})}const qt=({page:r,onNav:i,collapsed:a,mobileOpen:s=!1,onToggle:o,userRole:l="ADMIN",currentUser:d,onLogout:c,badgeCounts:p})=>{const u=(null==d?void 0:d.fullName)||(null==d?void 0:d.username)||(null==d?void 0:d.email)||"Kullanici",g=u.split(" ").map(e=>e[0]??"").join("").slice(0,2).toUpperCase(),{hasPermission:m,loading:h,error:x}=Rt(),P=e.useMemo(()=>h||x?Jt[l]??Jt.STATION:{operations:{orders:m("orders:view"),kanban:m("kanban:view"),reports:m("reports:view"),crm:m("crm:view"),payment:m("payment:view"),priceTracking:m("price_tracking:view"),aiAssistant:m("ai_assistant:view"),orchestrator:m("orchestrator:view")},system:{settings:m("settings:view"),integrations:m("integrations:view"),organization:m("organization:view"),stations:m("stations:view")},users:{manage:m("users:manage"),roles:m("roles:manage"),activity:m("activity:view")},monitoring:{logs:m("logs:view"),audit:m("audit:view"),analytics:m("analytics:view")}},[x,m,h,l]),R=e.useMemo(()=>function(e,r){return[{id:"operations",title:"Operasyonlar",items:[e.operations.orders?{id:"orders",icon:ue.jsx(k,{size:18,"aria-hidden":"true"}),label:"Siparişler",badge:null==r?void 0:r.orders}:null,e.operations.kanban?{id:"kanban",icon:ue.jsx(S,{size:18,"aria-hidden":"true"}),label:"Akış Panoları",badge:null==r?void 0:r.kanban}:null,e.operations.crm||e.operations.orders?{id:"card-management",icon:ue.jsx(E,{size:18,"aria-hidden":"true"}),label:"Müşteri Yönetimi",badge:null==r?void 0:r.payment}:null,e.operations.crm?{id:"crm-tickets",icon:ue.jsx(A,{size:18,"aria-hidden":"true"}),label:"Destek Biletleri"}:null,e.operations.priceTracking?{id:"price-tracking",icon:ue.jsx(w,{size:18,"aria-hidden":"true"}),label:"Fiyat Takip"}:null].filter(Boolean)},{id:"production",title:"Üretim",items:[e.operations.orchestrator?{id:"orchestrator",icon:ue.jsx(F,{size:18,"aria-hidden":"true"}),label:"OptiPlanning Jobs",badge:null==r?void 0:r.orchestrator}:null,e.operations.orchestrator?{id:"product-search",icon:ue.jsx(t,{size:18,"aria-hidden":"true"}),label:"Ürün Arama"}:null,e.system.stations?{id:"stations",icon:ue.jsx(n,{size:18,"aria-hidden":"true"}),label:"İstasyonlar"}:null].filter(Boolean)},{id:"analytics",title:"Analiz & AI",items:[{id:"dashboard",icon:ue.jsx(D,{size:18,"aria-hidden":"true"}),label:"AI Gösterge Paneli"},e.operations.reports||e.monitoring.analytics?{id:"reports-analytics",icon:ue.jsx(T,{size:18,"aria-hidden":"true"}),label:"Raporlar & Analitik"}:null,e.operations.aiAssistant?{id:"ai-assistant",icon:ue.jsx(z,{size:18,"aria-hidden":"true"}),label:"AI Asistan"}:null].filter(Boolean)},{id:"monitoring",title:"İzleme",items:[e.system.integrations?{id:"integration-health",icon:ue.jsx(C,{size:18,"aria-hidden":"true"}),label:"Entegrasyon Durumu"}:null,e.monitoring.logs||e.monitoring.audit?{id:"system-logs",icon:ue.jsx(N,{size:18,"aria-hidden":"true"}),label:"Sistem Günlükleri",badge:null==r?void 0:r.systemLogs}:null,e.users.activity?{id:"user-activity",icon:ue.jsx(C,{size:18,"aria-hidden":"true"}),label:"Kullanıcı Aktivitesi"}:null].filter(Boolean)},{id:"settings",title:"Ayarlar",items:[e.system.organization?{id:"organization",icon:ue.jsx(L,{size:18,"aria-hidden":"true"}),label:"Organizasyon"}:null,e.system.settings?{id:"config",icon:ue.jsx(O,{size:18,"aria-hidden":"true"}),label:"Sistem Ayarları"}:null,e.system.integrations?{id:"integrations",icon:ue.jsx($,{size:18,"aria-hidden":"true"}),label:"Entegrasyonlar"}:null,e.users.manage||e.users.roles?{id:"user-management",icon:ue.jsx(I,{size:18,"aria-hidden":"true"}),label:"Kullanıcı Yönetimi"}:null,e.system.settings?{id:"workflows",icon:ue.jsx(S,{size:18,"aria-hidden":"true"}),label:"Otomasyonlar"}:null,e.system.settings?{id:"api-portal",icon:ue.jsx(_,{size:18,"aria-hidden":"true"}),label:"API Portal"}:null,e.system.settings?{id:"ai-config",icon:ue.jsx(O,{size:18,"aria-hidden":"true"}),label:"AI Konfigürasyon"}:null].filter(Boolean)}].filter(e=>e.items.length>0)}(P,p),[P,p]),[U,W]=e.useState(()=>Ht(Kt,[])),M=e.useCallback(e=>{W(t=>{const r=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(Kt,JSON.stringify(r)),r})},[]),G=e.useMemo(()=>{if(0===U.length)return[];const e=R.flatMap(e=>e.items);return U.map(t=>e.find(e=>e.id===t)).filter(Boolean)},[U,R]),[K,H]=e.useState(()=>Ht(Gt,[])),J=e.useCallback(e=>{H(t=>{const r=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(Gt,JSON.stringify(r)),r})},[]),[Y,V]=e.useState(""),q=e.useRef(null),X=e.useMemo(()=>{if(!Y.trim())return R;const e=Y.toLowerCase();return R.map(t=>({...t,items:t.items.filter(t=>t.label.toLowerCase().includes(e))})).filter(e=>e.items.length>0)},[R,Y]),Z=(e,t)=>{const n=r===e.id,s=U.includes(e.id),o=ue.jsxs("button",{type:"button",className:`sidebar-nav-btn ${n?"is-active":""} ${a?"is-collapsed":""}`,onClick:()=>i(e.id),"aria-current":n?"page":void 0,"aria-label":`${e.label}${e.badge?` (${e.badge} yeni)`:""}`,title:a?e.label:void 0,children:[ue.jsx("span",{className:"sidebar-nav-icon","aria-hidden":"true",children:e.icon}),a?null:ue.jsx("span",{className:"sidebar-nav-label",children:e.label}),!a&&e.badge?ue.jsx("span",{className:"sidebar-nav-badge",children:e.badge}):null,a&&e.badge?ue.jsx("span",{className:"sidebar-nav-badge-dot"}):null]});return a?ue.jsx(Yt,{label:e.label,children:o},e.id):ue.jsxs("div",{className:"sidebar-nav-item",children:[o,t?ue.jsx("button",{type:"button",className:"sidebar-fav-btn "+(s?"is-fav":""),onClick:t=>{t.stopPropagation(),M(e.id)},"aria-label":s?`${e.label} favorilerden cikar`:`${e.label} favorilere ekle`,title:s?"Favorilerden cikar":"Favorilere ekle",children:ue.jsx(B,{size:12,fill:s?"currentColor":"none"})}):null]},e.id)};return ue.jsxs("nav",{className:`sidebar-shell ${a?"is-collapsed":""} ${s?"is-open":""}`,"aria-label":"Ana navigasyon",children:[ue.jsxs("div",{className:"sidebar-brand "+(a?"is-collapsed":""),children:[ue.jsx("button",{type:"button",className:"sidebar-brand-mark",onClick:o,title:a?"Menuyu genislet":"Menuyu daralt","aria-label":"Kenar menusu ac veya kapat",children:Ut[0]}),a?null:ue.jsxs(ue.Fragment,{children:[ue.jsxs("div",{className:"sidebar-brand-text",children:[ue.jsxs("div",{className:"sidebar-brand-title",children:[Ut,ue.jsx("span",{children:Wt})]}),ue.jsx("div",{className:"sidebar-brand-sub",children:Mt})]}),ue.jsx("button",{type:"button",className:"sidebar-collapse-btn",onClick:o,"aria-label":"Menuyu daralt",title:"Menuyu daralt",children:ue.jsx(y,{size:15})})]})]}),a?null:ue.jsxs("div",{className:"sidebar-filter",children:[ue.jsx(b,{size:14,className:"sidebar-filter-icon"}),ue.jsx("input",{ref:q,type:"text",className:"sidebar-filter-input",placeholder:"Menu ara...",value:Y,onChange:e=>V(e.target.value),"aria-label":"Menu oegeleri filtrele"}),Y?ue.jsx("button",{type:"button",className:"sidebar-filter-clear",onClick:()=>V(""),"aria-label":"Filtreyi temizle",children:"×"}):null]}),ue.jsxs("div",{className:"sidebar-scroll",role:"region","aria-label":"Menu listesi",children:[G.length>0&&!Y?ue.jsxs("section",{className:"sidebar-group sidebar-group-favorites",children:[a?null:ue.jsx("h2",{className:"sidebar-group-title sidebar-group-title-fav",children:"Favoriler"}),ue.jsx("div",{className:"sidebar-group-items",children:G.map(e=>Z(e,!1))})]}):null,X.map(e=>{const t=K.includes(e.id)&&!Y;return ue.jsxs("section",{className:"sidebar-group",children:[a?null:ue.jsxs("button",{type:"button",className:"sidebar-group-header",onClick:()=>J(e.id),"aria-expanded":!t,"aria-controls":`sidebar-group-${e.id}`,children:[ue.jsx("h2",{className:"sidebar-group-title",children:e.title}),ue.jsx("span",{className:"sidebar-group-chevron","aria-hidden":"true",children:t?ue.jsx(f,{size:12}):ue.jsx(v,{size:12})})]}),t?null:ue.jsx("div",{className:"sidebar-group-items",id:`sidebar-group-${e.id}`,children:e.items.map(e=>Z(e,!a))})]},e.id)})]}),ue.jsx("div",{className:"sidebar-user",children:a?ue.jsx(Vt,{displayName:u,userRole:l,onLogout:c}):ue.jsxs(ue.Fragment,{children:[ue.jsxs("div",{className:"sidebar-user-row",children:[ue.jsx("div",{className:"sidebar-user-avatar","aria-label":`Kullanici: ${u} (${l})`,children:g}),ue.jsxs("div",{className:"sidebar-user-meta",children:[ue.jsx("div",{className:"sidebar-user-name",children:u}),ue.jsx("div",{className:"sidebar-user-role",children:l})]})]}),ue.jsxs("button",{type:"button",className:"sidebar-logout",onClick:()=>null==c?void 0:c(),"aria-label":"Oturumu kapat",children:[ue.jsx(j,{size:14}),"Cikis Yap"]})]})})]})},Xt=({title:e,subtitle:t,isMenuOpen:i,onMenuToggle:n,userName:a,userRole:s})=>ue.jsxs("header",{className:"mobile-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",background:"linear-gradient(180deg, rgba(14, 19, 31, 0.98), rgba(11, 15, 24, 0.95))",borderBottom:`1px solid ${_e.border}`,position:"sticky",top:0,zIndex:100,backdropFilter:"blur(12px)"},children:[ue.jsx("button",{type:"button",onClick:n,style:{display:"flex",alignItems:"center",justifyContent:"center",width:44,height:44,background:"transparent",border:`1px solid ${_e.border}`,borderRadius:10,color:_e.text,cursor:"pointer",transition:"all 0.2s ease"},"aria-label":i?"Menüyü kapat":"Menüyü aç","aria-expanded":i,children:i?ue.jsx(r,{size:22}):ue.jsx(P,{size:22})}),ue.jsxs("div",{style:{flex:1,textAlign:"center",margin:"0 12px",minWidth:0},children:[ue.jsx("h1",{style:{margin:0,fontSize:16,fontWeight:700,color:_e.text,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e}),t&&ue.jsx("p",{style:{margin:"2px 0 0",fontSize:11,color:_e.muted,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),ue.jsx("div",{style:{width:40,height:40,borderRadius:"50%",background:`linear-gradient(135deg, ${_e.primary.DEFAULT}, #8b5cf6)`,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:12,fontWeight:700,flexShrink:0,border:`2px solid ${_e.border}`},"aria-label":`${a||"Kullanıcı"} (${s||"Misafir"})`,children:a?a.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase():"??"})]}),Zt=[{id:"p-dashboard",type:"page",title:"Gösterge Paneli",description:"Ana sayfa",icon:ue.jsx(T,{size:18}),action:()=>{},shortcut:"Ctrl+1"},{id:"p-orders",type:"page",title:"Siparişler",description:"Sipariş yönetimi",icon:ue.jsx(k,{size:18}),action:()=>{},shortcut:"Ctrl+2"},{id:"p-kanban",type:"page",title:"Akış Panoları",description:"Kanban board",icon:ue.jsx(S,{size:18}),action:()=>{}},{id:"p-card-management",type:"page",title:"Müşteri Yönetimi",description:"Cari ve stok kartları yönetimi",icon:ue.jsx(E,{size:18}),action:()=>{},shortcut:"Ctrl+3"},{id:"p-reports-analytics",type:"page",title:"Raporlar & Analitik",description:"Performans raporları ve metrikler",icon:ue.jsx(T,{size:18}),action:()=>{},shortcut:"Ctrl+4"},{id:"p-price-tracking",type:"page",title:"Fiyat Takip",description:"Fiyat değişim takibi",icon:ue.jsx(w,{size:18}),action:()=>{}},{id:"p-ai-assistant",type:"page",title:"AI Asistan",description:"Yapay zeka asistanı",icon:ue.jsx(z,{size:18}),action:()=>{}},{id:"p-orchestrator",type:"page",title:"OptiPlanning Jobs",description:"Kesim optimizasyonu iş takibi",icon:ue.jsx(F,{size:18}),action:()=>{}},{id:"p-product-search",type:"page",title:"Ürün Arama",description:"Spec-first ürün ve malzeme arama",icon:ue.jsx(t,{size:18}),action:()=>{}},{id:"p-stations",type:"page",title:"İstasyonlar",description:"Üretim istasyonları",icon:ue.jsx(n,{size:18}),action:()=>{}},{id:"p-system-logs",type:"page",title:"Sistem Günlükleri",description:"Loglar ve denetim kayıtları",icon:ue.jsx(N,{size:18}),action:()=>{}},{id:"p-integration-health",type:"page",title:"Entegrasyon Durumu",description:"Sistem sağlık durumu",icon:ue.jsx(C,{size:18}),action:()=>{}},{id:"p-user-activity",type:"page",title:"Kullanıcı Aktivitesi",description:"Kullanıcı hareketleri",icon:ue.jsx(I,{size:18}),action:()=>{}},{id:"p-user-management",type:"page",title:"Kullanıcı Yönetimi",description:"Kullanıcılar, roller ve yetkiler",icon:ue.jsx(I,{size:18}),action:()=>{}},{id:"p-integrations",type:"page",title:"Entegrasyonlar",description:"Sistem entegrasyonları",icon:ue.jsx(O,{size:18}),action:()=>{}},{id:"p-whatsapp-business",type:"page",title:"WhatsApp Business",description:"WhatsApp entegrasyonu",icon:ue.jsx(U,{size:18}),action:()=>{}},{id:"p-config",type:"page",title:"Sistem Ayarları",description:"Genel ayarlar",icon:ue.jsx(O,{size:18}),action:()=>{}},{id:"p-workflows",type:"page",title:"Otomasyonlar",description:"İş akışı otomasyonları",icon:ue.jsx(S,{size:18}),action:()=>{}},{id:"p-api-portal",type:"page",title:"API Portal",description:"API yönetim portalı",icon:ue.jsx(_,{size:18}),action:()=>{}},{id:"p-ai-config",type:"page",title:"AI Konfigürasyon",description:"AI model ayarları",icon:ue.jsx(O,{size:18}),action:()=>{}},{id:"p-organization",type:"page",title:"Organizasyon",description:"Organizasyon yönetimi",icon:ue.jsx(I,{size:18}),action:()=>{}}],Qt=[{id:"a-new-order",type:"action",title:"Yeni Sipariş Oluştur",description:"Sipariş editörünü aç",icon:ue.jsx(k,{size:18}),action:()=>{},shortcut:"Ctrl+N"},{id:"a-refresh",type:"action",title:"Sayfayı Yenile",description:"Verileri tazele",icon:ue.jsx(R,{size:18}),action:()=>{},shortcut:"Ctrl+R"}],er=({isOpen:r,onClose:i,onNavigate:n})=>{const[a,s]=e.useState(""),[o,l]=e.useState(0),[d,c]=e.useState([]),p=e.useRef(null);e.useEffect(()=>{try{const e=localStorage.getItem("optiplan-recent-searches");e&&c(JSON.parse(e))}catch{}},[]),e.useEffect(()=>{r&&(setTimeout(()=>{var e;return null==(e=p.current)?void 0:e.focus()},100),s(""),l(0))},[r]);const u=e.useCallback(e=>{if(!e.trim())return;const t=[e,...d.filter(t=>t!==e)].slice(0,5);c(t),localStorage.setItem("optiplan-recent-searches",JSON.stringify(t))},[d]),g=a.trim()?[...Zt,...Qt].filter(e=>{var t;return e.title.toLowerCase().includes(a.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(a.toLowerCase()))}):Zt.slice(0,5);return e.useEffect(()=>{if(!r)return;const e=e=>{if("Escape"===e.key)i();else if("ArrowDown"===e.key)e.preventDefault(),l(e=>Math.min(e+1,g.length-1));else if("ArrowUp"===e.key)e.preventDefault(),l(e=>Math.max(e-1,0));else if("Enter"===e.key&&g[o]){e.preventDefault();const t=g[o];u(t.title);const r=t.id.replace("p-","").replace("a-new-","order-editor");"a-refresh"===t.id?window.location.reload():"a-new-order"===t.id?n("order-editor"):n(r),i()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r,g,o,i,n,u]),r?ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{onClick:i,style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(4px)",zIndex:9998,animation:"fade-in 0.15s ease"}}),ue.jsx("div",{style:{position:"fixed",top:"15%",left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:560,zIndex:9999,animation:"fade-in-down 0.2s ease"},children:ue.jsxs("div",{style:{background:_e.bg.elevated||_e.bg.surface,borderRadius:Pe.xl,border:`1px solid ${_e.border}`,boxShadow:Re.xl,overflow:"hidden"},children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"16px 20px",borderBottom:`1px solid ${_e.border}`},children:[ue.jsx(t,{size:20,style:{color:_e.primary.DEFAULT,flexShrink:0}}),ue.jsx("input",{ref:p,value:a,onChange:e=>{s(e.target.value),l(0)},placeholder:"Sayfa, sipariş veya işlem ara...",style:{flex:1,background:"transparent",border:"none",outline:"none",color:_e.text,fontSize:16,fontFamily:Be.fontFamily.base},autoComplete:"off",spellCheck:!1}),ue.jsx("div",{style:{padding:"4px 8px",borderRadius:6,border:`1px solid ${_e.border}`,fontSize:11,color:_e.muted,fontWeight:600},children:"ESC"})]}),!a.trim()&&d.length>0&&ue.jsxs("div",{style:{padding:"8px 12px"},children:[ue.jsx("div",{style:{fontSize:11,color:_e.muted,fontWeight:600,padding:"4px 8px",letterSpacing:"0.05em",textTransform:"uppercase"},children:"Son Aramalar"}),d.map((e,r)=>ue.jsxs("button",{onClick:()=>s(e),style:{display:"flex",alignItems:"center",gap:8,width:"100%",padding:"8px 12px",background:"transparent",border:"none",color:_e.muted,cursor:"pointer",borderRadius:Pe.md,fontSize:13,textAlign:"left"},onMouseEnter:e=>{e.currentTarget.style.background=`${_e.primary.DEFAULT}15`},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[ue.jsx(t,{size:14,style:{opacity:.5}}),e]},r))]}),ue.jsxs("div",{style:{maxHeight:360,overflowY:"auto",padding:"8px 12px"},children:[!a.trim()&&ue.jsx("div",{style:{fontSize:11,color:_e.muted,fontWeight:600,padding:"4px 8px",letterSpacing:"0.05em",textTransform:"uppercase"},children:"Hızlı Erişim"}),0===g.length&&ue.jsxs("div",{style:{padding:24,textAlign:"center",color:_e.muted,fontSize:14},children:['"',a,'" için sonuç bulunamadı']}),g.map((e,t)=>ue.jsxs("button",{onClick:()=>{u(e.title);const t=e.id.replace("p-","").replace("a-new-","order-editor");"a-refresh"===e.id?window.location.reload():"a-new-order"===e.id?n("order-editor"):n(t),i()},style:{display:"flex",alignItems:"center",gap:12,width:"100%",padding:"10px 12px",background:o===t?`${_e.primary.DEFAULT}15`:"transparent",border:o===t?`1px solid ${_e.primary.DEFAULT}30`:"1px solid transparent",borderRadius:Pe.md,cursor:"pointer",transition:"all 0.15s ease",textAlign:"left",color:_e.text},onMouseEnter:()=>l(t),children:[ue.jsx("div",{style:{width:36,height:36,borderRadius:Pe.md,background:`${_e.primary.DEFAULT}15`,display:"flex",alignItems:"center",justifyContent:"center",color:_e.primary.DEFAULT,flexShrink:0},children:e.icon}),ue.jsxs("div",{style:{flex:1,minWidth:0},children:[ue.jsx("div",{style:{fontSize:14,fontWeight:500},children:e.title}),e.description&&ue.jsx("div",{style:{fontSize:12,color:_e.muted,marginTop:2},children:e.description})]}),e.shortcut&&ue.jsx("div",{style:{padding:"3px 8px",borderRadius:6,border:`1px solid ${_e.border}`,fontSize:11,color:_e.muted,fontWeight:500,flexShrink:0},children:e.shortcut}),o===t&&ue.jsx(R,{size:14,style:{color:_e.primary.DEFAULT,flexShrink:0}})]},e.id))]}),ue.jsxs("div",{style:{padding:"10px 20px",borderTop:`1px solid ${_e.border}`,display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:11,color:_e.muted},children:[ue.jsxs("div",{style:{display:"flex",gap:16},children:[ue.jsx("span",{children:"↑↓ Gezin"}),ue.jsx("span",{children:"↵ Seç"}),ue.jsx("span",{children:"ESC Kapat"})]}),ue.jsx("span",{children:"Optiplan360 Arama"})]})]})})]}):null},tr=["Bugün kaç sipariş var?","Geciken siparişleri göster","İstasyon durumları ne?","Düşük stokları listele","Kapasite durumu nasıl?"],rr={id:"welcome",role:"assistant",content:"Merhaba! 👋 Ben Optiplan360 AI Asistanınız. Size nasıl yardımcı olabilirim?\n\nSipariş durumu, stok bilgisi, üretim kapasitesi ve daha fazlası hakkında sorularınızı sorabilirsiniz.",timestamp:new Date},ir=({onNavigate:t})=>{const[i,n]=e.useState(!1),[a,s]=e.useState(!1),[o,l]=e.useState([rr]),[d,c]=e.useState(""),[p,u]=e.useState(!1),g=e.useRef(null),m=e.useRef(null);e.useEffect(()=>{var e;null==(e=g.current)||e.scrollIntoView({behavior:"smooth"})},[o]);const h=async e=>{const t=e||d.trim();if(!t||p)return;const r={id:`user-${Date.now()}`,role:"user",content:t,timestamp:new Date};l(e=>[...e,r]),c(""),u(!0),await new Promise(e=>setTimeout(e,800+1200*Math.random()));const i=await(async e=>{const t=e.toLowerCase();return t.includes("sipariş")&&(t.includes("bugün")||t.includes("kaç"))?"[Siparis Ozeti] **Bugunku Siparis Ozeti:**\n\n- Yeni gelen: 12 siparis\n- Uretimde: 8 siparis\n- Tamamlanan: 5 siparis\n- Geciken: 2 siparis\n\nToplam siparis degeri: TL45.200":t.includes("gecik")||t.includes("gecikmeli")?"[Uyari] **Geciken Siparisler (2 adet):**\n\n1. **SP-2024-0142** - Yilmaz Mobilya\n   Gecikme: 2 gun | Neden: Malzeme bekleniyor\n\n2. **SP-2024-0148** - Demir Ticaret\n   Gecikme: 1 gun | Neden: Istasyon arizasi\n\n> Oneri: Istasyon 3'u yedek istasyonla degistirmenizi oneriyorum.":t.includes("istasyon")||t.includes("station")?"[Istasyon] **Istasyon Durumlari:**\n\n- IST-01: [Aktif] (45 dk calisiyor)\n- IST-02: [Aktif] (12 dk calisiyor)\n- IST-03: [Arizali] (3 saat once durdu)\n- IST-04: [Bekleme] (Manuel mod)\n\nAktif kapasite: %75":t.includes("stok")||t.includes("düşük")?"[Stok] **Dusuk Stok Uyarilari:**\n\n- MDF 18mm Beyaz: 12 levha kaldi (esik: 20)\n- Mese Kaplama: 8 m2 kaldi (esik: 15)\n- Mentese 35mm: 45 adet kaldi (esik: 100)\n\nTedarikçiye otomatik siparis gondermemi ister misiniz?":t.includes("kapasite")||t.includes("verimlilik")?"[Kapasite] **Kapasite Analizi:**\n\n- Gunluk kapasite: 52 siparis\n- Bugunku yuk: 45 siparis (%87)\n- Tahmini tamamlanma: 18:30\n\nZaman dilimi analizi:\n- 08:00-12:00: %88 (Normal)\n- 12:00-16:00: %107 (Asim!)\n- 16:00-20:00: %72 (Rahat)\n\n> Ogleden sonra 2 ek istasyon acmanizi oneriyorum.":t.includes("rapor")||t.includes("özet")?"[Rapor] **Gunluk Ozet Raporu:**\n\n- Tamamlanan: 18 siparis (TL32.400)\n- Devam eden: 23 siparis\n- Sevkiyat: 12 paket\n- Tahsilat: TL28.750\n\nVerimlilik: %91 (Gecen hafta: %87)\nSLA uyumu: %96":"Sorunuzu anladim. Su an icin bu konuda detayli bilgi saglayamiyorum, ancak ilgili sayfaya yonlendirebilirim.\n\n> Sunlari sorabilirsiniz:\n- Siparis durumu\n- Istasyon bilgileri\n- Stok uyarilari\n- Kapasite analizi\n- Gunluk rapor"})(t),n={id:`ai-${Date.now()}`,role:"assistant",content:i,timestamp:new Date};l(e=>[...e,n]),u(!1)};return i?ue.jsxs("div",{style:{position:"fixed",bottom:24,right:24,width:a?300:400,height:a?56:560,borderRadius:Pe.xl,border:`1px solid ${_e.border}`,background:_e.bg.main,boxShadow:Re.xl,display:"flex",flexDirection:"column",overflow:"hidden",zIndex:1e3,transition:"all 0.3s ease",animation:"scale-in 0.2s ease"},children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 16px",background:`linear-gradient(135deg, ${_e.primary.DEFAULT}, #8b5cf6)`,color:"white",cursor:"pointer"},onClick:()=>a&&s(!1),children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[ue.jsx(W,{size:18}),ue.jsx("span",{style:{fontWeight:600,fontSize:14},children:"AI Asistan"}),ue.jsx("span",{style:{fontSize:10,opacity:.8,background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:10},children:"Beta"})]}),ue.jsx("button",{onClick:e=>{e.stopPropagation(),s(!a)},style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:4},"aria-label":a?"Genişlet":"Küçült",children:a?ue.jsx(M,{size:16}):ue.jsx(G,{size:16})}),ue.jsx("button",{onClick:()=>n(!1),style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:4},"aria-label":"Kapat",children:ue.jsx(r,{size:16})})]}),!a&&ue.jsxs(ue.Fragment,{children:[ue.jsxs("div",{style:{flex:1,overflowY:"auto",padding:16,display:"flex",flexDirection:"column",gap:12},children:[o.map(e=>ue.jsx("div",{style:{display:"flex",justifyContent:"user"===e.role?"flex-end":"flex-start",animation:"fade-in-up 0.2s ease"},children:ue.jsx("div",{style:{maxWidth:"85%",padding:"10px 14px",borderRadius:Pe.lg,background:"user"===e.role?`linear-gradient(135deg, ${_e.primary.DEFAULT}, ${_e.primary[600]})`:_e.bg.surface,color:"user"===e.role?"white":_e.text,fontSize:13,lineHeight:1.6,border:"assistant"===e.role?`1px solid ${_e.border}`:"none",whiteSpace:"pre-wrap"},children:e.content})},e.id)),p&&ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,color:_e.muted,fontSize:13,padding:"8px 0"},children:[ue.jsx(K,{size:16,className:"anim-spin",style:{animation:"spin 1s linear infinite"}}),"Düşünüyor..."]}),ue.jsx("div",{ref:g})]}),o.length<=1&&ue.jsx("div",{style:{padding:"0 16px 8px",display:"flex",flexWrap:"wrap",gap:6},children:tr.map(e=>ue.jsx("button",{onClick:()=>h(e),style:{padding:"6px 12px",borderRadius:20,border:`1px solid ${_e.border}`,background:"transparent",color:_e.primary.DEFAULT,fontSize:11,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:e=>{e.currentTarget.style.background=`${_e.primary.DEFAULT}15`},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:e},e))}),ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"12px 16px",borderTop:`1px solid ${_e.border}`,background:_e.bg.surface},children:[ue.jsx("input",{ref:m,value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"Bir soru sorun...",disabled:p,style:{flex:1,background:_e.bg.main,border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"10px 14px",color:_e.text,fontSize:13,outline:"none",fontFamily:Be.fontFamily.base}}),ue.jsx("button",{onClick:()=>h(),disabled:!d.trim()||p,style:{width:40,height:40,borderRadius:Pe.md,background:d.trim()?_e.primary.DEFAULT:_e.bg.main,border:"none",color:"white",cursor:d.trim()?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",opacity:d.trim()?1:.5},"aria-label":"Gönder",children:ue.jsx(H,{size:16})})]})]})]}):ue.jsx("button",{onClick:()=>n(!0),style:{position:"fixed",bottom:24,right:24,width:56,height:56,borderRadius:"50%",background:`linear-gradient(135deg, ${_e.primary.DEFAULT}, #8b5cf6)`,border:"none",color:"white",cursor:"pointer",boxShadow:`0 8px 32px ${_e.primary.DEFAULT}50`,display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,transition:"all 0.3s ease",animation:"pop-in 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},"aria-label":"AI Asistan",title:"AI Asistan",children:ue.jsx(z,{size:24})})},nr={getStats:()=>_t("/admin/stats",{method:"GET"}),getInsights:()=>_t("/admin/insights",{method:"GET"}),getKpiTrends:()=>_t("/admin/kpi-trends",{method:"GET"}),getUsers(){return this.listUsers()},listUsers:()=>_t("/admin/users",{method:"GET"}),createUser:e=>_t("/admin/users",{method:"POST",body:JSON.stringify(e)}),updateUser:(e,t)=>_t(`/admin/users/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteUser:e=>_t(`/admin/users/${e}`,{method:"DELETE"}),resetUserPassword:(e,t)=>_t(`/admin/users/${e}/reset-password`,{method:"POST",body:JSON.stringify({password:t})}),listLogs:(e=1,t=200)=>_t(`/admin/logs?page=${e}&per_page=${t}`,{method:"GET"}),getAuditLogs(){return this.listLogs()},toggleUser(e){return this.updateUser(e,{is_active:!1})},getStations(){return this.listStations()},listStations:()=>_t("/stations/",{method:"GET"}),toggleStation:async e=>_t(`/stations/${e}/toggle`,{method:"PATCH"}),createStation:e=>_t("/stations/",{method:"POST",body:JSON.stringify(e)}),updateStation:(e,t)=>_t(`/stations/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteStation:e=>_t(`/stations/${e}`,{method:"DELETE"}),scanStation:e=>_t("/stations/scan",{method:"POST",body:JSON.stringify(e)}),getMikroConfig:()=>_t("/admin/mikro/config",{method:"GET"}),saveMikroConfig:e=>_t("/admin/mikro/config",{method:"PUT",body:JSON.stringify(e)}),testMikroConfig:e=>_t("/admin/mikro/test",{method:"POST",body:JSON.stringify(e)}),listSqlTables:()=>_t("/sql/tables",{method:"GET"}),runSqlQuery:e=>_t("/sql/query",{method:"POST",body:JSON.stringify(e)}),getDeviceConfig:()=>_t("/ocr/device/config",{method:"GET"}),updateDeviceConfig:e=>_t("/ocr/device/config",{method:"PUT",body:JSON.stringify(e)}),ingestFromDevice(e,t){const r=new FormData;return r.append("file",e),_t("/ocr/device/ingest",{method:"POST",skipAuth:!0,headers:{"X-Device-Api-Key":t},body:r})},getTelegramConfig:()=>_t("/ocr/telegram/config",{method:"GET"}),updateTelegramConfig:e=>_t("/ocr/telegram/config",{method:"PUT",body:JSON.stringify(e)}),testTelegram:()=>_t("/ocr/telegram/test",{method:"POST"}),getEmailConfig:()=>_t("/ocr/email/config",{method:"GET"}),updateEmailConfig:e=>_t("/ocr/email/config",{method:"PUT",body:JSON.stringify(e)}),testEmail:()=>_t("/ocr/email/test",{method:"POST"}),fetchEmailNow:(e=5)=>_t(`/ocr/email/fetch-now?limit=${e}`,{method:"POST"}),getWhatsAppConfig:()=>_t("/whatsapp/config",{method:"GET"}),updateWhatsAppConfig:e=>_t("/whatsapp/config",{method:"PUT",body:JSON.stringify(e)}),listWhatsAppTemplates:()=>_t("/whatsapp/templates",{method:"GET"}),sendWhatsAppMessage:e=>_t("/whatsapp/send",{method:"POST",body:JSON.stringify(e)}),getWhatsAppSummary:()=>_t("/whatsapp/summary",{method:"GET"}),listWhatsAppMessages:e=>_t(`/whatsapp/messages${e?`?order_id=${e}`:""}`,{method:"GET"}),getOCRConfig:()=>_t("/ocr/config",{method:"GET"}),updateOCRConfig:e=>_t("/ocr/config",{method:"PUT",body:JSON.stringify(e)}),getAzureConfig:()=>_t("/azure/config",{method:"GET"}),updateAzureConfig:e=>_t("/azure/config",{method:"PUT",body:JSON.stringify(e)}),testAzureOCR:()=>_t("/azure/test-ocr",{method:"POST"}),getAzureStats:()=>_t("/azure/stats",{method:"GET"}),getGoogleConfig:()=>_t("/ocr/google/config",{method:"GET"}),updateGoogleConfig:e=>_t("/ocr/google/config",{method:"PUT",body:JSON.stringify(e)}),testGoogle:()=>_t("/ocr/google/test",{method:"POST"}),getGoogleStats:()=>_t("/ocr/google/stats",{method:"GET"}),getAwsConfig:()=>_t("/ocr/aws/config",{method:"GET"}),updateAwsConfig:e=>_t("/ocr/aws/config",{method:"PUT",body:JSON.stringify(e)}),testAws:()=>_t("/ocr/aws/test",{method:"POST"}),getAwsStats:()=>_t("/ocr/aws/stats",{method:"GET"}),getOcrSummary:()=>_t("/ocr/summary",{method:"GET"}),getSystemConfig:()=>_t("/admin/config",{method:"GET"}),updateSystemConfig:e=>_t("/admin/config",{method:"PUT",body:JSON.stringify(e)}),runSystemControlCheck:()=>_t("/admin/config/system-check",{method:"POST"}),getOrganizationConfig:()=>_t("/admin/organization",{method:"GET"}),updateOrganizationConfig:e=>_t("/admin/organization",{method:"PUT",body:JSON.stringify(e)}),getUserActivities(e){const t=e?new URLSearchParams(Object.entries(e).filter(([,e])=>void 0!==e).map(([e,t])=>[e,String(t)])).toString():"";return _t("/admin/activity/logs"+(t?"?"+t:""),{method:"GET"})},getUserSessions(e){const t=e?new URLSearchParams(Object.entries(e).filter(([,e])=>void 0!==e).map(([e,t])=>[e,String(t)])).toString():"";return _t("/admin/activity/sessions"+(t?"?"+t:""),{method:"GET"})},terminateSession:e=>_t(`/admin/activity/sessions/${e}/terminate`,{method:"POST"}),getAuditRecords(e){const t=e?new URLSearchParams(Object.entries(e).filter(([,e])=>void 0!==e).map(([e,t])=>[e,String(t)])).toString():"";return _t("/admin/audit/records"+(t?"?"+t:""),{method:"GET"})},getEntityAuditTrail:(e,t)=>_t(`/admin/audit/entity/${e}/${t}`,{method:"GET"}),getActivityStats(e){const t=e?new URLSearchParams(Object.entries(e).filter(([,e])=>void 0!==e)).toString():"";return _t("/admin/activity/stats"+(t?"?"+t:""),{method:"GET"})},testStationConnection:e=>_t(`/admin/stations/${e}/test`,{method:"POST"}),getStationDetail:e=>_t(`/admin/stations/${e}/detail`,{method:"GET"}),getFeatureFlags:()=>_t("/config/features",{method:"GET"}),updateFeatureFlag:(e,t)=>_t(`/config/features/${e}?enabled=${t}`,{method:"PUT"}),getSystemStatus:()=>_t("/config/status",{method:"GET"}),getAIConfig:()=>_t("/config/ai",{method:"GET"}),updateAIConfig:e=>_t("/config/ai",{method:"PUT",body:JSON.stringify(e)}),testAIConnection:()=>_t("/config/ai/test",{method:"POST"})},ar=["partsCount","partCount","parts_count","part_count"];function sr(e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){const t=Number(e.trim());if(Number.isFinite(t))return t}return null}function or(e){if(Array.isArray(e.parts))return e.parts.length;const t=sr(e.parts);if(null!==t)return Math.max(0,Math.trunc(t));for(const r of ar){const t=sr(e[r]);if(null!==t)return Math.max(0,Math.trunc(t))}return 0}function lr(e){if(!e)return"";const t=String(e);try{const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return t}}function dr(e){const t=e,r=String(t.id??""),i=t.orderNo??t.order_no,n=i?`SIP-${String(i).padStart(4,"0")}`:void 0,a=String(t.cust||t.crmNameSnapshot||t.customerName||""),s=String(t.phone||t.phoneNorm||""),o=String(t.mat||t.materialName||""),l=Number(t.thick??t.thicknessMm??0);let d=String(t.plate||"");if(!d&&(t.plateWMm||t.plateHMm)){const e=Number(t.plateWMm||0),r=Number(t.plateHMm||0);e>0&&r>0&&(d=`${e}×${r}`)}const c=String(t.status||"DRAFT"),p=String(t.date||"")||lr(t.createdAt),u=String(t.upd||"")||lr(t.updatedAt)||"—",g=t.grp||void 0,m=t.priority||"normal";return{id:r,orderNo:n,cust:a,phone:s,mat:o,plate:d||void 0,thick:l,parts:or(t),status:c,date:p,upd:u,grp:g,priority:m}}function cr(e){if(e&&"object"==typeof e&&!Array.isArray(e)){const r=e.data;if(t=r,Boolean(t)&&"object"==typeof t&&!Array.isArray(t))return dr(r)}var t;return dr(e)}function pr(e){const t=e,r={};if(void 0!==t.cust&&(r.crm_name_snapshot=t.cust),void 0!==t.phone&&(r.phone_norm=t.phone),void 0!==t.mat&&(r.material_name=t.mat),void 0!==t.thick&&(r.thickness_mm=t.thick),void 0!==t.status&&(r.status=t.status),t.plate&&"string"==typeof t.plate){const e=String(t.plate).match(/(\d+)\s*[×xX*]\s*(\d+)/);e&&(r.plate_w_mm=Number(e[1]),r.plate_h_mm=Number(e[2]))}return void 0!==t.color&&(r.color=t.color),void 0!==t.grain_default&&(r.grain_default=t.grain_default),void 0!==t.band_mm&&(r.band_mm=t.band_mm),void 0!==t.customer_id&&(r.customer_id=t.customer_id),void 0!==t.parts&&(r.parts=t.parts),r}const ur={async list(){const e=await _t("/orders",{method:"GET"});return t=e,Array.isArray(t)?t.map(dr):Array.isArray(null==t?void 0:t.data)?t.data.map(dr):Array.isArray(null==t?void 0:t.items)?t.items.map(dr):[];var t},create:async e=>cr(await _t("/orders",{method:"POST",body:JSON.stringify(pr(e))})),update:async(e,t)=>cr(await _t(`/orders/${e}`,{method:"PUT",body:JSON.stringify(pr(t))})),remove:async e=>_t(`/orders/${e}`,{method:"DELETE"}),async exportOpti(e){const t=await _t(`/orders/${e}/export/opti`,{method:"POST"});return{files:Array.isArray(t.files)?t.files.map(e=>({filename:String(e.filename??""),partGroup:String(e.part_group??e.partGroup??""),downloadUrl:String(e.download_url??e.downloadUrl??"")})):[]}},getExportDownloadUrl:e=>`${Ct()}/orders/export/download/${encodeURIComponent(e)}`};function gr(t){const r=e.useRef(null);e.useEffect(()=>{const e=Ct().replace(/^http/,"ws").replace(/\/api\/v1\/?$/,"/ws"),i=new WebSocket(e);return r.current=i,i.onopen=()=>{},i.onmessage=e=>{try{const r=JSON.parse(e.data);r&&r.type&&t(r)}catch(r){}},i.onclose=()=>{},()=>{i.close()}},[t])}function mr(e,t=0){if(Array.isArray(e))return e.length;const r=function(e){if("number"==typeof e&&Number.isFinite(e))return e;if("string"==typeof e){const t=Number(e.trim());if(Number.isFinite(t))return t}return null}(e);return null!==r?Math.max(0,Math.trunc(r)):t}const hr=e.lazy(()=>Q(()=>import("./AIOpsDashboard-BtLX-MwR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(e=>({default:e.AIOpsDashboard}))),xr=e.lazy(()=>Q(()=>import("./AIOrchestratorDashboard-SxM4eqjk.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11])).then(e=>({default:e.AIOrchestratorDashboard}))),yr=[{id:"overview",label:"Genel Bakış"},{id:"ops",label:"Orkestrasyon Paneli"},{id:"orchestrator",label:"AI Komuta Merkezi"}],br=()=>ue.jsxs("div",{className:"dashboard-tab-loading",children:[ue.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),"Yükleniyor..."]});function fr(){const e=(new Date).getHours();return e<12?"Günaydın":e<18?"İyi günler":"İyi akşamlar"}function vr({currentUser:t={name:"Kullanıcı"},onNewOrder:r}){const[i,n]=e.useState("overview"),[a,s]=e.useState(null),[o,l]=e.useState(null),[d,c]=e.useState(null),[p,g]=e.useState([]),[m,h]=e.useState([]),[x,y]=e.useState(!0),[b,f]=e.useState(!1),v=e.useRef(45e3),j=e.useRef(null),k=e.useRef(!0),S=e.useCallback(async()=>{try{y(!0);const[e,t,r,i,n]=await Promise.all([nr.getStats().catch(()=>null),nr.getInsights().catch(()=>null),nr.getKpiTrends().catch(()=>null),ur.list().catch(()=>[]),nr.getStations().catch(()=>[])]);s(e),l(t),c((null==r?void 0:r.trends)??null),g(i.slice(0,8)),h(n.map((e,t)=>({id:Number(e.id)||t+1,name:String(e.name||"İstasyon"),active:!1!==e.isActive,lastScan:e.lastScanAt?new Date(String(e.lastScanAt)).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}):"—",istasyonDurumu:String(e.stationType||e.name||"Hazır"),todayScans:Number(e.scanCountToday??0)})));const a=null===e;f(a),v.current=a?Math.min(2*v.current,12e4):45e3}finally{y(!1),k.current&&(j.current=setTimeout(()=>{S()},v.current))}},[]);e.useEffect(()=>(k.current=!0,S(),()=>{k.current=!1,j.current&&clearTimeout(j.current)}),[S]),gr(e=>{"STATION_SCAN"!==e.type&&"ORDER_UPDATED"!==e.type||S()});const E=m.reduce((e,t)=>e+(t.todayScans??0),0),A=m.filter(e=>e.active).length,w=Math.max(0,m.length-A),F=[0,0,0,0,0,0,0],D=(null==d?void 0:d.map(e=>e.ordersNew))??F,T=(null==d?void 0:d.map(e=>e.ordersProduction))??F,z=(null==d?void 0:d.map(e=>e.ordersReady))??F,C=(null==d?void 0:d.map(e=>e.ordersDelivered))??F,N=[{icon:"OR",label:"Bugün Gelen",value:(null==a?void 0:a.ordersNew)??0,color:_e.info.DEFAULT,sparkData:[...D,(null==a?void 0:a.ordersNew)??0]},{icon:"UR",label:"Üretimde",value:(null==a?void 0:a.ordersProduction)??0,color:_e.accent[400],sparkData:[...T,(null==a?void 0:a.ordersProduction)??0]},{icon:"HZ",label:"Hazır",value:(null==a?void 0:a.ordersReady)??0,color:_e.success.DEFAULT,sparkData:[...z,(null==a?void 0:a.ordersReady)??0]},{icon:"TM",label:"Tamamlanan",value:(null==a?void 0:a.ordersDelivered)??0,color:_e.primary[500],sparkData:[...C,(null==a?void 0:a.ordersDelivered)??0]}],L=(null==o?void 0:o.probabilityInsights)||[{label:"Gün içi kapasite aşımı olasılığı",probability:"28%",impact:"Yüksek",action:"Vardiya sonuna 2 ek slot aç"},{label:"Kritik istasyon arızası olasılığı",probability:w>0?"36%":"14%",impact:"Kritik",action:"Yedek istasyonu hazır tut"},{label:"SLA gecikmesi olasılığı",probability:((null==a?void 0:a.ordersProduction)??0)>((null==a?void 0:a.ordersReady)??0)?"33%":"18%",impact:"Orta",action:"Öncelik kuralını yeniden dağıt"},{label:"İade/tekrar iş olasılığı",probability:"11%",impact:"Orta",action:"OCR confidence altına ikinci kontrol ekle"}],O=(null==o?void 0:o.capacityPlan)||[{slot:"08:00-12:00",demand:46,capacity:52,utilization:"88%",risk:"Düşük"},{slot:"12:00-16:00",demand:58,capacity:54,utilization:"107%",risk:"Yüksek"},{slot:"16:00-20:00",demand:41,capacity:48,utilization:"85%",risk:"Düşük"},{slot:"20:00-24:00",demand:34,capacity:30,utilization:"113%",risk:"Kritik"}],$=(null==o?void 0:o.overviewFacts)||[{label:"Toplam İstasyon Tarama",value:String(E)},{label:"Aktif İstasyon",value:`${A}/${m.length}`},{label:"Pasif İstasyon",value:String(w)},{label:"Acil Sipariş Oranı",value:"%12"},{label:"Ortalama İşlem Süresi",value:"6.8 dk"},{label:"Tahmini Gün Sonu Çıkış",value:String((null==a?void 0:a.ordersDelivered)?a.ordersDelivered+24:24)}];return ue.jsxs("div",{className:"electric-page",children:[ue.jsx(kt,{title:`${fr()}, ${t.name.split(" ")[0]}`,subtitle:"AI Orkestrasyon & Üretim Genel Durumu",breadcrumbs:["Orkestrasyon","Gösterge Paneli"],children:"overview"===i&&ue.jsxs(ue.Fragment,{children:[ue.jsx(He,{variant:"secondary",size:"sm",onClick:S,disabled:x,children:x?"Yenileniyor...":"Yenile"}),ue.jsx(He,{variant:"primary",size:"sm",icon:"+",onClick:r,children:"Yeni Sipariş"})]})}),ue.jsx("div",{className:"app-page-container",style:{paddingTop:12,paddingBottom:0},children:ue.jsx("div",{style:{display:"flex",gap:"2px",marginBottom:"24px",borderBottom:`1px solid ${_e.border}`,flexWrap:"wrap"},children:yr.map(e=>ue.jsx("button",{type:"button",onClick:()=>n(e.id),style:{display:"flex",alignItems:"center",gap:"6px",padding:"12px 24px",fontSize:14,fontWeight:i===e.id?700:400,color:i===e.id?_e.primary.DEFAULT:_e.muted,background:i===e.id?`${_e.primary.DEFAULT}08`:"transparent",border:"none",borderBottom:i===e.id?`3px solid ${_e.primary.DEFAULT}`:"3px solid transparent",cursor:"pointer",fontFamily:Be.fontFamily.base,marginBottom:"-1px",transition:"all 0.2s",whiteSpace:"nowrap"},children:e.label},e.id))})}),"ops"===i&&ue.jsx(e.Suspense,{fallback:ue.jsx(br,{}),children:ue.jsx(hr,{})}),"orchestrator"===i&&ue.jsx(e.Suspense,{fallback:ue.jsx(br,{}),children:ue.jsx(xr,{})}),"overview"===i&&ue.jsxs("div",{className:"app-page-container",style:{display:"grid",gap:20},children:[b&&ue.jsxs("div",{role:"status",style:{display:"flex",alignItems:"center",gap:6,padding:"8px 12px",background:"rgba(234,179,8,0.06)",border:"1px solid rgba(234,179,8,0.25)",borderRadius:Pe.md,fontSize:12,color:_e.warning.DEFAULT},children:[ue.jsx(u,{size:13,"aria-hidden":!0}),ue.jsx("span",{children:"Sunucu bağlantısı kurulamadı — son bilinen veriler gösteriliyor"})]}),ue.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:16},children:N.map(e=>ue.jsx(Ve,{icon:e.icon,label:e.label,value:x?"...":e.value,change:0,color:e.color,sparkData:e.sparkData},e.icon))}),ue.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(320px,1fr))",gap:16},children:[ue.jsx(Je,{title:"İstasyon Durumları",subtitle:"Canlı üretim izleme",children:ue.jsx("div",{style:{display:"grid",gap:10},children:m.map(e=>ue.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:10,border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"10px 12px",background:"rgba(255,255,255,.02)"},children:[ue.jsxs("div",{children:[ue.jsx("div",{style:{fontSize:13,fontWeight:Be.fontWeight.semibold},children:e.name}),ue.jsxs("div",{style:{fontSize:11,color:_e.muted},children:["Durum: ",e.istasyonDurumu]}),ue.jsxs("div",{style:{fontSize:11,color:_e.gray[400]},children:["Son okutma: ",e.lastScan]})]}),ue.jsxs("div",{style:{textAlign:"right"},children:[ue.jsx("div",{style:{fontSize:11,color:e.active?_e.success.DEFAULT:_e.error.DEFAULT,marginBottom:4},children:e.active?"Aktif":"Pasif"}),ue.jsx("div",{style:{fontSize:12,fontWeight:Be.fontWeight.bold},children:e.todayScans})]})]},e.id))})}),ue.jsx(Je,{title:"Gün Özeti",subtitle:"Anlık toplamlar",children:ue.jsxs("div",{style:{display:"grid",gap:10},children:[ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${_e.border}`,paddingBottom:8},children:[ue.jsx("span",{style:{fontSize:13,color:_e.muted},children:"Toplam Siparişler"}),ue.jsx("strong",{style:{color:_e.primary[500]},children:(null==a?void 0:a.totalOrders)??0})]}),ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${_e.border}`,paddingBottom:8},children:[ue.jsx("span",{style:{fontSize:13,color:_e.muted},children:"Aktif İstasyon"}),ue.jsxs("strong",{style:{color:_e.success.DEFAULT},children:[A," / ",m.length]})]}),ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${_e.border}`,paddingBottom:8},children:[ue.jsx("span",{style:{fontSize:13,color:_e.muted},children:"Müşteri Sayısı"}),ue.jsx("strong",{children:(null==a?void 0:a.totalCustomers)??0})]}),ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[ue.jsx("span",{style:{fontSize:13,color:_e.muted},children:"Kayıtlı Kullanıcılar"}),ue.jsx("strong",{children:(null==a?void 0:a.totalUsers)??0})]})]})})]}),ue.jsxs(Je,{title:"Genel Bakış Detayları",subtitle:"Olasılıklar, kapasite ve operasyonel senaryolar",children:[ue.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:10,marginBottom:14},children:$.map(e=>ue.jsxs("div",{style:{border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"10px 12px",background:"rgba(255,255,255,.02)"},children:[ue.jsx("div",{style:{fontSize:11,color:_e.muted},children:e.label}),ue.jsx("div",{style:{fontSize:17,color:_e.text,fontWeight:Be.fontWeight.bold},children:e.value})]},e.label))}),ue.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(320px,1fr))",gap:12},children:[ue.jsxs("div",{style:{border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"10px 12px",background:"rgba(255,255,255,.015)"},children:[ue.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:_e.primary[500]},children:"Risk ve Olasılık Matrisi"}),ue.jsx("div",{style:{display:"grid",gap:8},children:L.map(e=>ue.jsxs("div",{style:{borderBottom:`1px dashed ${_e.border}`,paddingBottom:6},children:[ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[ue.jsx("span",{style:{fontSize:12},children:e.label}),ue.jsx("span",{style:{fontSize:11,color:_e.warning.DEFAULT},children:e.probability})]}),ue.jsxs("div",{style:{fontSize:11,color:_e.muted},children:["Etki: ",e.impact," | Aksiyon: ",e.action]})]},e.label))})]}),ue.jsxs("div",{style:{border:`1px solid ${_e.border}`,borderRadius:Pe.md,padding:"10px 12px",background:"rgba(255,255,255,.015)"},children:[ue.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:_e.primary[500]},children:"Kapasite ve Talep Planı"}),ue.jsx("div",{style:{overflowX:"auto"},children:ue.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:500},children:[ue.jsx("thead",{children:ue.jsx("tr",{style:{borderBottom:`1px solid ${_e.border}`},children:["Zaman","Talep","Kapasite","Kullanım","Risk"].map(e=>ue.jsx("th",{style:{textAlign:"left",fontSize:11,color:_e.muted,padding:"8px 6px"},children:e},e))})}),ue.jsx("tbody",{children:O.map(e=>ue.jsxs("tr",{style:{borderBottom:`1px solid ${_e.border}`},children:[ue.jsx("td",{style:{fontSize:12,padding:"8px 6px"},children:e.slot}),ue.jsx("td",{style:{fontSize:12,padding:"8px 6px"},children:e.demand}),ue.jsx("td",{style:{fontSize:12,padding:"8px 6px"},children:e.capacity}),ue.jsx("td",{style:{fontSize:12,padding:"8px 6px"},children:e.utilization}),ue.jsx("td",{style:{fontSize:12,padding:"8px 6px",color:"Kritik"===e.risk?_e.error.DEFAULT:"Yüksek"===e.risk?_e.warning.DEFAULT:_e.success.DEFAULT},children:e.risk})]},e.slot))})]})})]})]})]}),ue.jsx(Je,{title:"Son Siparişler",subtitle:"Son 24 saat güncellemesi",children:ue.jsx("div",{style:{overflowX:"auto"},children:ue.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[ue.jsx("thead",{children:ue.jsx("tr",{style:{borderBottom:`1px solid ${_e.border2}`},children:["Sipariş No","Müşteri","Malzeme","Parça","Öncelik","Durum","Tarih"].map(e=>ue.jsx("th",{style:{padding:"11px 12px",fontSize:11,color:_e.gray[400],textTransform:"uppercase",letterSpacing:".05em",textAlign:"left"},children:e},e))})}),ue.jsx("tbody",{children:p.length>0?p.map(e=>{var t;return ue.jsxs("tr",{style:{borderBottom:`1px solid ${_e.border}`},children:[ue.jsxs("td",{style:{padding:"11px 12px",color:_e.primary[500],fontFamily:Be.fontFamily.mono,fontSize:12},children:[null==(t=e.id)?void 0:t.substring(0,8),"..."]}),ue.jsxs("td",{style:{padding:"11px 12px"},children:[ue.jsx("div",{style:{fontSize:13},children:e.cust||"—"}),ue.jsx("div",{style:{fontSize:11,color:_e.gray[400]},children:e.phone||"—"})]}),ue.jsx("td",{style:{padding:"11px 12px",fontSize:13,color:_e.muted},children:e.mat||"—"}),ue.jsx("td",{style:{padding:"11px 12px",fontSize:13,color:_e.accent[400],fontWeight:Be.fontWeight.bold},children:mr(e.parts,1)}),ue.jsx("td",{style:{padding:"11px 12px"},children:ue.jsx(Ze,{priority:e.priority||"normal"})}),ue.jsx("td",{style:{padding:"11px 12px"},children:ue.jsx(Qe,{status:e.status||"NEW"})}),ue.jsx("td",{style:{padding:"11px 12px",fontSize:12,color:_e.gray[400]},children:e.date?new Date(e.date).toLocaleDateString("tr-TR"):"—"})]},e.id)}):ue.jsx("tr",{children:ue.jsx("td",{colSpan:7,style:{padding:"11px 12px",textAlign:"center",color:_e.muted},children:"Sipariş bulunamadı"})})})]})})})]})]})}const jr=({columns:e,rows:t})=>ue.jsx(ue.Fragment,{children:Array.from({length:t}).map((t,r)=>ue.jsx("tr",{style:{borderBottom:`1px solid ${_e.border}`},children:Array.from({length:e}).map((e,t)=>ue.jsx("td",{style:{padding:"12px",height:40},children:ue.jsx("div",{style:{height:"100%",background:`linear-gradient(90deg, ${_e.border} 25%, rgba(255,255,255,.08) 50%, ${_e.border} 75%)`,backgroundSize:"200% 100%",animation:"loading 1.5s infinite",borderRadius:Pe.md}})},t))},r))}),kr=({icon:e,title:t="Veri Bulunamadı",message:r="Seçili filtrelere uygun veri yok",action:i})=>ue.jsx("tr",{children:ue.jsx("td",{colSpan:99,style:{padding:"60px 20px",textAlign:"center"},children:ue.jsxs("div",{style:{color:_e.muted,display:"flex",flexDirection:"column",alignItems:"center",gap:12},children:[ue.jsx(N,{size:48,strokeWidth:1.5}),e?ue.jsx("div",{style:{fontSize:18},children:e}):null,ue.jsxs("div",{children:[ue.jsx("h3",{style:{margin:0,color:_e.text,fontSize:16},children:t}),ue.jsx("p",{style:{margin:"6px 0 0",fontSize:13},children:r})]}),i&&ue.jsx("div",{style:{marginTop:12},children:i})]})})}),Sr=h.forwardRef(({columns:i,data:n,loading:a=!1,onRowClick:s,actions:o=[],sortKey:l,sortDir:d="asc",onSort:c,paginated:p=!0,pageSize:u=20,searchable:g=!1,searchKeys:m=[],filterable:h=!0,emptyMessage:x="Veri bulunamadı",emptyIcon:y,rowClass:b,striped:f=!0,compact:j=!1,hoverable:k=!0,selectable:S=!1,selectedRows:E=new Set,onSelectRows:A},w)=>{const[F,D]=e.useState(1),[T,z]=e.useState(""),C=e.useMemo(()=>{let e=[...n];if(T&&m.length>0){const t=T.toLowerCase();e=e.filter(e=>m.some(r=>String(e[r]).toLowerCase().includes(t)))}return l&&c&&e.sort((e,t)=>{const r=e[l],i=t[l];return r<i?"asc"===d?-1:1:r>i?"asc"===d?1:-1:0}),e},[n,T,m,l,d,c]),N=e.useMemo(()=>{if(!p)return C;const e=(F-1)*u;return C.slice(e,e+u)},[C,F,u,p]),L=Math.ceil(C.length/u),O=i.filter(e=>!e.hidden),$=o.length>0?1:0;return ue.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[g&&m.length>0&&ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 12px",border:"1px solid rgba(var(--primary-rgb), 0.28)",borderRadius:Pe.md,background:"linear-gradient(140deg, rgba(var(--primary-rgb),0.12), rgba(124,58,237,0.1))",boxShadow:"0 8px 18px rgba(0,0,0,0.25)",backdropFilter:"blur(8px)"},children:[ue.jsx(t,{size:16,color:_e.muted}),ue.jsx("input",{type:"text",value:T,onChange:e=>{z(e.target.value),D(1)},placeholder:"Arama yapın...","aria-label":"Tablo ara",style:{flex:1,border:"none",background:"transparent",color:_e.text,outline:"none",fontSize:13}}),T&&ue.jsx("button",{onClick:()=>{z(""),D(1)},style:{background:"none",border:"none",color:_e.muted,cursor:"pointer",display:"flex",alignItems:"center"},"aria-label":"Aramayı temizle",children:ue.jsx(r,{size:16})})]}),ue.jsx("div",{style:{overflowX:"auto"},children:ue.jsxs("table",{ref:w,style:{width:"100%",borderCollapse:"collapse",fontSize:j?12:14},role:"table","aria-label":"Veri tablosu",children:[ue.jsx("thead",{children:ue.jsxs("tr",{style:{borderBottom:`2px solid ${_e.border}`,position:"sticky",top:0,background:_e.panel,zIndex:10},children:[S&&ue.jsx("th",{style:{padding:"12px",width:40,textAlign:"center"},children:ue.jsx("input",{type:"checkbox",checked:E.size===N.length&&N.length>0,onChange:()=>{if(E.size===N.length)null==A||A(new Set);else{const e=new Set(N.map(e=>e.id));null==A||A(e)}},"aria-label":"Tümünü seç",style:{cursor:"pointer"}})}),O.map(e=>ue.jsx("th",{onClick:()=>e.sortable&&(null==c?void 0:c(e.key)),style:{padding:j?"8px 10px":"12px",textAlign:e.align||"left",width:e.width,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],fontSize:11,textTransform:"uppercase",letterSpacing:"0.05em",cursor:e.sortable?"pointer":"default",userSelect:"none",transition:`background ${We.fast}`},onMouseEnter:t=>{e.sortable&&(t.currentTarget.style.background="rgba(var(--primary-rgb), 0.12)")},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},role:"columnheader","aria-sort":e.sortable&&l===e.key?"asc"===d?"ascending":"descending":void 0,children:ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.label,e.sortable&&l===e.key&&("asc"===d?ue.jsx(J,{size:14}):ue.jsx(v,{size:14}))]})},String(e.key))),$>0&&ue.jsx("th",{style:{padding:j?"8px 10px":"12px",textAlign:"center",width:100,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],fontSize:11,textTransform:"uppercase",letterSpacing:"0.05em"},children:"İşlemler"})]})}),ue.jsx("tbody",{children:a?ue.jsx(jr,{columns:O.length+$+(S?1:0),rows:u}):0===N.length?ue.jsx(kr,{icon:y,message:x,action:T&&ue.jsx(He,{variant:"secondary",size:"sm",onClick:()=>{z(""),D(1)},children:"Aramayı Temizle"})}):N.map((e,t)=>ue.jsxs("tr",{onClick:()=>null==s?void 0:s(e),style:{borderBottom:`1px solid ${_e.border}`,background:f&&t%2==0?"rgba(var(--primary-rgb), 0.045)":"transparent",cursor:s?"pointer":"default",transition:"background 0.2s"},onMouseEnter:e=>{k&&(e.currentTarget.style.background="rgba(var(--primary-rgb), 0.16)")},onMouseLeave:e=>{e.currentTarget.style.background=f&&t%2==0?"rgba(var(--primary-rgb), 0.045)":"transparent"},role:"row",className:null==b?void 0:b(e,t),children:[S&&ue.jsx("td",{style:{padding:"12px",textAlign:"center"},children:ue.jsx("input",{type:"checkbox",checked:E.has(e.id),onChange:()=>{const t=new Set(E);t.has(e.id)?t.delete(e.id):t.add(e.id),null==A||A(t)},onClick:e=>e.stopPropagation(),style:{cursor:"pointer"}})}),O.map(r=>ue.jsx("td",{style:{padding:j?"8px 10px":"12px",textAlign:r.align||"left",color:_e.text,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},role:"cell",children:r.render?r.render(e[r.key],e,t):(()=>{const t=e[r.key];return null==t?"—":"object"==typeof t?Array.isArray(t)?String(t.length):JSON.stringify(t):String(t)})()},String(r.key))),$>0&&ue.jsx("td",{style:{padding:"12px",textAlign:"center"},children:ue.jsx("div",{style:{display:"flex",gap:4,justifyContent:"center"},children:o.filter(t=>!t.condition||t.condition(e)).map(t=>ue.jsx(He,{variant:t.variant,size:"sm",onClick:r=>{r.stopPropagation(),t.onClick(e)},icon:t.icon,children:t.label},t.label))})})]},e.id))})]})}),p&&C.length>u&&ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",borderTop:`1px solid ${_e.border}`,fontSize:12,color:_e.muted},children:[ue.jsxs("span",{children:[n.length," sonuç • Sayfa ",F,"/",L]}),ue.jsxs("div",{style:{display:"flex",gap:8},children:[ue.jsx(He,{variant:"ghost",size:"sm",disabled:1===F,onClick:()=>D(e=>Math.max(1,e-1)),children:"← Önceki"}),ue.jsx("span",{style:{padding:"0 8px",display:"flex",alignItems:"center"},children:F}),ue.jsx(He,{variant:"ghost",size:"sm",disabled:F===L,onClick:()=>D(e=>Math.min(L,e+1)),children:"Sonraki →"})]})]}),ue.jsx("style",{children:"\n          @keyframes loading {\n            0% { background-position: 200% 0; }\n            100% { background-position: -200% 0; }\n          }\n        "})]})}),Er=e.createContext({addToast:(e,t)=>{}});function Ar({children:t}){const[r,i]=e.useState([]),n=e.useRef(0),s=e.useCallback((e,t="info")=>{const r=++n.current;i(i=>[...i,{id:r,msg:e,type:t}]),setTimeout(()=>i(e=>e.filter(e=>e.id!==r)),4e3)},[]),o={success:{bg:"rgba(43,212,167,.14)",border:_e.success.DEFAULT,text:_e.success.dark,icon:ue.jsx(a,{size:18})},error:{bg:"rgba(255,90,106,.14)",border:_e.error.DEFAULT,text:_e.error.dark,icon:ue.jsx(Y,{size:18})},warning:{bg:"rgba(247,201,72,.14)",border:_e.warning.DEFAULT,text:_e.warning.dark,icon:ue.jsx(u,{size:18})},info:{bg:"rgba(99,179,255,.14)",border:_e.info.DEFAULT,text:_e.info.dark,icon:ue.jsx(p,{size:18})}};return ue.jsxs(Er.Provider,{value:{addToast:s},children:[t,ue.jsx("div",{style:{position:"fixed",top:20,right:20,zIndex:Ke,display:"flex",flexDirection:"column",gap:10,pointerEvents:"none"},children:r.map(e=>{const t=o[e.type]||o.info;return ue.jsxs("div",{style:{pointerEvents:"auto",borderRadius:Pe.lg,background:t.bg,backdropFilter:"blur(16px)",border:`1px solid ${t.border}40`,color:t.text,boxShadow:Re.lg,overflow:"hidden",animation:"slideIn 0.3s ease-out",minWidth:300},children:[ue.jsxs("div",{style:{padding:"12px 20px",display:"flex",alignItems:"center",gap:10,fontSize:14,fontWeight:Be.fontWeight.medium},children:[ue.jsx("span",{children:t.icon}),ue.jsx("span",{style:{flex:1},children:e.msg}),ue.jsx("button",{onClick:()=>i(t=>t.filter(t=>t.id!==e.id)),style:{background:"none",border:"none",cursor:"pointer",color:t.text,fontSize:16,lineHeight:1},children:"×"})]}),ue.jsx("div",{style:{height:3,background:"rgba(0,0,0,.15)"},children:ue.jsx("div",{style:{height:"100%",background:t.border,animation:"toastProgress 4s linear forwards",borderRadius:"0 2px 2px 0"}})})]},e.id)})}),ue.jsx("style",{children:"\n        @keyframes slideIn { from { transform: translateX(100%); opacity:0; } to { transform: translateX(0); opacity:1; } }\n        @keyframes toastProgress { from { width: 100%; } to { width: 0%; } }\n      "})]})}const wr=()=>e.useContext(Er),Fr=[];function Dr(e){return"number"==typeof e.parts?e:{...e,parts:mr(e.parts,0)}}const Tr=ee((e,t)=>({orders:Fr,isLoading:!1,error:null,initialized:!1,fetchOrders:async()=>{if(t().isLoading)return;if(Tt()){e({isLoading:!0,error:null});try{const t=await ur.list();e({orders:t.map(Dr),initialized:!0,isLoading:!1})}catch(r){e({error:r instanceof Error?r.message:"Siparişler alınamadı",initialized:!0,isLoading:!1})}}else e({initialized:!0,isLoading:!1,error:null})},setOrders:t=>e({orders:t}),upsertOrder:t=>e(e=>{const r=Dr(t),i=e.orders.findIndex(e=>e.id===r.id);if(-1===i)return{orders:[r,...e.orders]};const n=[...e.orders];return n[i]=r,{orders:n}}),saveOrder:async r=>{const i=t().orders;t().upsertOrder(r);try{let e;if(i.some(e=>e.id===r.id))e=await ur.update(r.id,{cust:r.cust,phone:r.phone,mat:r.mat,plate:r.plate,thick:r.thick,status:r.status,grp:r.grp,priority:r.priority});else{const t={cust:r.cust,phone:r.phone,mat:r.mat,plate:r.plate,thick:r.thick,grp:r.grp,priority:r.priority};e=await ur.create(t)}return t().upsertOrder(e),{ok:!0}}catch(n){return e({orders:i}),{ok:!1,message:n instanceof Error?n.message:"Sipariş kaydedilemedi"}}},setOrderStatus:(t,r)=>e(e=>({orders:e.orders.map(e=>e.id===t?{...e,status:r,upd:"az önce"}:e)}))}));function zr({onEdit:t}){const{addToast:r}=wr(),{orders:i,saveOrder:n,fetchOrders:a,initialized:s}=Tr();e.useEffect(()=>{s||a()},[s,a]);const[o,l]=e.useState("ALL"),[d,c]=e.useState("date"),[p,u]=e.useState("desc"),[g,m]=e.useState(new Set),[h]=e.useState("ALL"),x=e.useMemo(()=>i.filter(e=>"ALL"===o||e.status===o),[i,o]),y=[{key:"ALL",label:"Tümü",count:i.length},{key:"NEW",label:"Yeni",count:i.filter(e=>"NEW"===e.status).length},{key:"IN_PRODUCTION",label:"Üretimde",count:i.filter(e=>"IN_PRODUCTION"===e.status).length},{key:"READY",label:"Hazır",count:i.filter(e=>"READY"===e.status).length},{key:"DELIVERED",label:"Teslim",count:i.filter(e=>"DELIVERED"===e.status).length},{key:"DONE",label:"Tamamlanan",count:i.filter(e=>"DONE"===e.status).length},{key:"HOLD",label:"Bekletme",count:i.filter(e=>"HOLD"===e.status).length},{key:"CANCELLED",label:"İptal",count:i.filter(e=>"CANCELLED"===e.status).length}],b=e.useCallback(async e=>{if(0===g.size)return;const t=i.filter(e=>g.has(e.id));let a=0;for(const r of t){(await n({...r,status:e})).ok&&a++}r(`${a}/${g.size} sipariş başarıyla güncellendi`,a===g.size?"success":"warning"),m(new Set)},[g,i,n,r]),f=e.useCallback(async()=>{if(0===g.size)return;if(!confirm(`${g.size} sipariş silmek istediğinizden emin misiniz?`))return;let e=0;for(const t of g)try{await ur.remove(String(t)),e++}catch{}e>0?(r(`${e}/${g.size} sipariş silindi`,e===g.size?"success":"warning"),m(new Set),a()):r("Siparişler silinemedi (sadece NEW durumundaki siparişler silinebilir)","error")},[g,r,a]),v=[{key:"id",label:"Sipariş No",sortable:!0,render:(e,t)=>ue.jsx("span",{style:{color:_e.primary[500],fontFamily:Be.fontFamily.mono},children:t.orderNo||t.id})},{key:"cust",label:"Müşteri",sortable:!0,render:(e,t)=>ue.jsxs("div",{children:[ue.jsx("div",{style:{fontSize:13},children:t.cust}),ue.jsx("div",{style:{fontSize:11,color:_e.gray[400]},children:t.phone})]})},{key:"mat",label:"Malzeme",render:(e,t)=>ue.jsx("span",{style:{color:_e.muted,fontSize:13},children:t.mat})},{key:"thick",label:"Kalınlık",sortable:!0,render:(e,t)=>ue.jsxs("span",{style:{color:_e.muted,fontSize:13},children:[t.thick,"mm"]})},{key:"parts",label:"Parça",sortable:!0,render:(e,t)=>ue.jsx("span",{style:{fontWeight:Be.fontWeight.bold,color:_e.accent[400]},children:mr(t.parts,0)})},{key:"priority",label:"Öncelik",render:(e,t)=>ue.jsx(Ze,{priority:t.priority})},{key:"status",label:"Durum",sortable:!0,render:(e,t)=>ue.jsx(Qe,{status:t.status})},{key:"date",label:"Tarih",sortable:!0,render:(e,t)=>ue.jsx("span",{style:{color:_e.gray[400],fontSize:12},children:t.date})}];return ue.jsxs("div",{className:"electric-page",children:[ue.jsx(kt,{title:"Siparişler",subtitle:`${i.length} aktif sipariş`,breadcrumbs:["Ana İşlemler","Siparişler"],children:ue.jsx(He,{variant:"primary",icon:ue.jsx(V,{size:16,"aria-hidden":"true"}),onClick:()=>t(null),children:"Yeni Sipariş"})}),ue.jsxs("div",{className:"app-page-container",children:[ue.jsx("div",{style:{display:"flex",gap:"2px",marginBottom:"24px",borderBottom:`1px solid ${_e.border}`,flexWrap:"wrap"},children:y.map(e=>ue.jsxs("button",{onClick:()=>l(e.key),style:{display:"flex",alignItems:"center",gap:"6px",padding:"12px 24px",fontSize:14,fontWeight:o===e.key?700:400,color:o===e.key?_e.primary.DEFAULT:_e.muted,background:o===e.key?`${_e.primary.DEFAULT}08`:"transparent",border:"none",borderBottom:o===e.key?`3px solid ${_e.primary.DEFAULT}`:"3px solid transparent",cursor:"pointer",fontFamily:Be.fontFamily.base,marginBottom:"-1px",transition:"all 0.2s",whiteSpace:"nowrap"},children:[e.label," (",e.count,")"]},e.key))}),g.size>0&&ue.jsx(Je,{style:{marginBottom:16,background:"linear-gradient(135deg, rgba(var(--primary-rgb), 0.16), rgba(124,58,237,0.14))",borderColor:"rgba(var(--primary-rgb), 0.45)"},children:ue.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsxs("span",{style:{fontSize:13,fontWeight:600},children:[g.size," sipariş seçildi"]}),ue.jsxs("div",{style:{display:"flex",gap:8},children:[ue.jsxs("select",{value:h,onChange:e=>b(e.target.value),style:{padding:"6px 8px",fontSize:12,borderRadius:Pe.md,border:`1px solid ${_e.border}`,background:_e.surface},children:[ue.jsx("option",{value:"NEW",children:"Durumu değiştir: Yeni"}),ue.jsx("option",{value:"IN_PRODUCTION",children:"Durumu değiştir: Üretimde"}),ue.jsx("option",{value:"READY",children:"Durumu değiştir: Hazır"}),ue.jsx("option",{value:"DELIVERED",children:"Durumu değiştir: Teslim"}),ue.jsx("option",{value:"DONE",children:"Durumu değiştir: Tamamlandı"}),ue.jsx("option",{value:"HOLD",children:"Durumu değiştir: Bekletme"}),ue.jsx("option",{value:"CANCELLED",children:"Durumu değiştir: İptal"})]}),ue.jsx(He,{size:"sm",variant:"secondary",onClick:()=>m(new Set),children:"Seçimi Temizle"}),ue.jsxs(He,{size:"sm",variant:"danger",onClick:f,disabled:0===g.size,children:["Sil (",g.size,")"]})]})]})}),ue.jsx(Je,{title:"Sipariş Listesi",subtitle:`${x.length} kayıt`,children:ue.jsx(Sr,{columns:v,data:x,searchable:!0,searchKeys:["id","cust","phone","mat"],sortKey:d,sortDir:p,onSort:e=>{d!==e?(c(e),u("desc")):u(e=>"asc"===e?"desc":"asc")},paginated:!0,pageSize:20,emptyMessage:"Kayıt bulunamadı.",onRowClick:t,selectable:!0,selectedRows:g,onSelectRows:m,actions:[{label:"Düzenle",variant:"ghost",onClick:e=>t(e)},{label:"XLSX Indir",variant:"secondary",onClick:async e=>{try{const t=await ur.exportOpti(e.id);if(t.files.length>0){const e=[];t.files.forEach(t=>{e.push(t.filename);const r=ur.getExportDownloadUrl(t.filename),i=document.createElement("a");i.href=r,i.download=t.filename,document.body.appendChild(i),i.click(),document.body.removeChild(i)}),r(`OptiPlanning XLSX olusturuldu: ${e.join(", ")}`,"success")}else r("XLSX dosyasi olusturulamadi — siparis parcalari eksik olabilir","error")}catch{r("XLSX export sirasinda hata olustu","error")}}},{label:"Sil",variant:"danger",onClick:async e=>{if(confirm(`"${e.cust||e.id}" siparişini silmek istediğinizden emin misiniz?`))try{await ur.remove(e.id),r("Sipariş silindi","success"),a()}catch{r("Sipariş silinemedi (sadece NEW durumundaki siparişler silinebilir)","error")}}}]})})]})]})}const Cr={DRAFT:"Taslak",NEW:"Yeni",PENDING_APPROVAL:"Onay Bekliyor",APPROVED:"Onaylandı",HOLD:"Beklemede",IN_PRODUCTION:"Üretimde",READY:"Hazır",COMPLETED:"Tamamlandı",DELIVERED:"Teslim Edildi",DONE:"Bitti",CANCELLED:"İptal"},Nr={NEW:"Yeni",PREPARED:"Hazırlandı",OPTI_IMPORTED:"OptiPlanning'e Aktarıldı",OPTI_RUNNING:"Optimizasyon Çalışıyor",OPTI_DONE:"Optimizasyon Bitti",XML_READY:"XML Hazır",DELIVERED:"Makineye İletildi",DONE:"Tamamlandı",HOLD:"Beklemede",FAILED:"Başarısız"},Lr={NEW:"#6366f1",PREPARED:"#8b5cf6",OPTI_IMPORTED:"#0ea5e9",OPTI_RUNNING:"#f59e0b",OPTI_DONE:"#10b981",XML_READY:"#06b6d4",DELIVERED:"#3b82f6",DONE:"#22c55e",HOLD:"#f97316",FAILED:"#ef4444"},Or=["boy","en","adet","grain","u1","u2","k1","k2","delik-1","delik-2","bilgi"],$r=e=>e.reduce((e,t)=>e+(parseInt(t.adet,10)||0),0),Ir=e=>{if(!e)return"";const t=e.trim().replace(",","."),r=Number.parseFloat(t);return Number.isFinite(r)?String(r):""},_r=(e,t="1")=>{const r=Number.parseInt(e,10);return!Number.isFinite(r)||r<=0?t:String(r)},Br=e=>{if(!e)return!1;const t=e.trim().toLowerCase().replace(/[\u0131\u0130]/g,"i").replace(/[\u015f\u015e]/g,"s").replace(/[\u011f\u011e]/g,"g").replace(/[\u00fc\u00dc]/g,"u").replace(/[\u00f6\u00d6]/g,"o").replace(/[\u00e7\u00c7]/g,"c");return""!==t&&"0"!==t&&"yok"!==t&&"hayir"!==t&&"false"!==t&&"no"!==t&&"n"!==t},Pr=e=>e.trim().toLowerCase().replace(/[\u0131\u0130]/g,"i").replace(/[\u015f\u015e]/g,"s").replace(/[\u011f\u011e]/g,"g").replace(/[\u00fc\u00dc]/g,"u").replace(/[\u00f6\u00d6]/g,"o").replace(/[\u00e7\u00c7]/g,"c").replace(/[^a-z0-9]/g,""),Rr=e=>["boy","length","plength"].includes(e)?"boy":["en","width","pwidth"].includes(e)?"en":["adet","qty","quantity","count","minq","pminq"].includes(e)?"adet":["grain","graini","damar","pgrain","pgraini"].includes(e)?"grain":["u1","ust1","ustkenar1","upperstripmat","pedgematup"].includes(e)?"u1":["u2","ust2","ustkenar2","lowerstripmat","pedgematlo","pegdematlo"].includes(e)?"u2":["k1","kenar1","altkenar1","leftstripmat","pedgematsx"].includes(e)?"k1":["k2","kenar2","altkenar2","rightstripmat","pedgematdx"].includes(e)?"k2":["delik1","delik01","hole1","piidesc","iidescription"].includes(e)?"delik1":["delik2","delik02","hole2","pdesc1","description1"].includes(e)?"delik2":["bilgi","not","aciklama","info","description","pidesc"].includes(e)?"info":null,Ur=(e,t)=>{const r=[];let i="",n=!1;for(let a=0;a<e.length;a+=1){const s=e[a];'"'!==s?s!==t||n?i+=s:(r.push(i.trim()),i=""):n&&'"'===e[a+1]?(i+='"',a+=1):n=!n}return r.push(i.trim()),r},Wr=(e,t,r)=>{const i=r=>{const i=t[r];return void 0===i||i<0||i>=e.length?"":e[i]??""};return{id:r,boy:Ir(i("boy")),en:Ir(i("en")),adet:_r(i("adet"),"1"),grain:_r(i("grain"),"0"),u1:Br(i("u1")),u2:Br(i("u2")),k1:Br(i("k1")),k2:Br(i("k2")),delik1:Ir(i("delik1")),delik2:Ir(i("delik2")),info:i("info")}},Mr=e=>{const t=[Or.join(",")];return e.forEach(e=>{t.push([e.boy,e.en,e.adet,e.grain,e.u1?"1":"0",e.u2?"1":"0",e.k1?"1":"0",e.k2?"1":"0",e.delik1,e.delik2,e.info].map(e=>(e=>{if(!e)return"";const t=e.replace(/"/g,'""');return/[",\n]/.test(t)?`"${t}"`:t})(String(e??""))).join(","))}),t.join("\n")},Gr=(e,t,r)=>{const i=new Blob([e],{type:`${r};charset=utf-8`}),n=URL.createObjectURL(i),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(n)},Kr=e=>{const t=[],r=e.replace(/^\uFEFF/,"").trim();if(!r)return{rows:[],warnings:["Dosya bos."]};if(r.includes("<table")){const e=(e=>{if("undefined"==typeof DOMParser)return[];const t=(new DOMParser).parseFromString(e,"text/html"),r=Array.from(t.querySelectorAll("table tr"));if(0===r.length)return[];const i=r.map(e=>Array.from(e.querySelectorAll("th,td")).map(e=>(e.textContent||"").trim())).filter(e=>e.some(e=>e.length>0));if(0===i.length)return[];const n=i[0].map(e=>Rr(Pr(e))),a=n.some(e=>null!==e),s={};return a?n.forEach((e,t)=>{e&&(s[e]=t)}):(s.boy=0,s.en=1,s.adet=2,s.grain=3,s.u1=4,s.u2=5,s.k1=6,s.k2=7,s.delik1=8,s.delik2=9,s.info=10),(a?i.slice(1):i).map((e,t)=>Wr(e,s,t+1)).filter(e=>e.boy||e.en||e.info)})(r);if(e.length>0)return{rows:e,warnings:t};t.push("HTML tablo okunamadi. Metin ayristirma denenecek.")}const i=r.split(/\r?\n/).map(e=>e.trim()).filter(e=>e.length>0);if(0===i.length)return{rows:[],warnings:["Dosyada satir bulunamadi."]};const n=(e=>{const t=[",",";","\t"].map(t=>({delimiter:t,count:e.split(t).length-1}));return t.sort((e,t)=>t.count-e.count),t[0].delimiter})(i[0]),a=Ur(i[0],n).map(e=>Rr(Pr(e))),s=a.some(e=>null!==e),o={};s?a.forEach((e,t)=>{e&&(o[e]=t)}):(o.boy=0,o.en=1,o.adet=2,o.grain=3,o.u1=4,o.u2=5,o.k1=6,o.k2=7,o.delik1=8,o.delik2=9,o.info=10);const l=(s?i.slice(1):i).map(e=>Ur(e,n)).map((e,t)=>Wr(e,o,t+1)).filter(e=>e.boy||e.en||e.info);return 0===l.length&&t.push("Gecerli olcu satiri bulunamadi."),{rows:l,warnings:t}};function Hr({rows:e,isArk:t,selectedGrain:r,onRowUpdate:i,onAddRow:n,onRemoveRow:a}){const s=$r(e),o=(e=>(e.reduce((e,t)=>e+(parseFloat(t.boy)||0)*(parseFloat(t.en)||0)*(parseInt(t.adet,10)||0),0)/1e6).toFixed(2))(e),l={padding:"7px 10px",borderRadius:Pe.md,border:`1px solid ${_e.border2}`,fontSize:13,outline:"none",transition:We.fast,background:"rgba(255,255,255,.04)",color:_e.text},d={width:16,height:16,cursor:"pointer",accentColor:_e.accent[400]};return ue.jsxs(Je,{children:[t&&ue.jsx("div",{style:{padding:"10px 16px",background:_e.info.light,fontSize:13,color:_e.info.dark},children:"Arkalık grubunda bant alanları kapalıdır (Kural #9)"}),ue.jsxs("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[ue.jsxs("div",{style:{fontSize:13,color:_e.gray[500]},children:[e.length," satır / ",s," parça"]}),ue.jsx("div",{style:{display:"flex",gap:8},children:ue.jsx(He,{variant:"secondary",size:"sm",onClick:n,children:"+ Satır Ekle"})})]}),ue.jsx("div",{style:{overflowX:"auto"},children:ue.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[ue.jsx("thead",{children:ue.jsxs("tr",{style:{borderBottom:`1px solid ${_e.border2}`,background:"rgba(255,255,255,.02)"},children:[ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center",width:40},children:"#"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"left"},children:"Boy"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"left"},children:"En"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"left"},children:"Adet"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center"},children:"Desen"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center"},children:"U1"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center"},children:"U2"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center"},children:"K1"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center"},children:"K2"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center",width:90},children:"DELİK-1"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center",width:90},children:"DELİK-2"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"left"},children:"Bilgi"}),ue.jsx("th",{style:{padding:"10px 8px",fontSize:11,fontWeight:Be.fontWeight.semibold,color:_e.gray[400],textAlign:"center",width:40}})]})}),ue.jsx("tbody",{children:e.map((e,n)=>ue.jsxs("tr",{style:{borderBottom:`1px solid ${_e.border}`,background:n%2==0?"transparent":"rgba(255,255,255,.02)"},children:[ue.jsx("td",{style:{padding:"6px 8px",textAlign:"center",fontSize:12,color:_e.gray[400]},children:e.id}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{type:"number",value:e.boy||"",onChange:t=>i(e.id,"boy",t.target.value),style:{...l,width:80,textAlign:"center"}})}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{type:"number",value:e.en||"",onChange:t=>i(e.id,"en",t.target.value),style:{...l,width:80,textAlign:"center"}})}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{type:"number",value:e.adet||"",onChange:t=>i(e.id,"adet",t.target.value),style:{...l,width:60,textAlign:"center"}})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:ue.jsxs("select",{value:e.grain||r,onChange:t=>i(e.id,"grain",t.target.value),style:{...l,width:60,padding:"5px 2px",textAlign:"center"},children:[ue.jsx("option",{value:"0",children:"0"}),ue.jsx("option",{value:"1",children:"1"}),ue.jsx("option",{value:"2",children:"2"}),ue.jsx("option",{value:"3",children:"3"})]})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:t?ue.jsx("span",{style:{color:_e.gray[500]},children:"—"}):ue.jsx("input",{type:"checkbox",checked:!!e.u1,onChange:t=>i(e.id,"u1",t.target.checked),style:d})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:t?ue.jsx("span",{style:{color:_e.gray[500]},children:"—"}):ue.jsx("input",{type:"checkbox",checked:!!e.u2,onChange:t=>i(e.id,"u2",t.target.checked),style:d})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:t?ue.jsx("span",{style:{color:_e.gray[500]},children:"—"}):ue.jsx("input",{type:"checkbox",checked:!!e.k1,onChange:t=>i(e.id,"k1",t.target.checked),style:d})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:t?ue.jsx("span",{style:{color:_e.gray[500]},children:"—"}):ue.jsx("input",{type:"checkbox",checked:!!e.k2,onChange:t=>i(e.id,"k2",t.target.checked),style:d})}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{type:"number",value:e.delik1||"",onChange:t=>i(e.id,"delik1",t.target.value),style:{...l,width:80,textAlign:"center"}})}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{type:"number",value:e.delik2||"",onChange:t=>i(e.id,"delik2",t.target.value),style:{...l,width:80,textAlign:"center"}})}),ue.jsx("td",{style:{padding:"4px 6px"},children:ue.jsx("input",{value:e.info||"",onChange:t=>i(e.id,"info",t.target.value),style:{...l,width:"100%"},placeholder:"Parça bilgi"})}),ue.jsx("td",{style:{padding:"4px 6px",textAlign:"center"},children:ue.jsx("button",{onClick:()=>a(e.id),style:{background:"none",border:"none",cursor:"pointer",color:_e.error.DEFAULT,fontSize:16,lineHeight:1},title:"Satırı sil",children:"×"})})]},e.id))})]})}),ue.jsxs("div",{style:{padding:"10px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",borderTop:`1px solid ${_e.border}`,fontSize:12},children:[ue.jsxs("div",{style:{display:"flex",gap:20},children:[ue.jsxs("span",{style:{color:_e.muted},children:["Satır: ",ue.jsx("strong",{style:{color:_e.text},children:e.length})]}),ue.jsxs("span",{style:{color:_e.muted},children:["Parça: ",ue.jsx("strong",{style:{color:_e.accent[400]},children:s})]}),ue.jsxs("span",{style:{color:_e.muted},children:["Tahmini m²: ",ue.jsx("strong",{style:{color:_e.primary[500]},children:o})]})]}),ue.jsx("span",{style:{color:_e.gray[400],fontSize:11},children:"Bant payı UI'da hesaplanmaz — tik değerleri gönderilir"})]})]})}function Jr(e){const t=Array.isArray(e.events)?e.events.map(e=>({id:Number(e.id),jobId:String(e.jobId??""),eventType:String(e.eventType??""),message:null!=e.message?String(e.message):null,detailsJson:null!=e.detailsJson?String(e.detailsJson):null,createdAt:null!=e.createdAt?String(e.createdAt):null})):[];return{id:String(e.id??""),orderId:Number(e.orderId??0),state:e.state??"NEW",optiMode:e.optiMode??"C",errorCode:null!=e.errorCode?String(e.errorCode):null,errorMessage:null!=e.errorMessage?String(e.errorMessage):null,retryCount:Number(e.retryCount??0),createdAt:null!=e.createdAt?String(e.createdAt):null,updatedAt:null!=e.updatedAt?String(e.updatedAt):null,createdBy:null!=e.createdBy?Number(e.createdBy):void 0,events:t}}const Yr={async listJobs(e){const t=new URLSearchParams;(null==e?void 0:e.limit)&&t.set("limit",String(e.limit)),(null==e?void 0:e.offset)&&t.set("offset",String(e.offset)),(null==e?void 0:e.state)&&t.set("state",e.state),(null==e?void 0:e.orderId)&&t.set("order_id",String(e.orderId));const r=t.toString(),i=await _t("/orchestrator/jobs"+(r?"?"+r:""),{method:"GET"}),n=Array.isArray(i.jobs)?i.jobs.map(Jr):[];return{jobs:n,total:Number(i.total??n.length)}},getJob:async e=>Jr(await _t(`/orchestrator/jobs/${e}`,{method:"GET"})),retryJob:async e=>Jr(await _t(`/orchestrator/jobs/${e}/retry`,{method:"POST"})),approveJob:async e=>Jr(await _t(`/orchestrator/jobs/${e}/approve`,{method:"POST"})),syncJob:async e=>Jr(await _t(`/orchestrator/jobs/${e}/sync`,{method:"POST"})),cancelJob:async e=>Jr(await _t(`/orchestrator/jobs/${e}/cancel`,{method:"POST"})),createJob:async e=>Jr(await _t("/orchestrator/jobs",{method:"POST",body:JSON.stringify({order_id:e.orderId,customer_phone:e.customerPhone,customer_snapshot_name:e.customerSnapshotName,opti_mode:e.optiMode??"C",plate_width_mm:e.plateWidthMm,plate_height_mm:e.plateHeightMm,parts:e.parts.map(e=>({id:e.id,part_type:e.partType,material_code:e.materialCode,length_cm:e.lengthCm,width_cm:e.widthCm,quantity:e.quantity,grain:e.grain,color:e.color,thickness_mm:e.thicknessMm}))})})),getXmlDownloadUrl:e=>`${Ct()}/orchestrator/jobs/${e}/xml`,runOptimization:async(e,t)=>await _t("/optiplanning/optimization/run",{method:"POST",body:JSON.stringify({order_ids:e,params:t,config_name:"DEFAULT"})}),async getReceipt(e){const t=await _t(`/orchestrator/jobs/${e}/receipt`,{method:"GET"}),r=t.xmlParse??t.xml_parse??{},i=t.invoice??null;return{jobId:String(t.jobId??t.job_id??""),orderId:Number(t.orderId??t.order_id??0),orderTsCode:null!=t.orderTsCode?String(t.orderTsCode):null!=t.order_ts_code?String(t.order_ts_code):null,customerName:null!=t.customerName?String(t.customerName):null!=t.customer_name?String(t.customer_name):null,xmlParse:{bestSolution:null!=r.bestSolution?String(r.bestSolution):null!=r.best_solution?String(r.best_solution):void 0,algorithm:null!=r.algorithm?String(r.algorithm):void 0,mqBoards:null!=r.mqBoards?Number(r.mqBoards):null!=r.mq_boards?Number(r.mq_boards):void 0,patterns:null!=r.patterns?Number(r.patterns):void 0,zcuts:null!=r.zcuts?Number(r.zcuts):void 0,jobTime:null!=r.jobTime?Number(r.jobTime):null!=r.job_time?Number(r.job_time):void 0,jobCost:null!=r.jobCost?Number(r.jobCost):null!=r.job_cost?Number(r.job_cost):void 0,mqDrops:null!=r.mqDrops?Number(r.mqDrops):null!=r.mq_drops?Number(r.mq_drops):void 0,totalSolutions:null!=r.totalSolutions?Number(r.totalSolutions):null!=r.total_solutions?Number(r.total_solutions):void 0,error:null!=r.error?String(r.error):void 0},plakaAdedi:Number(t.plakaAdedi??t.plaka_adedi??0),bantMetre:Number(t.bantMetre??t.bant_metre??0),invoice:i?{id:Number(i.id??0),number:String(i.number??""),subtotal:Number(i.subtotal??0),totalAmount:Number(i.totalAmount??i.total_amount??0),status:null!=i.status?String(i.status):null,notes:null!=i.notes?String(i.notes):null}:null}},async createReceipt(e){const t=await _t(`/orchestrator/jobs/${e}/receipt`,{method:"POST"});return{message:String(t.message??""),invoiceId:Number(t.invoiceId??t.invoice_id??0),invoiceNumber:String(t.invoiceNumber??t.invoice_number??""),totalAmount:Number(t.totalAmount??t.total_amount??0)}},async getWorkerStatus(){const e=await _t("/orchestrator/jobs/worker/status",{method:"GET"});return{circuitOpen:Boolean(e.circuitOpen??e.circuit_open??!1),consecutiveFailures:Number(e.consecutiveFailures??e.consecutive_failures??0),maxConsecutiveFailures:Number(e.maxConsecutiveFailures??e.max_consecutive_failures??3),lastRunAt:null!=e.lastRunAt?String(e.lastRunAt):null!=e.last_run_at?String(e.last_run_at):null,lastError:null!=e.lastError?String(e.lastError):null!=e.last_error?String(e.last_error):null,engine:String(e.engine??""),supportedEngines:Array.isArray(e.supportedEngines??e.supported_engines)?e.supportedEngines??e.supported_engines:[],queueCount:Number(e.queueCount??e.queue_count??0),runningCount:Number(e.runningCount??e.running_count??0),scriptPath:String(e.scriptPath??e.script_path??""),scriptExists:Boolean(e.scriptExists??e.script_exists??!1)}},async resetWorkerCircuitBreaker(){const e=await _t("/orchestrator/jobs/worker/reset",{method:"POST"});return{message:String(e.message??"")}}},Vr={id:1,boy:"",en:"",adet:"1",grain:"0",u1:!1,u2:!1,k1:!1,k2:!1,delik1:"",delik2:"",info:""},qr=(e,t)=>`${e}-${(new Date).toISOString().replace(/[:.]/g,"-")}.${t}`,Xr=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),Zr={padding:"18px 16px",border:`1px solid ${_e.border}`,borderRadius:Pe.lg,background:`${_e.primary[500]}10`,cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:10,color:_e.primary[500],transition:We.fast,fontSize:13,fontWeight:600};function Qr({order:t,onBack:r}){const[i,n]=e.useState("measures"),[a,s]=e.useState([{...Vr}]),[o,l]=e.useState((null==t?void 0:t.mat)||"Belirtilmedi"),[d,c]=e.useState((null==t?void 0:t.plate)||"2100x2800"),[p,u]=e.useState((null==t?void 0:t.thick)||18),[g,m]=e.useState((null==t?void 0:t.cust)||""),[h,x]=e.useState((null==t?void 0:t.phone)||""),[y,b]=e.useState(!1),[f,v]=e.useState([]),[j,k]=e.useState(null),[S,E]=e.useState(null),[A,w]=e.useState((null==t?void 0:t.id)||null),[F,D]=e.useState(!1),[T,z]=e.useState((null==t?void 0:t.priority)||"normal"),[C,N]=e.useState((null==t?void 0:t.status)||"NEW"),[L,O]=e.useState(!1),[$,I]=e.useState(!1),[_,B]=e.useState(null),P="ARKALIK"===(null==t?void 0:t.grp),R=Math.max(...a.map(e=>e.id),0)+1;e.useEffect(()=>{if(!(null==t?void 0:t.id)||$)return;let e=!1;return(async()=>{try{const r=await _t(`/orders/${t.id}`,{method:"GET"});if(e)return;const i=Array.isArray(r.parts)?r.parts:[];if(i.length>0){const e=i.map((e,t)=>({id:t+1,boy:String(e.boyMm??e.boy_mm??""),en:String(e.enMm??e.en_mm??""),adet:String(e.adet??"1"),grain:String(e.grainCode??e.grain_code??"0").replace("-Material",""),u1:Boolean(e.u1??!1),u2:Boolean(e.u2??!1),k1:Boolean(e.k1??!1),k2:Boolean(e.k2??!1),delik1:String(e.drillCode1??e.drill_code_1??""),delik2:String(e.drillCode2??e.drill_code_2??""),info:String(e.partDesc??e.part_desc??"")}));s(e),B(null)}else B(null);const n=r.materialName??r.material_name;n&&l(String(n));const a=r.thicknessMm??r.thickness_mm;a&&u(Number(a));const o=r.plateWMm??r.plate_w_mm,d=r.plateHMm??r.plate_h_mm;if(o){const e=Number(o),t=Number(d??0);e>0&&t>0&&c(`${e}x${t}`)}const p=r.crmNameSnapshot??r.crm_name_snapshot;p&&m(String(p));const g=r.phoneNorm??r.phone_norm;g&&x(String(g));const h=r.status;h&&"string"==typeof h&&N(h);const y=r.priority;y&&"string"==typeof y&&z(y)}catch{B("Backend baglantisi kurulamadi — parca bilgileri yuklenemedi. Backend sunucusunun calistigindan emin olun.")}finally{e||I(!0)}})(),()=>{e=!0}},[null==t?void 0:t.id]);const U=e.useCallback(e=>{const t=[],r=h.replace(/\D/g,""),i=Number.parseFloat(String(p));return g.trim()||t.push("Musteri adi gerekli."),!r||r.length<10?t.push("Telefon zorunlu ve en az 10 haneli olmali."):/^[+0-9()\s-]{10,20}$/.test(h.trim())||t.push("Telefon formati gecersiz."),Number.isFinite(i)&&[4,5,8,18].includes(Math.round(i))||t.push("Kalinlik sadece 4, 5, 8 veya 18 mm olabilir."),d.trim()||t.push("Plaka boyutu gerekli."),0===a.length&&t.push("En az bir olcu satiri gerekli."),a.forEach(e=>{const r=Number.parseFloat(e.boy),i=Number.parseFloat(e.en),n=Number.parseInt(e.adet,10),a=Number.parseInt(e.grain,10);(!Number.isFinite(r)||r<=0)&&t.push(`Satir ${e.id}: Boy 0'dan buyuk olmali.`),(!Number.isFinite(i)||i<=0)&&t.push(`Satir ${e.id}: En 0'dan buyuk olmali.`),(!Number.isFinite(n)||n<=0)&&t.push(`Satir ${e.id}: Adet 1 veya daha buyuk olmali.`),[0,1,2,3].includes(a)||t.push(`Satir ${e.id}: Desen 0-3 arasinda olmali.`)}),v(t),0===t.length&&e&&n("export"),0===t.length},[g,h,p,d,a]),[W,M]=e.useState(!1),G=e=>{const t=e.replace(/\s+/g,"").match(/(\d+(?:[.,]\d+)?)\s*[xX*\u00D7]\s*(\d+(?:[.,]\d+)?)/);if(!t)return{};const r=Number.parseFloat(t[1].replace(",",".")),i=Number.parseFloat(t[2].replace(",","."));return!Number.isFinite(r)||!Number.isFinite(i)||r<=0||i<=0?{}:{widthMm:Math.round(r),heightMm:Math.round(i)}},K=e=>e.replace(/\D/g,""),H=e=>{const t=Number.parseInt(e,10);return 1===t?"1-Material":2===t?"2-Material":3===t?"3-Material":"0-Material"},J=e=>{const r="ARKALIK"===(null==t?void 0:t.grp)?"ARKALIK":"GOVDE",i=o.trim()||"MATERIAL",n=o.trim()||"Belirtilmedi",a=Number.isFinite(p)&&p>0?p:18,s="ARKALIK"===r?8:a;return e.map(e=>{const t=Number.parseFloat(String(e.boy).replace(",",".")),a=Number.parseFloat(String(e.en).replace(",",".")),o=Number.parseInt(String(e.adet),10),l=Number.parseInt(String(e.grain),10);return{id:String(e.id),partType:r,materialCode:i,lengthCm:Number.isFinite(t)&&t>0?t/10:0,widthCm:Number.isFinite(a)&&a>0?a/10:0,quantity:Number.isFinite(o)&&o>0?o:1,grain:[0,1,2,3].includes(l)?l:0,color:n,thicknessMm:s}})},Y=async()=>{const e=K(h),r=e.length>10?e.slice(-10):e,i=await(async e=>{const t=e.length>10?e.slice(-10):e;if(10===t.length&&t.startsWith("5"))try{const e=await _t(`/customers/lookup?phone=${encodeURIComponent(t)}`,{method:"GET"});if(null==e?void 0:e.id)return Number(e.id)}catch{}try{const e=(await _t("/customers/",{method:"GET"})).find(e=>K(e.phone||"")===t);if(null==e?void 0:e.id)return Number(e.id)}catch{}try{const e=await _t("/customers/",{method:"POST",body:JSON.stringify({name:g.trim()||"Yeni Musteri",phone:t})});return Number(e.id)}catch{const e=(await _t("/customers/",{method:"GET"})).find(e=>K(e.phone||"")===t);if(null==e?void 0:e.id)return Number(e.id);throw new Error("Musteri kaydi olusturulamadi.")}})(r),{widthMm:n,heightMm:s}=G(d),l=o.trim()||"Belirtilmedi",c={customer_id:i,phone_norm:r,thickness_mm:Math.round(Number.parseFloat(String(p))),plate_w_mm:n??2100,plate_h_mm:s??2800,color:l,material_name:l,grain_default:"0-Material",priority:T},u=(e=>{const r="ARKALIK"===(null==t?void 0:t.grp)?"ARKALIK":"GOVDE";return e.map(e=>{var t,i,n;const a=Number.parseFloat(String(e.boy).replace(",",".")),s=Number.parseFloat(String(e.en).replace(",",".")),o=Number.parseInt(String(e.adet),10),l="ARKALIK"===r;return{part_group:r,boy_mm:Number.isFinite(a)&&a>0?a:0,en_mm:Number.isFinite(s)&&s>0?s:0,adet:Number.isFinite(o)&&o>0?o:1,grain_code:H(e.grain),u1:!l&&e.u1,u2:!l&&e.u2,k1:!l&&e.k1,k2:!l&&e.k2,part_desc:(null==(t=e.info)?void 0:t.trim())?e.info.trim():null,drill_code_1:(null==(i=e.delik1)?void 0:i.trim())?e.delik1.trim():null,drill_code_2:(null==(n=e.delik2)?void 0:n.trim())?e.delik2.trim():null}})})(a),m=A||(null==t?void 0:t.id);if(m)return await _t(`/orders/${m}`,{method:"PUT",body:JSON.stringify(c)}),await _t(`/orders/${m}/parts`,{method:"PUT",body:JSON.stringify(u)}),m;const x=await _t("/orders",{method:"POST",body:JSON.stringify({...c,parts:u})}),y=String(x.id);return w(y),y},V=e.useCallback(async()=>{if(F)return;if(U(!1)){D(!0);try{await Y(),await Tr.getState().fetchOrders(),window.alert(`Siparis kaydedildi: ${g} (${$r(a)} parca)`)}catch(e){window.alert("Kaydedilirken hata olustu: "+e.message)}finally{D(!1)}}else n("validate")},[a,g,h,o,d,p,t,T,U,F]);e.useEffect(()=>{const e=e=>{e.ctrlKey&&"s"===e.key.toLowerCase()&&(e.preventDefault(),V())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[V]);const q=async e=>{var t,r,i,a;k(null),E(null);const o=null==(t=e.name.split(".").pop())?void 0:t.toLowerCase();if(o&&["csv","txt","xls","xlsx"].includes(o))try{let t,d;if("xlsx"===o||"xls"===o){const n=await e.arrayBuffer(),s=te(n,{type:"array"}),o=s.SheetNames[0],p=s.Sheets[o],g=(e=>{const t=[];if(!e||0===e.length)return{rows:[],warnings:["Dosya icerigi bos."]};let r,i,n,a=-1,s=-1,o=0,l=[];for(let u=0;u<Math.min(100,e.length);u++){const t=e[u];if(!t||0===t.length)continue;const d=t.map(e=>String(e??""));if(!d.some(e=>e.trim().length>0))continue;const c=String(t[0]||"").toUpperCase();if(u<10){if(!r){const e=c.match(/(\d+)\s*MM/);if(e)r=parseInt(e[1],10);else{const e=parseInt(c,10);!isNaN(e)&&e>=1&&e<=60&&(r=e)}}if(!i){const e=c.match(/(\d+)\s*[*X]\s*(\d+)/);if(e){let t=parseInt(e[1],10),r=parseInt(e[2],10);t<1e3&&(t*=10),r<1e3&&(r*=10),i=`${t}x${r}`}}if(!n)for(const e of t){const r=String(e||"").trim(),i=r.toUpperCase();if(i.startsWith("RENK")||i.startsWith("MALZEME")){const i=r.split(/[:=]/);if(i.length>1&&i[1].trim())n=i[1].trim();else{const r=t.indexOf(e);r<t.length-1&&t[r+1]&&(n=String(t[r+1]).trim())}break}}}if(-1===a){const e=d.map(e=>Rr(Pr(e)));e.some(e=>null!==e)&&(a=u,l=e)}if(-1===s){const e=d.length>=3&&!isNaN(parseFloat(d[0]))&&!isNaN(parseFloat(d[1]))&&!isNaN(parseFloat(d[2])),t=d.length>=4&&!isNaN(parseFloat(d[1]))&&!isNaN(parseFloat(d[2]))&&!isNaN(parseFloat(d[3]));(e||t)&&(s=u,o=t&&!e?1:0)}}if(-1===a&&-1===s)return{rows:[],warnings:["Dosya icinde veri satiri bulunamadi."]};const d={};let c=0;if(-1!==a){if(l.forEach((e,t)=>{e&&void 0===d[e]&&(d[e]=t)}),c=a+1,void 0===d.boy||void 0===d.en||void 0===d.adet){const t=-1===s?[]:e[s].map(e=>String(e??""));t.length>=4&&!isNaN(parseFloat(t[1]??""))&&!isNaN(parseFloat(t[2]??""))&&!isNaN(parseFloat(t[3]??""))?(d.boy=1,d.en=2,d.adet=3,d.grain=d.grain??4,d.u1=d.u1??5,d.u2=d.u2??6,d.k1=d.k1??7,d.k2=d.k2??8,d.delik1=d.delik1??9,d.delik2=d.delik2??10,d.info=d.info??11):(d.boy=0,d.en=1,d.adet=2,d.grain=d.grain??3,d.u1=d.u1??4,d.u2=d.u2??5,d.k1=d.k1??6,d.k2=d.k2??7,d.delik1=d.delik1??8,d.delik2=d.delik2??9,d.info=d.info??10)}}else c=-1===s?0:s,1===o?(d.boy=1,d.en=2,d.adet=3,d.grain=4,d.u1=5,d.u2=6,d.k1=7,d.k2=8,d.delik1=9,d.delik2=10,d.info=11):(d.boy=0,d.en=1,d.adet=2,d.grain=3,d.u1=4,d.u2=5,d.k1=6,d.k2=7,d.delik1=8,d.delik2=9,d.info=10);const p=e.slice(c).filter(e=>e&&e.length>0).map(e=>e.map(e=>String(e??""))).map((e,t)=>Wr(e,d,t+1)).filter(e=>e.boy||e.en);return 0===p.length&&t.push("Gecerli olcu satiri bulunamadi."),{rows:p,warnings:t,meta:{thickness:r,plateSize:i,material:n}}})(re.sheet_to_json(p,{header:1}));t=g.rows,d=g.warnings,(null==(r=g.meta)?void 0:r.thickness)&&u(g.meta.thickness),(null==(i=g.meta)?void 0:i.plateSize)&&c(g.meta.plateSize),(null==(a=g.meta)?void 0:a.material)&&l(g.meta.material);const h=e.name.substring(0,e.name.lastIndexOf("."))||e.name;m(h.trim()),x("")}else{const r=await e.text(),i=Kr(r);t=i.rows,d=i.warnings}if(0===t.length)return void k(d[0]||"Dosya icinden gecerli olcu satiri okunamadi.");const p=t.map((e,t)=>({...e,id:t+1,grain:e.grain||"0"}));s(p),n("measures"),b(!1),E(`${p.length} satir ice aktarildi (${e.name}).`),d.length>0&&k(d.join(" "))}catch(d){k("Dosya okunurken bir hata olustu.")}else k("Desteklenmeyen dosya tipi. CSV, TXT, XLS veya XLSX kullanin.")},X=e=>{e.currentTarget.style.background=`${_e.primary[500]}20`,e.currentTarget.style.borderColor=_e.primary[500]},Z=e=>{e.currentTarget.style.background=`${_e.primary[500]}10`,e.currentTarget.style.borderColor=_e.border};return ue.jsxs("div",{className:"electric-page",children:[ue.jsx(kt,{title:t?t.cust:"Yeni Siparis",subtitle:"Olcu girisi, dogrulama ve disa aktarma",breadcrumbs:["Siparisler","Editor"]}),ue.jsxs("div",{className:"app-page-container",style:{display:"flex",flexDirection:"column",gap:16,paddingBottom:200},children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[ue.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer",color:_e.muted,fontSize:20},"aria-label":"Geri don",children:"<-"}),ue.jsx("h2",{style:{margin:0,fontSize:Be.fontSize["2xl"],fontWeight:Be.fontWeight.bold},children:t?t.cust:"Yeni Siparis"})]}),ue.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[t&&ue.jsx("span",{style:{padding:"4px 10px",fontSize:11,fontWeight:600,borderRadius:Pe.md,background:"NEW"===C?`${_e.info.DEFAULT}20`:"IN_PRODUCTION"===C?`${_e.accent[400]}20`:"READY"===C?`${_e.success.DEFAULT}20`:`${_e.muted}20`,color:"NEW"===C?_e.info.DEFAULT:"IN_PRODUCTION"===C?_e.accent[400]:"READY"===C?_e.success.DEFAULT:_e.muted},children:Cr[C]||C}),ue.jsxs("select",{value:T,onChange:e=>z(e.target.value),title:"Oncelik",style:{padding:"6px 8px",fontSize:12,borderRadius:Pe.md,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text},children:[ue.jsx("option",{value:"low",children:"Dusuk"}),ue.jsx("option",{value:"normal",children:"Normal"}),ue.jsx("option",{value:"high",children:"Yuksek"}),ue.jsx("option",{value:"urgent",children:"Acil"})]}),ue.jsx(He,{onClick:()=>b(!0),variant:"secondary",size:"sm",children:"Ice Aktar"}),ue.jsx(He,{onClick:V,variant:"secondary",size:"sm",children:"Kaydet (Ctrl+S)"}),ue.jsx(He,{onClick:async()=>{if(F||W)return;if(U(!1)){M(!0);try{const e=await Y(),t=Number.parseInt(String(e),10);if(!Number.isFinite(t)||t<=0)throw new Error("Siparis ID gecersiz.");const{widthMm:r,heightMm:i}=G(d),n=await Yr.createJob({orderId:t,customerPhone:h.trim()||"",customerSnapshotName:g.trim()||void 0,optiMode:"C",plateWidthMm:r,plateHeightMm:i,parts:J(a)});await Tr.getState().fetchOrders(),window.alert(`Siparis optimizasyon kuyruguna alindi. Job ID: ${n.id}`)}catch(e){window.alert("Optimizasyon baslatilamadi: "+e.message)}finally{M(!1)}}else n("validate")},size:"sm",disabled:W||0===a.length,title:"Siparisi kaydedip OptiPlanning'e gonderir",children:W?"Gonderiliyor...":"Optimizasyona Gonder"}),t&&ue.jsx(He,{variant:"danger",size:"sm",disabled:L,onClick:async()=>{if(confirm("Bu siparisi silmek istediginizden emin misiniz?")){O(!0);try{await ur.remove(t.id),await Tr.getState().fetchOrders(),r()}catch{window.alert("Siparis silinemedi (sadece NEW durumundaki siparisler silinebilir)")}finally{O(!1)}}},children:L?"Siliniyor...":"Sil"})]})]}),_&&ue.jsx(Je,{style:{border:`1px solid ${_e.error.DEFAULT}`,background:`${_e.error.DEFAULT}10`},children:ue.jsx("div",{style:{padding:"10px 14px",fontSize:13,color:_e.error.DEFAULT},children:_})}),S&&ue.jsx(Je,{style:{border:`1px solid ${_e.success.DEFAULT}`,background:`${_e.success.DEFAULT}10`},children:ue.jsx("div",{style:{padding:"10px 14px",fontSize:13,color:_e.success.DEFAULT},children:S})}),j&&ue.jsx(Je,{style:{border:`1px solid ${_e.warning.DEFAULT}`,background:`${_e.warning.DEFAULT}10`},children:ue.jsx("div",{style:{padding:"10px 14px",fontSize:13,color:_e.warning.DEFAULT},children:j})}),ue.jsx(Je,{children:ue.jsxs("div",{style:{padding:"16px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12},children:[ue.jsxs("div",{children:[ue.jsx("label",{style:{fontSize:12,fontWeight:600,color:_e.gray[400],display:"block",marginBottom:8},children:"Musteri"}),ue.jsx("input",{type:"text",value:g,onChange:e=>m(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:6,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text,fontSize:13,outline:"none",transition:We.fast},placeholder:"Musteri adi"})]}),ue.jsxs("div",{children:[ue.jsx("label",{style:{fontSize:12,fontWeight:600,color:_e.gray[400],display:"block",marginBottom:8},children:"Telefon"}),ue.jsx("input",{type:"text",value:h,onChange:e=>x(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:6,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text,fontSize:13,outline:"none",transition:We.fast},placeholder:"+90 555 123 45 67"})]}),ue.jsxs("div",{children:[ue.jsx("label",{style:{fontSize:12,fontWeight:600,color:_e.gray[400],display:"block",marginBottom:8},children:"Plaka Boyutu"}),ue.jsxs("select",{value:d,onChange:e=>c(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:6,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text,fontSize:13,outline:"none",transition:We.fast},children:[ue.jsx("option",{children:"2100x2800"}),ue.jsx("option",{children:"2000x3000"}),ue.jsx("option",{children:"1500x2000"})]})]}),ue.jsxs("div",{children:[ue.jsx("label",{style:{fontSize:12,fontWeight:600,color:_e.gray[400],display:"block",marginBottom:8},children:"Kalinlik (mm)"}),ue.jsx("input",{type:"number",value:p,onChange:e=>u(parseFloat(e.target.value)),style:{width:"100%",padding:"10px 14px",borderRadius:6,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text,fontSize:13,outline:"none",transition:We.fast},min:"0.5",max:"100",step:"0.5"})]}),ue.jsxs("div",{children:[ue.jsx("label",{style:{fontSize:12,fontWeight:600,color:_e.gray[400],display:"block",marginBottom:8},children:"Renk / Malzeme"}),ue.jsx("input",{type:"text",value:o,onChange:e=>l(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:6,border:`1px solid ${_e.border}`,background:"rgba(14, 20, 25, 0.5)",color:_e.text,fontSize:13,outline:"none",transition:We.fast},placeholder:"Renk veya malzeme"})]})]})}),ue.jsx("div",{style:{display:"flex",gap:0,borderBottom:`1px solid ${_e.border}`},children:["measures","validate","export"].map(e=>ue.jsxs("button",{onClick:()=>n(e),style:{padding:"12px 20px",border:"none",background:"none",cursor:"pointer",color:i===e?_e.primary[500]:_e.gray[500],fontSize:14,fontWeight:Be.fontWeight.semibold,borderBottom:i===e?`2px solid ${_e.primary[500]}`:"none",transition:We.fast},children:["measures"===e&&"Olculer","validate"===e&&"Dogrula","export"===e&&"Disa Aktar"]},e))}),"measures"===i&&ue.jsx(Hr,{rows:a,isArk:P,selectedGrain:"0",onRowUpdate:(e,t,r)=>{s(i=>i.map(i=>i.id===e?{...i,[t]:r}:i))},onAddRow:()=>{s(e=>[...e,{id:R,boy:"",en:"",adet:"1",grain:"0",u1:!1,u2:!1,k1:!1,k2:!1,delik1:"",delik2:"",info:""}])},onRemoveRow:e=>{s(t=>t.filter(t=>t.id!==e))}}),"validate"===i&&ue.jsxs(Je,{style:{padding:"20px"},children:[0===f.length?ue.jsxs("div",{style:{textAlign:"center",color:_e.success.DEFAULT,padding:"20px 12px"},children:[ue.jsx("div",{style:{fontSize:32,marginBottom:12},children:"OK"}),ue.jsx("div",{style:{fontSize:14,fontWeight:Be.fontWeight.semibold},children:"Hata yok. Disa aktarmaya hazir."}),ue.jsx(He,{onClick:()=>n("export"),style:{marginTop:16},children:"Disa Aktar Adimina Git"})]}):ue.jsxs("div",{children:[ue.jsxs("div",{style:{color:_e.error.DEFAULT,marginBottom:16,fontSize:14,fontWeight:Be.fontWeight.semibold},children:[f.length," hata bulundu:"]}),ue.jsx("ul",{style:{margin:0,paddingLeft:20,color:_e.text,fontSize:13,lineHeight:1.6},children:f.map((e,t)=>ue.jsx("li",{children:e},t))})]}),ue.jsxs("div",{style:{marginTop:20,display:"flex",gap:8,justifyContent:"center"},children:[ue.jsx(He,{onClick:()=>{U(!0)},variant:"secondary",children:"Tekrar Dogrula"}),ue.jsx(He,{onClick:()=>n("measures"),children:"Geri Don"})]})]}),"export"===i&&ue.jsxs(Je,{style:{padding:"24px"},children:[ue.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24},children:[ue.jsx("span",{style:{display:"inline-flex",color:_e.primary[500],fontSize:20},children:"v"}),ue.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:700,color:_e.primary[500]},children:"Disa Aktarma Secenekleri"})]}),ue.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:14},children:[ue.jsxs("button",{onClick:()=>{const e=Mr(a);Gr(e,qr("siparis-olculeri","csv"),"text/csv")},style:Zr,onMouseEnter:X,onMouseLeave:Z,children:[ue.jsx("span",{style:{fontSize:24},children:"[CSV]"}),"CSV Indir"]}),ue.jsxs("button",{onClick:()=>{const e=((e,t)=>{const r=e.map(e=>`\n      <tr>\n        <td>${e.id}</td>\n        <td>${e.boy}</td>\n        <td>${e.en}</td>\n        <td>${e.adet}</td>\n        <td>${e.grain}</td>\n        <td>${e.u1?"1":"0"}</td>\n        <td>${e.u2?"1":"0"}</td>\n        <td>${e.k1?"1":"0"}</td>\n        <td>${e.k2?"1":"0"}</td>\n        <td>${e.delik1}</td>\n        <td>${e.delik2}</td>\n        <td>${e.info}</td>\n      </tr>\n      `).join("");return`\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="UTF-8" />\n    <style>\n      body { font-family: Arial, sans-serif; font-size: 12px; margin: 16px; }\n      h1 { margin: 0 0 8px 0; }\n      .meta { margin-bottom: 12px; color: #444; }\n      table { border-collapse: collapse; width: 100%; }\n      th, td { border: 1px solid #d1d5db; padding: 6px; text-align: left; }\n      th { background: #f3f4f6; }\n    </style>\n  </head>\n  <body>\n    <h1>Siparis Olculeri</h1>\n    <div class="meta">\n      Musteri: ${t.customerName||"-"} | Telefon: ${t.customerPhone||"-"} | Plaka: ${t.plateSize} | Kalinlik: ${t.thickness} mm\n    </div>\n    <table>\n      <thead>\n        <tr>\n          <th>#</th>\n          <th>Boy</th>\n          <th>En</th>\n          <th>Adet</th>\n          <th>Grain</th>\n          <th>U1</th>\n          <th>U2</th>\n          <th>K1</th>\n          <th>K2</th>\n          <th>Delik-1</th>\n          <th>Delik-2</th>\n          <th>Bilgi</th>\n        </tr>\n      </thead>\n      <tbody>${r}</tbody>\n    </table>\n  </body>\n</html>\n  `.trim()})(a,{customerName:g,customerPhone:h,plateSize:d,thickness:p});Gr(e,qr("siparis-olculeri","xls"),"application/vnd.ms-excel")},style:Zr,onMouseEnter:X,onMouseLeave:Z,children:[ue.jsx("span",{style:{fontSize:24},children:"[XLS]"}),"Excel Indir"]}),ue.jsxs("button",{onClick:()=>{const e=window.open("","_blank","width=1280,height=860");if(!e)return void alert("Yazdirma penceresi acilamadi. Tarayici acilir pencereyi engellemis olabilir.");const t=a.map(e=>`\n          <tr>\n            <td>${e.id}</td>\n            <td>${Xr(e.boy)}</td>\n            <td>${Xr(e.en)}</td>\n            <td>${Xr(e.adet)}</td>\n            <td>${Xr(e.grain)}</td>\n            <td>${e.u1?"1":"0"}</td>\n            <td>${e.u2?"1":"0"}</td>\n            <td>${e.k1?"1":"0"}</td>\n            <td>${e.k2?"1":"0"}</td>\n            <td>${Xr(e.delik1)}</td>\n            <td>${Xr(e.delik2)}</td>\n            <td>${Xr(e.info)}</td>\n          </tr>\n        `).join(""),r=`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf-8" />\n          <title>Siparis Yazdirma</title>\n          <style>\n            body { font-family: Arial, sans-serif; color: #111827; margin: 18px; }\n            h1 { margin: 0 0 8px 0; font-size: 20px; }\n            .meta { margin-bottom: 14px; color: #374151; font-size: 12px; }\n            table { border-collapse: collapse; width: 100%; font-size: 12px; }\n            th, td { border: 1px solid #d1d5db; padding: 6px; text-align: left; }\n            th { background: #f3f4f6; }\n            .footer { margin-top: 14px; font-size: 11px; color: #6b7280; }\n          </style>\n        </head>\n        <body>\n          <h1>Siparis Olculeri</h1>\n          <div class="meta">\n            Musteri: ${Xr(g||"-")} |\n            Telefon: ${Xr(h||"-")} |\n            Plaka: ${Xr(d)} |\n            Kalinlik: ${p} mm |\n            Toplam Parca: ${$r(a)}\n          </div>\n          <table>\n            <thead>\n              <tr>\n                <th>#</th>\n                <th>Boy</th>\n                <th>En</th>\n                <th>Adet</th>\n                <th>Desen</th>\n                <th>U1</th>\n                <th>U2</th>\n                <th>K1</th>\n                <th>K2</th>\n                <th>Delik-1</th>\n                <th>Delik-2</th>\n                <th>Bilgi</th>\n              </tr>\n            </thead>\n            <tbody>${t}</tbody>\n          </table>\n          <div class="footer">Olusturma: ${(new Date).toLocaleString("tr-TR")}</div>\n        </body>\n      </html>\n    `;e.document.open(),e.document.write(r),e.document.close(),e.focus(),e.print()},style:Zr,onMouseEnter:X,onMouseLeave:Z,children:[ue.jsx("span",{style:{fontSize:24},children:"[PRN]"}),"Yazdir"]})]})]}),y&&ue.jsx(et,{open:y,title:"Olculeri Ice Aktar",onClose:()=>b(!1),children:ue.jsxs("div",{style:{padding:"20px",fontSize:14,display:"grid",gap:14},children:[ue.jsxs("div",{style:{color:_e.gray[400],lineHeight:1.6},children:["CSV/TXT/XLS dosyasi yukleyin.",ue.jsx("br",{}),"Beklenen sutunlar: ",ue.jsx("code",{children:"boy,en,adet,grain,u1,u2,k1,k2,delik-1,delik-2,bilgi"})]}),ue.jsx("input",{type:"file",accept:".csv,.txt,.xls,.xlsx",onChange:async e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];r&&(await q(r),e.target.value="")},style:{display:"block",padding:"8px"}}),j&&ue.jsx("div",{style:{padding:"10px 12px",borderRadius:6,background:`${_e.error.DEFAULT}12`,color:_e.error.DEFAULT,fontSize:12},children:j}),ue.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[ue.jsx(He,{variant:"secondary",onClick:()=>{const e=Mr([{id:1,boy:"650",en:"420",adet:"2",grain:"0",u1:!1,u2:!1,k1:!1,k2:!1,delik1:"",delik2:"",info:"Ornek satir 1"},{id:2,boy:"1200",en:"300",adet:"1",grain:"1",u1:!0,u2:!1,k1:!0,k2:!1,delik1:"8",delik2:"",info:"Ornek satir 2"}]);Gr(e,"ornek-olcu-sablonu.csv","text/csv")},children:"Ornek CSV Indir"}),ue.jsx(He,{variant:"secondary",onClick:()=>b(!1),children:"Kapat"})]})]})})]})]})}function ei(){const[t,r]=e.useState("admin"),[i,n]=e.useState("admin"),[s,o]=e.useState(!1),[l,d]=e.useState(""),[c,p]=e.useState(!1),u=St(e=>e.login);return c?ue.jsx("div",{style:{minHeight:"100vh",background:"radial-gradient(circle at top left, #383838 0%, #2D2D2D 45%, #1C1C1C 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:ue.jsxs(Je,{title:"Giriş Başarılı",subtitle:"Yönlendiriliyorsunuz...",style:{width:"100%",maxWidth:"400px",textAlign:"center"},children:[ue.jsx("div",{style:{marginBottom:"16px",display:"flex",justifyContent:"center"},children:ue.jsx(a,{size:48,color:"#4ADE80",strokeWidth:1.5,"aria-hidden":"true"})}),ue.jsx("p",{style:{color:_e.text,margin:0},children:"OptiPlan 360'a hoş geldiniz!"})]})}):ue.jsx("div",{style:{minHeight:"100vh",background:"radial-gradient(circle at top left, #383838 0%, #2D2D2D 45%, #1C1C1C 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:ue.jsx(Je,{title:"OptiPlan 360",subtitle:"Üretim Yönetim Sistemi",style:{width:"100%",maxWidth:"400px"},children:ue.jsxs("form",{onSubmit:async e=>{var r;if(e.preventDefault(),t&&i){o(!0),d("");try{const e=await fetch(`${Ct()}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:i})});if(!e.ok){const t=await e.json().catch(()=>({})),i=(null==(r=null==t?void 0:t.error)?void 0:r.message)||(null==t?void 0:t.detail)||(null==t?void 0:t.message)||"Giriş başarısız";throw new Error(i)}const n=await e.json(),a={id:String(n.user.id),username:n.user.username,email:n.user.email??"",role:n.user.role||"OPERATOR",fullName:n.user.display_name,active:n.user.is_active??!0,createdAt:n.user.created_at??(new Date).toISOString()};u(n.token,a),p(!0),setTimeout(()=>{window.location.href="/"},500)}catch(n){d(n instanceof Error?n.message:"Giriş başarısız")}finally{o(!1)}}else d("Kullanıcı adı ve şifre gereklidir")},style:{display:"flex",flexDirection:"column",gap:"16px"},children:[ue.jsx(tt,{label:"Kullanıcı Adı",value:t,onChange:e=>r(e.target.value),placeholder:"admin"}),ue.jsx(tt,{type:"password",label:"Şifre",value:i,onChange:e=>n(e.target.value),placeholder:"admin"}),l&&ue.jsx("div",{role:"alert","aria-live":"assertive",style:{padding:"12px",borderRadius:Pe.md,background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",color:"#ef4444",fontSize:"13px"},children:l}),ue.jsx(He,{type:"submit",disabled:s,style:{width:"100%",padding:"12px",fontSize:"14px",fontWeight:500},children:s?"Giriş yapılıyor...":"Giriş Yap"}),ue.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:_e.muted,marginTop:"8px"},children:"Test kullanıcı: admin / admin"})]})})})}class ti extends h.Component{constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null})},this.handleGoHome=()=>{window.location.href="/"},this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.props.onError&&this.props.onError(e,t)}render(){var e;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const t=`ERR-${Date.now().toString(36).toUpperCase()}`;return ue.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-gray-50 flex items-center justify-center p-4",children:ue.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full",children:[ue.jsx("div",{className:"flex justify-center mb-4",children:ue.jsx(g,{className:"w-16 h-16 text-red-500"})}),ue.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:"Bir hata oluştu"}),ue.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Sayfa yüklenirken beklenmedik bir sorun oluştu. Lütfen sayfayı yenileyin veya ana sayfaya dönün."}),ue.jsxs("div",{className:"bg-gray-100 rounded p-4 mb-6 border-l-4 border-red-500",children:[ue.jsx("p",{className:"text-xs font-mono text-gray-700 break-words",children:(null==(e=this.state.error)?void 0:e.message)||"Unknown error"}),ue.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Hata Kodu: ",t]})]}),!1,ue.jsxs("div",{className:"space-y-3",children:[ue.jsxs("button",{onClick:this.handleReset,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:[ue.jsx(q,{className:"w-4 h-4"}),"Tekrar Dene"]}),ue.jsxs("button",{onClick:this.handleGoHome,className:"w-full flex items-center justify-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg transition-colors",children:[ue.jsx(X,{className:"w-4 h-4"}),"Ana Sayfaya Dön"]})]}),ue.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Sorun devam ederse, destek ekibiyle iletişime geçin."})]})})}return this.props.children}}const ri={Ctrl:"ctrlKey",Cmd:"metaKey",Alt:"altKey",Shift:"shiftKey"},ii=e.lazy(()=>Q(()=>import("./index-jFQog1Z7.js"),__vite__mapDeps([12,1,5,6,7,8]))),ni=e.lazy(()=>Q(()=>import("./ModularIntegrationsPage-FPu7oiLP.js"),__vite__mapDeps([13,1,3,14,5,6,7,8]))),ai=e.lazy(()=>Q(()=>import("./IntegrationHealth-FxbDTWGi.js"),__vite__mapDeps([15,1,14,5,6,7,8]))),si=e.lazy(()=>Q(()=>import("./CardManagementPage-Di8jOV4Y.js"),__vite__mapDeps([16,6,1,5,7,8]))),oi=e.lazy(()=>Q(()=>import("./ReportsAnalyticsPage-B_Yq-xOd.js"),__vite__mapDeps([17,6,1,5,7,8]))),li=e.lazy(()=>Q(()=>import("./SystemLogsPage-954TYgh2.js"),__vite__mapDeps([18,6,1,19,5,7,8]))),di=e.lazy(()=>Q(()=>import("./UserManagementPage-BdybPxCx.js"),__vite__mapDeps([20,6,1,19,5,7,8]))),ci=e.lazy(()=>Q(()=>import("./SupportTickets-DDUNq5-b.js"),__vite__mapDeps([21,1,22,5,6,7,8]))),pi=e.lazy(()=>Q(()=>import("./ConfigPage-BSs13Z3f.js"),__vite__mapDeps([23,1,24,25,5,6,7,8]))),ui=e.lazy(()=>Q(()=>import("./StationsPage-DDB6LX8N.js"),__vite__mapDeps([26,27,1,24,5,6,7,8]))),gi=e.lazy(()=>Q(()=>import("./OrganizationPage-CRB_77Y2.js"),__vite__mapDeps([28,1,24,5,6,7,8]))),mi=e.lazy(()=>Q(()=>import("./UserActivityPage-D9p9fCV4.js"),__vite__mapDeps([29,1,24,30,5,6,7,8]))),hi=e.lazy(()=>Q(()=>import("./WorkflowBuilder-soOS8a_H.js"),__vite__mapDeps([31,1,5,6,7,8]))),xi=e.lazy(()=>Q(()=>import("./ApiPortal-BMUh424y.js"),__vite__mapDeps([32,1,5,6,7,8]))),yi=e.lazy(()=>Q(()=>import("./WhatsAppBusinessPage-xm45n8v5.js"),__vite__mapDeps([33,1,5,6,7,8]))),bi=e.lazy(()=>Q(()=>import("./index-CoEFI-UD.js"),__vite__mapDeps([34,1,5,6,7,8]))),fi=e.lazy(()=>Q(()=>import("./AIAssistantPage-CXulCs5Q.js"),__vite__mapDeps([35,1,5,6,7,8]))),vi=e.lazy(()=>Q(()=>import("./AIConfigPage-wxR4esWY.js"),__vite__mapDeps([36,1,5,6,7,8]))),ji=e.lazy(()=>Q(()=>import("./index-CcGVDsEJ.js"),__vite__mapDeps([37,1,5,6,7,8]))),ki=e.lazy(()=>Q(()=>import("./SpecSearchPage-BGMlUlpe.js"),__vite__mapDeps([38,1,5,6,7,8]))),Si=()=>ue.jsx("div",{className:"app-loading-fallback",role:"status","aria-live":"polite",children:ue.jsxs("div",{className:"app-loading-fallback-inner",children:[ue.jsx("div",{className:"loading-spinner loading-spinner-sm","aria-hidden":"true"}),"Sayfa yukleniyor..."]})});function Ei(e){const t=null==e?void 0:e.toUpperCase().trim();return t?"ADMIN"===t||t.includes("ADMIN")?"ADMIN":"OPERATOR"===t||t.includes("OPERATOR")?"OPERATOR":"STATION"===t||"KIOSK"===t||t.includes("KIOSK")?"STATION":"OPERATOR":"OPERATOR"}function Ai({title:e,detail:t}){return ue.jsx("div",{className:"electric-page",children:ue.jsx("div",{className:"app-page-container",children:ue.jsx(Je,{title:e,subtitle:"Durum bilgisi",children:ue.jsx("p",{className:"info-page-detail",children:t})})})})}function wi({authUser:t}){const[r,i]=e.useState("dashboard"),[n,a]=e.useState(!1),[s,o]=e.useState(!1),[l,d]=e.useState(null),[c,p]=e.useState(!1),u=()=>{window.innerWidth<=768?o(e=>!e):a(e=>!e)};(t=>{const r=e.useCallback(e=>{for(const r of t){const t=r.keys.filter(e=>e in ri),i=r.keys.filter(e=>!(e in ri));let n=!0;for(const r of t)if(!e[ri[r]]){n=!1;break}if(n&&i.length>0){const t=i[0].toLowerCase(),r=e.key.toLowerCase();n="escape"===t?"Escape"===e.code:"enter"===t?"Enter"===e.code:r===t}if(n)return!1!==r.preventDefault&&e.preventDefault(),void r.action()}},[t]);e.useEffect(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)),[r])})([{keys:["Ctrl","k"],description:"Arama ac",action:()=>p(!0)},{keys:["Escape"],description:"Kapat",action:()=>p(!1),preventDefault:!1},{keys:["Shift","Ctrl","k"],description:"Sidebar ac/kapat",action:u}]);const g=St(e=>e.logout),m=Tr(e=>e.fetchOrders),h=Tr(e=>e.initialized),x=Tr(e=>e.isLoading),y=Tr(e=>e.error),b=Tr(e=>e.orders),f=e.useMemo(()=>({orders:b.filter(e=>"NEW"===e.status).length||void 0,kanban:b.filter(e=>"IN_PRODUCTION"===e.status).length||void 0,payment:void 0,orchestrator:void 0,systemLogs:void 0}),[b]);e.useEffect(()=>{m()},[m]);const v=e.useMemo(()=>({name:t.fullName||t.username||t.email||"Operator",role:Ei(t.role)}),[t]),j=e=>{d(e),i("order-editor")},k=()=>{d(null),i("orders")},S=!h||x,E=S?"Veriler yukleniyor...":y?`Veri baglantisi uyarisi: ${y}`:"",A=Boolean(E)&&"dashboard"!==r;return ue.jsxs("div",{className:"app-shell",children:[ue.jsx("div",{className:"show-mobile mobile-header-wrap",children:ue.jsx(Xt,{title:"Optiplan360",subtitle:r.charAt(0).toUpperCase()+r.slice(1),isMenuOpen:s,onMenuToggle:u,userName:v.name,userRole:v.role})}),ue.jsx("div",{className:"sidebar-overlay "+(s?"is-visible":""),onClick:()=>o(!1)}),ue.jsx(qt,{page:r,onNav:e=>{i(e),o(!1)},collapsed:n,mobileOpen:s,onToggle:u,userRole:v.role,currentUser:t,badgeCounts:f,onLogout:()=>{g(),i("dashboard"),d(null)}}),ue.jsxs("main",{className:"page-content app-main",children:[A?ue.jsxs("div",{className:"global-status-note "+(y?"is-warning":"is-info"),role:"status","aria-live":"polite",children:[S?ue.jsx("span",{className:"loading-spinner loading-spinner-sm","aria-hidden":"true"}):ue.jsx("span",{className:"global-status-dot","aria-hidden":"true"}),ue.jsx("span",{children:E})]}):null,ue.jsx(ti,{children:ue.jsx(e.Suspense,{fallback:ue.jsx(Si,{}),children:(()=>{switch(r){case"dashboard":return ue.jsx(vr,{currentUser:{name:v.name},onNewOrder:()=>j(null)});case"orders":return ue.jsx(zr,{onEdit:j});case"order-editor":return ue.jsx(Qr,{order:l,onBack:k});case"kanban":return ue.jsx(ii,{onEdit:e=>j(e)});case"card-management":return ue.jsx(si,{});case"reports-analytics":return ue.jsx(oi,{});case"integration-health":return ue.jsx(ai,{});case"integrations":return ue.jsx(ni,{});case"stations":return ue.jsx(ui,{});case"system-logs":return ue.jsx(li,{});case"user-management":return ue.jsx(di,{});case"config":return ue.jsx(pi,{});case"organization":return ue.jsx(gi,{});case"user-activity":return ue.jsx(mi,{});case"workflows":return ue.jsx(hi,{});case"api-portal":return ue.jsx(xi,{});case"whatsapp-business":return ue.jsx(yi,{});case"price-tracking":return ue.jsx(bi,{});case"ai-assistant":return ue.jsx(fi,{});case"ai-config":return ue.jsx(vi,{});case"orchestrator":return ue.jsx(ji,{});case"product-search":return ue.jsx(ki,{});case"crm-tickets":return ue.jsx(ci,{});default:return ue.jsx(Ai,{title:"Sayfa bulunamadi",detail:"Istenen sayfa tanimli degil."})}})()})}),ue.jsx(mt,{})]}),ue.jsx(er,{isOpen:c,onClose:()=>p(!1),onNavigate:e=>{i(e),p(!1)}}),ue.jsx(ir,{onNavigate:e=>i(e)})]})}const Fi=e.lazy(()=>Q(()=>import("./PublicOrderTracking-Dz8R8jmG.js"),__vite__mapDeps([39,1,5,6,7,8,40])));function Di(){const t=St(e=>e.user),r=St(e=>e.isAuthenticated),i=St(e=>e.logout),n=dt(e=>e.themeName);return e.useEffect(()=>{ot(n)},[n]),e.useEffect(()=>{const e=()=>{i()};return window.addEventListener("auth:session-expired",e),()=>window.removeEventListener("auth:session-expired",e)},[i]),r&&t?ue.jsx(ti,{children:ue.jsx(vt,{children:ue.jsx(Ar,{children:ue.jsx(wi,{authUser:t})})})}):ue.jsx(Ar,{children:ue.jsx(ei,{})})}function Ti(){const t=window.location.pathname;if(t.startsWith("/track/")){const r=t.replace("/track/","");return ue.jsx(ti,{children:ue.jsx(e.Suspense,{fallback:ue.jsx(Si,{}),children:ue.jsx(Fi,{token:r})})})}return ue.jsx(Di,{})}ge.createRoot(document.getElementById("root")).render(ue.jsx(h.StrictMode,{children:ue.jsx(ti,{children:ue.jsx(Ti,{})})}));export{He as B,_e as C,tt as I,Ve as K,et as M,Lr as O,Ze as P,Pe as R,Re as S,Be as T,wr as a,gr as b,kt as c,Je as d,nr as e,Qe as f,mr as g,_t as h,St as i,ue as j,Tt as k,Ct as l,rt as m,ur as n,Yr as o,Ue as p,bt as q,Nr as r,Ye as s,We as t,Tr as u,dt as v,Ae as w};
